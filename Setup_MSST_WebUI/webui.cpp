#include <iostream>
#include <fstream>
#include <vector>
#include <string>
#include <windows.h>
#include <random>
#include <sstream>
#include <iomanip>

// Base64 decoding function
std::string base64_decode(const std::string &in)
{
    std::string out;
    std::vector<int> T(256, -1);
    for (int i = 0; i < 64; i++)
        T["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[i]] = i;
    int val = 0, valb = -8;
    for (unsigned char c : in)
    {
        if (T[c] == -1)
            break;
        val = (val << 6) + T[c];
        valb += 6;
        if (valb >= 0)
        {
            out.push_back(char((val >> valb) & 0xFF));
            valb -= 8;
        }
    }
    return out;
}

std::string generate_guid()
{
    std::random_device rd;
    std::mt19937 gen(rd());
    std::uniform_int_distribution<int> dist(0, 15);

    std::stringstream ss;
    for (int i = 0; i < 32; ++i)
    {
        if (i == 8 || i == 12 || i == 16 || i == 20)
        {
            ss << "-";
        }
        ss << std::hex << dist(gen);
    }

    return ss.str();
}

std::string get_webui()
{
    std::string encoded = "aW1wb3J0IGdyYWRpbyBhcyBncgppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQgcmUKaW1wb3J0IHRpbWUKaW1wb3J0IHNodXRpbAppbXBvcnQganNvbgppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHlhbWwKaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IGxpYnJvc2EKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IHdlYmJyb3dzZXIKaW1wb3J0IHBsYXRmb3JtCmltcG9ydCB3YXJuaW5ncwppbXBvcnQgbG9jYWxlCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHBzdXRpbApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIG1sX2NvbGxlY3Rpb25zIGltcG9ydCBDb25maWdEaWN0CmZyb20gdHFkbSBpbXBvcnQgdHFkbQpmcm9tIG1pcl9ldmFsLnNlcGFyYXRpb24gaW1wb3J0IGJzc19ldmFsX3NvdXJjZXMKZnJvbSB0a2ludGVyIGltcG9ydCBmaWxlZGlhbG9nCmZyb20gcHlkdWIgaW1wb3J0IEF1ZGlvU2VnbWVudApmcm9tIHJpY2guY29uc29sZSBpbXBvcnQgQ29uc29sZQpmcm9tIHRvcmNoIGltcG9ydCBjdWRhLCBiYWNrZW5kcwpmcm9tIG11bHRpcHJvY2Vzc2luZyBpbXBvcnQgY3B1X2NvdW50CgpQQUNLQUdFX1ZFUlNJT04gPSAiMS42IHByZS4zIgpXRUJVSV9DT05GSUcgPSAiZGF0YS93ZWJ1aV9jb25maWcuanNvbiIKV0VCVUlfQ09ORklHX0JBQ0tVUCA9ICJkYXRhX2JhY2t1cC93ZWJ1aV9jb25maWcuanNvbiIKUFJFU0VUUyA9ICJkYXRhL3ByZXNldF9kYXRhLmpzb24iCk1TU1RfTU9ERUwgPSAiZGF0YS9tc3N0X21vZGVsX21hcC5qc29uIgpWUl9NT0RFTCA9ICJkYXRhL3ZyX21vZGVsX21hcC5qc29uIgpCQUNLVVAgPSAiYmFja3VwLyIKTU9ERUxfRk9MREVSID0gInByZXRyYWluLyIKVEVNUF9QQVRIID0gInRlbXAiClVOT0ZGSUNJQUxfTU9ERUwgPSAiY29uZmlnX3Vub2ZmaWNpYWwiClZSX01PREVMUEFSQU1TID0gImNvbmZpZ3MvdnJfbW9kZWxwYXJhbXMiCk1PREVMX1RZUEUgPSBbJ2JzX3JvZm9ybWVyJywgJ21lbF9iYW5kX3JvZm9ybWVyJywgJ3NlZ21fbW9kZWxzJywgJ2h0ZGVtdWNzJywgJ21keDIzYycsICdzd2luX3VwZXJuZXQnLCAnYmFuZGl0JywgJ2JhbmRpdF92MicsICdzY25ldCcsICdzY25ldF91bm9mZmljaWFsJywgJ3RvcmNoc2VnJ10KTU9ERUxfQ0hPSUNFUyA9IFsidm9jYWxfbW9kZWxzIiwgIm11bHRpX3N0ZW1fbW9kZWxzIiwgInNpbmdsZV9zdGVtX21vZGVscyIsICJVVlJfVlJfTW9kZWxzIl0KRkZNUEVHID0gIi5cXGZmbXBlZ1xcYmluXFxmZm1wZWcuZXhlIiBpZiBvcy5wYXRoLmlzZmlsZSgiLlxcZmZtcGVnXFxiaW5cXGZmbXBlZy5leGUiKSBlbHNlICJmZm1wZWciClBZVEhPTiA9ICIuXFx3b3JrZW52XFxweXRob24uZXhlIiBpZiBvcy5wYXRoLmlzZmlsZSgiLlxcd29ya2VudlxccHl0aG9uLmV4ZSIpIGVsc2Ugc3lzLmV4ZWN1dGFibGUKCmxhbmd1YWdlX2RpY3QgPSB7CiAgICAiQXV0byI6ICJBdXRvIiwKICAgICLnroDkvZPkuK3mlociOiAiemhfQ04iLAogICAgIue5gemrlOS4reaWhyI6ICJ6aF9UVyIsCiAgICAiRW5nbGlzaCI6ICJlbl9VUyIsCiAgICAi5pel5pys6KqeIjogImphX0pQIiwKICAgICLwn5iKIjogImVtb2ppIgogICAgfQoKd2FybmluZ3MuZmlsdGVyd2FybmluZ3MoImlnbm9yZSIpCnN0b3BfYWxsX3RocmVhZHMgPSBGYWxzZQpzdG9wX2luZmVyX2Zsb3cgPSBGYWxzZQoKZGVmIHNldHVwX3dlYnVpKCk6CiAgICBkZWYgY29weV9mb2xkZXJzKCk6CiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoImNvbmZpZ3MiKToKICAgICAgICAgICAgc2h1dGlsLnJtdHJlZSgiY29uZmlncyIpCiAgICAgICAgc2h1dGlsLmNvcHl0cmVlKCJjb25maWdzX2JhY2t1cCIsICJjb25maWdzIikKICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cygiZGF0YSIpOgogICAgICAgICAgICBzaHV0aWwucm10cmVlKCJkYXRhIikKICAgICAgICBzaHV0aWwuY29weXRyZWUoImRhdGFfYmFja3VwIiwgImRhdGEiKQoKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cygiZGF0YSIpOgogICAgICAgIHNodXRpbC5jb3B5dHJlZSgiZGF0YV9iYWNrdXAiLCAiZGF0YSIpCiAgICAgICAgcHJpbnQoaTE4bigiW0lORk9dIOato+WcqOWIneWni+WMlmRhdGHnm67lvZUiKSkKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cygiY29uZmlncyIpOgogICAgICAgIHNodXRpbC5jb3B5dHJlZSgiY29uZmlnc19iYWNrdXAiLCAiY29uZmlncyIpCiAgICAgICAgcHJpbnQoaTE4bigiW0lORk9dIOato+WcqOWIneWni+WMlmNvbmZpZ3Pnm67lvZUiKSkKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cygiaW5wdXQiKTogb3MubWFrZWRpcnMoImlucHV0IikKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cygicmVzdWx0cyIpOiBvcy5tYWtlZGlycygicmVzdWx0cyIpCiAgICBpZiBvcy5wYXRoLmV4aXN0cygiZGF0YSIpOgogICAgICAgIHdlYnVpX2NvbmZpZyA9IGxvYWRfY29uZmlncyhXRUJVSV9DT05GSUcpCiAgICAgICAgdmVyc2lvbiA9IHdlYnVpX2NvbmZpZy5nZXQoInZlcnNpb24iLCBOb25lKQogICAgICAgIGlmIG5vdCB2ZXJzaW9uOgogICAgICAgICAgICB0cnk6IHZlcnNpb24gPSBsb2FkX2NvbmZpZ3MoImRhdGEvdmVyc2lvbi5qc29uIilbInZlcnNpb24iXQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uOiAKICAgICAgICAgICAgICAgIGNvcHlfZm9sZGVycygpCiAgICAgICAgICAgICAgICB2ZXJzaW9uID0gUEFDS0FHRV9WRVJTSU9OCiAgICAgICAgaWYgdmVyc2lvbiAhPSBQQUNLQUdFX1ZFUlNJT046CiAgICAgICAgICAgIHByaW50KGkxOG4oIltJTkZPXSDmo4DmtYvliLAiKSArIHZlcnNpb24gKyBpMThuKCLml6fniYjphY3nva4sIOato+WcqOabtOaWsOiHs+acgOaWsOeJiCIpICsgUEFDS0FHRV9WRVJTSU9OKQogICAgICAgICAgICBwcmVzZXRzX2NvbmZpZyA9IGxvYWRfY29uZmlncyhQUkVTRVRTKQogICAgICAgICAgICB3ZWJ1aV9jb25maWdfYmFja3VwID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJR19CQUNLVVApCiAgICAgICAgICAgIGZvciBtb2R1bGUgaW4gWyJ0cmFpbmluZyIsICJpbmZlcmVuY2UiLCAidG9vbHMiLCAic2V0dGluZ3MiXToKICAgICAgICAgICAgICAgIGZvciBrZXkgaW4gd2VidWlfY29uZmlnX2JhY2t1cFttb2R1bGVdOgogICAgICAgICAgICAgICAgICAgIHRyeTogd2VidWlfY29uZmlnX2JhY2t1cFttb2R1bGVdW2tleV0gPSB3ZWJ1aV9jb25maWdbbW9kdWxlXVtrZXldCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOiBjb250aW51ZQogICAgICAgICAgICBjb3B5X2ZvbGRlcnMoKQogICAgICAgICAgICBzYXZlX2NvbmZpZ3Mod2VidWlfY29uZmlnX2JhY2t1cCwgV0VCVUlfQ09ORklHKQogICAgICAgICAgICBzYXZlX2NvbmZpZ3MocHJlc2V0c19jb25maWcsIFBSRVNFVFMpCgogICAgb3MuZW52aXJvblsiUEFUSCJdICs9IG9zLnBhdGhzZXAgKyBvcy5wYXRoLmFic3BhdGgoImZmbXBlZy9iaW4vIikKICAgIHByaW50KGkxOG4oIltJTkZPXSDorr7lpIfkv6Hmga/vvJoiKSArIHN0cihnZXRfZGV2aWNlKCkpKQoKICAgICMgZml4IG1vZGVsX3BhdGggd2hlbiB2ZXJzaW9uIGlzIGxvd2VyIHRoYW4gMS41CiAgICBtb2RlbF9uYW1lID0gWyJkZW5vaXNlX21lbF9iYW5kX3JvZm9ybWVyX2F1ZnIzM19hZ2dyX3Nkcl8yNy45NzY4LmNrcHQiLCAiZGVub2lzZV9tZWxfYmFuZF9yb2Zvcm1lcl9hdWZyMzNfc2RyXzI3Ljk5NTkuY2twdCIsICJkZXZlcmJfYnNfcm9mb3JtZXJfOF8yNTZkaW1fOGRlcHRoLmNrcHQiLCAiZGV2ZXJiX2JzX3JvZm9ybWVyXzhfMzg0ZGltXzEwZGVwdGguY2twdCIsICJkZXZlcmJfbWVsX2JhbmRfcm9mb3JtZXJfZXBfMjdfc2RyXzEwLjQ1NjcuY2twdCJdCiAgICBmb3IgbW9kZWwgaW4gbW9kZWxfbmFtZToKICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhvcy5wYXRoLmpvaW4oTU9ERUxfRk9MREVSLCAidm9jYWxfbW9kZWxzIiwgbW9kZWwpKToKICAgICAgICAgICAgc2h1dGlsLm1vdmUob3MucGF0aC5qb2luKE1PREVMX0ZPTERFUiwgInZvY2FsX21vZGVscyIsIG1vZGVsKSwgb3MucGF0aC5qb2luKE1PREVMX0ZPTERFUiwgInNpbmdsZV9zdGVtX21vZGVscyIsIG1vZGVsKSkKCmRlZiB3ZWJ1aV9yZXN0YXJ0KCk6CiAgICBvcy5leGVjbChQWVRIT04sIFBZVEhPTiwgKnN5cy5hcmd2KQoKZGVmIGkxOG4oa2V5KToKICAgIHRyeToKICAgICAgICBjb25maWcgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKQogICAgICAgIGlmIGNvbmZpZ1sic2V0dGluZ3MiXVsibGFuZ3VhZ2UiXT09ICJBdXRvIjoKICAgICAgICAgICAgbGFuZ3VhZ2UgPSBsb2NhbGUuZ2V0ZGVmYXVsdGxvY2FsZSgpWzBdCiAgICAgICAgZWxzZTogbGFuZ3VhZ2UgPSBjb25maWdbJ3NldHRpbmdzJ11bJ2xhbmd1YWdlJ10KICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgbGFuZ3VhZ2UgPSBsb2NhbGUuZ2V0ZGVmYXVsdGxvY2FsZSgpWzBdCiAgICBpZiBsYW5ndWFnZSA9PSAiemhfQ04iOgogICAgICAgIHJldHVybiBrZXkKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoPWYidG9vbHMvaTE4bi9sb2NhbGUve2xhbmd1YWdlfS5qc29uIik6CiAgICAgICAgbGFuZ3VhZ2UgPSAiZW5fVVMiCiAgICB3aXRoIG9wZW4oZmlsZT1mInRvb2xzL2kxOG4vbG9jYWxlL3tsYW5ndWFnZX0uanNvbiIsIG1vZGU9InIiLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOgogICAgICAgIGxhbmd1YWdlX2xpc3QgPSBqc29uLmxvYWQoZikKICAgIHJldHVybiBsYW5ndWFnZV9saXN0LmdldChrZXksIGtleSkKCmRlZiBnZXRfZGV2aWNlKCk6CiAgICB0cnk6CiAgICAgICAgaWYgY3VkYS5pc19hdmFpbGFibGUoKToKICAgICAgICAgICAgZ3B1cyA9IFtdCiAgICAgICAgICAgIG5fZ3B1ID0gY3VkYS5kZXZpY2VfY291bnQoKQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShuX2dwdSk6CiAgICAgICAgICAgICAgICBncHVzLmFwcGVuZChmIntpfToge2N1ZGEuZ2V0X2RldmljZV9uYW1lKGkpfSIpCiAgICAgICAgICAgIGlmIGxlbihncHVzKSA9PSAxOgogICAgICAgICAgICAgICAgcmV0dXJuIGdwdXNbMF0KICAgICAgICAgICAgcmV0dXJuIGdwdXMKICAgICAgICBlbGlmIGJhY2tlbmRzLm1wcy5pc19hdmFpbGFibGUoKToKICAgICAgICAgICAgcmV0dXJuIGkxOG4oIuS9v+eUqE1QUyIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGkxOG4oIuaXoOWPr+eUqOeahOWKoOmAn+iuvuWkhywg5L2/55SoQ1BVIikKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIGkxOG4oIuiuvuWkh+ajgOafpeWksei0pSIpCgpkZWYgZ2V0X3BsYXRmb3JtKCk6CiAgICBvc19uYW1lID0gcGxhdGZvcm0uc3lzdGVtKCkKICAgIG9zX3ZlcnNpb24gPSBwbGF0Zm9ybS52ZXJzaW9uKCkKICAgIG1hY2hpbmUgPSBwbGF0Zm9ybS5tYWNoaW5lKCkKICAgIHJldHVybiBmIlN5c3RlbToge29zX25hbWV9LCBWZXJzaW9uOiB7b3NfdmVyc2lvbn0sIE1hY2hpbmU6IHttYWNoaW5lfSIKCmRlZiBsb2FkX2NvbmZpZ3MoY29uZmlnX3BhdGgpOgogICAgaWYgY29uZmlnX3BhdGguZW5kc3dpdGgoJy5qc29uJyk6CiAgICAgICAgd2l0aCBvcGVuKGNvbmZpZ19wYXRoLCAncicsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6CiAgICAgICAgICAgIHJldHVybiBqc29uLmxvYWQoZikKICAgIGVsaWYgY29uZmlnX3BhdGguZW5kc3dpdGgoJy55YW1sJykgb3IgY29uZmlnX3BhdGguZW5kc3dpdGgoJy55bWwnKToKICAgICAgICB3aXRoIG9wZW4oY29uZmlnX3BhdGgsICdyJykgYXMgZjoKICAgICAgICAgICAgcmV0dXJuIENvbmZpZ0RpY3QoeWFtbC5sb2FkKGYsIExvYWRlcj15YW1sLkZ1bGxMb2FkZXIpKQoKZGVmIHNhdmVfY29uZmlncyhjb25maWcsIGNvbmZpZ19wYXRoKToKICAgIGlmIGNvbmZpZ19wYXRoLmVuZHN3aXRoKCcuanNvbicpOgogICAgICAgIHdpdGggb3Blbihjb25maWdfcGF0aCwgJ3cnLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOgogICAgICAgICAgICBqc29uLmR1bXAoY29uZmlnLCBmLCBpbmRlbnQ9NCkKICAgIGVsaWYgY29uZmlnX3BhdGguZW5kc3dpdGgoJy55YW1sJykgb3IgY29uZmlnX3BhdGguZW5kc3dpdGgoJy55bWwnKToKICAgICAgICB3aXRoIG9wZW4oY29uZmlnX3BhdGgsICd3JykgYXMgZjoKICAgICAgICAgICAgeWFtbC5kdW1wKGNvbmZpZy50b19kaWN0KCksIGYpCgpkZWYgcHJpbnRfY29tbWFuZChjb21tYW5kKToKICAgIHByaW50KCJcMDMzWzMybSIgKyAiVXNlIGNvbW1hbmQ6ICIgKyBjb21tYW5kICsgIlwwMzNbMG0iKQoKZGVmIGxvYWRfYXVnbWVudGF0aW9uc19jb25maWcoKToKICAgIHRyeToKICAgICAgICB3aXRoIG9wZW4oImNvbmZpZ3MvYXVnbWVudGF0aW9uc190ZW1wbGF0ZS55YW1sIiwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOgogICAgICAgICAgICByZXR1cm4gZi5yZWFkKCkKICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoKICAgICAgICByZXR1cm4gaTE4bigi6ZSZ6K+vOiDml6Dms5Xmib7liLDlop7lvLrphY3nva7mlofku7bmqKHmnb8sIOivt+ajgOafpeaWh+S7tmNvbmZpZ3MvYXVnbWVudGF0aW9uc190ZW1wbGF0ZS55YW1s5piv5ZCm5a2Y5Zyo44CCIikKCmRlZiBsb2FkX3NlbGVjdGVkX21vZGVsKG1vZGVsX3R5cGU9Tm9uZSk6CiAgICBpZiBub3QgbW9kZWxfdHlwZToKICAgICAgICB3ZWJ1aV9jb25maWcgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKQogICAgICAgIG1vZGVsX3R5cGUgPSB3ZWJ1aV9jb25maWdbImluZmVyZW5jZSJdWyJtb2RlbF90eXBlIl0KICAgIGlmIG1vZGVsX3R5cGU6CiAgICAgICAgZG93bmxvYWRlZF9tb2RlbCA9IFtdCiAgICAgICAgbW9kZWxfZGlyID0gb3MucGF0aC5qb2luKE1PREVMX0ZPTERFUiwgbW9kZWxfdHlwZSkKICAgICAgICBmb3IgZmlsZXMgaW4gb3MubGlzdGRpcihtb2RlbF9kaXIpOgogICAgICAgICAgICBpZiBmaWxlcy5lbmRzd2l0aCgoJy5ja3B0JywgJy50aCcsICcuY2hwdCcpKToKICAgICAgICAgICAgICAgIGRvd25sb2FkZWRfbW9kZWwuYXBwZW5kKGZpbGVzKQogICAgICAgIHJldHVybiBkb3dubG9hZGVkX21vZGVsCiAgICByZXR1cm4gTm9uZQoKZGVmIGxvYWRfbXNzdF9tb2RlbCgpOgogICAgY29uZmlnID0gbG9hZF9jb25maWdzKE1TU1RfTU9ERUwpCiAgICBtb2RlbF9saXN0ID0gW10KICAgIG1vZGVsX2RpciA9IFtvcy5wYXRoLmpvaW4oTU9ERUxfRk9MREVSLCBrZXlzKSBmb3Iga2V5cyBpbiBjb25maWcua2V5cygpXQogICAgZm9yIGRpcnMgaW4gbW9kZWxfZGlyOgogICAgICAgIGZvciBmaWxlcyBpbiBvcy5saXN0ZGlyKGRpcnMpOgogICAgICAgICAgICBpZiBmaWxlcy5lbmRzd2l0aCgoJy5ja3B0JywgJy50aCcsICcuY2hwdCcpKToKICAgICAgICAgICAgICAgIG1vZGVsX2xpc3QuYXBwZW5kKGZpbGVzKQogICAgcmV0dXJuIG1vZGVsX2xpc3QKCmRlZiBnZXRfbXNzdF9tb2RlbChtb2RlbF9uYW1lKToKICAgIGNvbmZpZyA9IGxvYWRfY29uZmlncyhNU1NUX01PREVMKQogICAgd2VidWlfY29uZmlnID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJRykKICAgIG1haW5fbGluayA9IHdlYnVpX2NvbmZpZ1snc2V0dGluZ3MnXVsnZG93bmxvYWRfbGluayddCiAgICBpZiBtYWluX2xpbmsgPT0gIkF1dG8iOgogICAgICAgIGxhbmd1YWdlID0gbG9jYWxlLmdldGRlZmF1bHRsb2NhbGUoKVswXQogICAgICAgIGlmIGxhbmd1YWdlIGluIFsiemhfQ04iLCAiemhfVFciLCAiemhfSEsiLCAiemhfU0ciXToKICAgICAgICAgICAgbWFpbl9saW5rID0gImhmLW1pcnJvci5jb20iCiAgICAgICAgZWxzZTogbWFpbl9saW5rID0gImh1Z2dpbmdmYWNlLmNvIgogICAgZm9yIGtleXMgaW4gY29uZmlnLmtleXMoKToKICAgICAgICBmb3IgbW9kZWwgaW4gY29uZmlnW2tleXNdOgogICAgICAgICAgICBpZiBtb2RlbFsibmFtZSJdID09IG1vZGVsX25hbWU6CiAgICAgICAgICAgICAgICBtb2RlbF90eXBlID0gbW9kZWxbIm1vZGVsX3R5cGUiXQogICAgICAgICAgICAgICAgbW9kZWxfcGF0aCA9IG9zLnBhdGguam9pbihNT0RFTF9GT0xERVIsIGtleXMsIG1vZGVsX25hbWUpCiAgICAgICAgICAgICAgICBjb25maWdfcGF0aCA9IG1vZGVsWyJjb25maWdfcGF0aCJdCiAgICAgICAgICAgICAgICBkb3dubG9hZF9saW5rID0gbW9kZWxbImxpbmsiXQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkX2xpbmsgPSBkb3dubG9hZF9saW5rLnJlcGxhY2UoImh1Z2dpbmdmYWNlLmNvIiwgbWFpbl9saW5rKQogICAgICAgICAgICAgICAgZXhjZXB0OiBwYXNzCiAgICAgICAgICAgICAgICByZXR1cm4gbW9kZWxfcGF0aCwgY29uZmlnX3BhdGgsIG1vZGVsX3R5cGUsIGRvd25sb2FkX2xpbmsKICAgIHRyeToKICAgICAgICB1bm9mZmljaWFsX2NvbmZpZyA9IGxvYWRfY29uZmlncyhvcy5wYXRoLmpvaW4oVU5PRkZJQ0lBTF9NT0RFTCwgInVub2ZmaWNpYWxfbXNzdF9tb2RlbC5qc29uIikpCiAgICBleGNlcHQgRmlsZU5vdEZvdW5kRXJyb3I6CiAgICAgICAgcmFpc2UgZ3IuRXJyb3IoaTE4bigi5qih5Z6L5LiN5a2Y5ZyoISIpKQogICAgZm9yIGtleXMgaW4gdW5vZmZpY2lhbF9jb25maWcua2V5cygpOgogICAgICAgIGZvciBtb2RlbCBpbiB1bm9mZmljaWFsX2NvbmZpZ1trZXlzXToKICAgICAgICAgICAgaWYgbW9kZWxbIm5hbWUiXSA9PSBtb2RlbF9uYW1lOgogICAgICAgICAgICAgICAgbW9kZWxfdHlwZSA9IG1vZGVsWyJtb2RlbF90eXBlIl0KICAgICAgICAgICAgICAgIG1vZGVsX3BhdGggPSBvcy5wYXRoLmpvaW4oTU9ERUxfRk9MREVSLCBrZXlzLCBtb2RlbF9uYW1lKQogICAgICAgICAgICAgICAgY29uZmlnX3BhdGggPSBtb2RlbFsiY29uZmlnX3BhdGgiXQogICAgICAgICAgICAgICAgZG93bmxvYWRfbGluayA9IG1vZGVsWyJsaW5rIl0KICAgICAgICAgICAgICAgIHJldHVybiBtb2RlbF9wYXRoLCBjb25maWdfcGF0aCwgbW9kZWxfdHlwZSwgZG93bmxvYWRfbGluawogICAgcmFpc2UgZ3IuRXJyb3IoaTE4bigi5qih5Z6L5LiN5a2Y5ZyoISIpKQoKZGVmIGxvYWRfdnJfbW9kZWwoKToKICAgIGRvd25sb2FkZWRfbW9kZWwgPSBbXQogICAgY29uZmlnID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJRykKICAgIHZyX21vZGVsX3BhdGggPSBjb25maWdbJ3NldHRpbmdzJ11bJ3V2cl9tb2RlbF9kaXInXQogICAgZm9yIGZpbGVzIGluIG9zLmxpc3RkaXIodnJfbW9kZWxfcGF0aCk6CiAgICAgICAgaWYgZmlsZXMuZW5kc3dpdGgoJy5wdGgnKToKICAgICAgICAgICAgZG93bmxvYWRlZF9tb2RlbC5hcHBlbmQoZmlsZXMpCiAgICByZXR1cm4gZG93bmxvYWRlZF9tb2RlbAoKZGVmIGdldF92cl9tb2RlbChtb2RlbCk6CiAgICBjb25maWcgPSBsb2FkX2NvbmZpZ3MoVlJfTU9ERUwpCiAgICB3ZWJ1aV9jb25maWcgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKQogICAgbW9kZWxfcGF0aCA9IHdlYnVpX2NvbmZpZ1snc2V0dGluZ3MnXVsndXZyX21vZGVsX2RpciddCiAgICBtYWluX2xpbmsgPSB3ZWJ1aV9jb25maWdbJ3NldHRpbmdzJ11bJ2Rvd25sb2FkX2xpbmsnXQogICAgaWYgbWFpbl9saW5rID09ICJBdXRvIjoKICAgICAgICBsYW5ndWFnZSA9IGxvY2FsZS5nZXRkZWZhdWx0bG9jYWxlKClbMF0KICAgICAgICBpZiBsYW5ndWFnZSBpbiBbInpoX0NOIiwgInpoX1RXIiwgInpoX0hLIiwgInpoX1NHIl06CiAgICAgICAgICAgIG1haW5fbGluayA9ICJoZi1taXJyb3IuY29tIgogICAgICAgIGVsc2U6IG1haW5fbGluayA9ICJodWdnaW5nZmFjZS5jbyIKICAgIGZvciBrZXlzIGluIGNvbmZpZy5rZXlzKCk6CiAgICAgICAgaWYga2V5cyA9PSBtb2RlbDoKICAgICAgICAgICAgcHJpbWFyeV9zdGVtID0gY29uZmlnW2tleXNdWyJwcmltYXJ5X3N0ZW0iXQogICAgICAgICAgICBzZWNvbmRhcnlfc3RlbSA9IGNvbmZpZ1trZXlzXVsic2Vjb25kYXJ5X3N0ZW0iXQogICAgICAgICAgICBtb2RlbF91cmwgPSBjb25maWdba2V5c11bImRvd25sb2FkX2xpbmsiXQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBtb2RlbF91cmwgPSBtb2RlbF91cmwucmVwbGFjZSgiaHVnZ2luZ2ZhY2UuY28iLCBtYWluX2xpbmspCiAgICAgICAgICAgIGV4Y2VwdDogcGFzcwogICAgICAgICAgICByZXR1cm4gcHJpbWFyeV9zdGVtLCBzZWNvbmRhcnlfc3RlbSwgbW9kZWxfdXJsLCBtb2RlbF9wYXRoCiAgICB0cnk6CiAgICAgICAgdW5vZmZpY2lhbF9jb25maWcgPSBsb2FkX2NvbmZpZ3Mob3MucGF0aC5qb2luKFVOT0ZGSUNJQUxfTU9ERUwsICJ1bm9mZmljaWFsX3ZyX21vZGVsLmpzb24iKSkKICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoKICAgICAgICByYWlzZSBnci5FcnJvcihpMThuKCLmqKHlnovkuI3lrZjlnKghIikpCiAgICBmb3Iga2V5cyBpbiB1bm9mZmljaWFsX2NvbmZpZy5rZXlzKCk6CiAgICAgICAgaWYga2V5cyA9PSBtb2RlbDoKICAgICAgICAgICAgcHJpbWFyeV9zdGVtID0gdW5vZmZpY2lhbF9jb25maWdba2V5c11bInByaW1hcnlfc3RlbSJdCiAgICAgICAgICAgIHNlY29uZGFyeV9zdGVtID0gdW5vZmZpY2lhbF9jb25maWdba2V5c11bInNlY29uZGFyeV9zdGVtIl0KICAgICAgICAgICAgbW9kZWxfdXJsID0gdW5vZmZpY2lhbF9jb25maWdba2V5c11bImRvd25sb2FkX2xpbmsiXQogICAgICAgICAgICByZXR1cm4gcHJpbWFyeV9zdGVtLCBzZWNvbmRhcnlfc3RlbSwgbW9kZWxfdXJsLCBtb2RlbF9wYXRoCiAgICByYWlzZSBnci5FcnJvcihpMThuKCLmqKHlnovkuI3lrZjlnKghIikpCgpkZWYgbG9hZF92cl9tb2RlbF9zdGVtKG1vZGVsKToKICAgIHByaW1hcnlfc3RlbSwgc2Vjb25kYXJ5X3N0ZW0sIF8sIF89IGdldF92cl9tb2RlbChtb2RlbCkKICAgIHJldHVybiBnci5DaGVja2JveChsYWJlbD1mIntwcmltYXJ5X3N0ZW19IE9ubHkiLCB2YWx1ZT1GYWxzZSwgaW50ZXJhY3RpdmU9VHJ1ZSksIGdyLkNoZWNrYm94KGxhYmVsPWYie3NlY29uZGFyeV9zdGVtfSBPbmx5IiwgdmFsdWU9RmFsc2UsIGludGVyYWN0aXZlPVRydWUpCgpkZWYgc2VsZWN0X2ZvbGRlcigpOgogICAgcm9vdCA9IHRrLlRrKCkKICAgIHJvb3Qud2l0aGRyYXcoKQogICAgcm9vdC5hdHRyaWJ1dGVzKCctdG9wbW9zdCcsIFRydWUpCiAgICBzZWxlY3RlZF9kaXIgPSBmaWxlZGlhbG9nLmFza2RpcmVjdG9yeSgpCiAgICByb290LmRlc3Ryb3koKQogICAgcmV0dXJuIHNlbGVjdGVkX2RpcgoKZGVmIHNlbGVjdF95YW1sX2ZpbGUoKToKICAgIHJvb3QgPSB0ay5UaygpCiAgICByb290LndpdGhkcmF3KCkKICAgIHJvb3QuYXR0cmlidXRlcygnLXRvcG1vc3QnLCBUcnVlKQogICAgc2VsZWN0ZWRfZmlsZSA9IGZpbGVkaWFsb2cuYXNrb3BlbmZpbGVuYW1lKAogICAgICAgIGZpbGV0eXBlcz1bKCdZQU1MIGZpbGVzJywgJyoueWFtbCcpXSkKICAgIHJvb3QuZGVzdHJveSgpCiAgICByZXR1cm4gc2VsZWN0ZWRfZmlsZQoKZGVmIHNlbGVjdF9maWxlKCk6CiAgICByb290ID0gdGsuVGsoKQogICAgcm9vdC53aXRoZHJhdygpCiAgICByb290LmF0dHJpYnV0ZXMoJy10b3Btb3N0JywgVHJ1ZSkKICAgIHNlbGVjdGVkX2ZpbGUgPSBmaWxlZGlhbG9nLmFza29wZW5maWxlbmFtZSgKICAgICAgICBmaWxldHlwZXM9WygnQWxsIGZpbGVzJywgJyouKicpXSkKICAgIHJvb3QuZGVzdHJveSgpCiAgICByZXR1cm4gc2VsZWN0ZWRfZmlsZQoKZGVmIG9wZW5fZm9sZGVyKGZvbGRlcik6CiAgICBpZiBmb2xkZXIgPT0gIiI6CiAgICAgICAgcmFpc2UgZ3IuRXJyb3IoaTE4bigi6K+35YWI6YCJ5oup5paH5Lu25aS5ISIpKQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGZvbGRlcik6CiAgICAgICAgb3MubWFrZWRpcnMoZm9sZGVyKQogICAgYWJzb2x1dGVfcGF0aCA9IG9zLnBhdGguYWJzcGF0aChmb2xkZXIpCiAgICBpZiBwbGF0Zm9ybS5zeXN0ZW0oKSA9PSAiV2luZG93cyI6CiAgICAgICAgb3Muc3lzdGVtKGYiZXhwbG9yZXIge2Fic29sdXRlX3BhdGh9IikKICAgIGVsaWYgcGxhdGZvcm0uc3lzdGVtKCkgPT0gIkRhcndpbiI6CiAgICAgICAgb3Muc3lzdGVtKGYib3BlbiB7YWJzb2x1dGVfcGF0aH0iKQogICAgZWxzZToKICAgICAgICBvcy5zeXN0ZW0oZiJ4ZGctb3BlbiB7YWJzb2x1dGVfcGF0aH0iKQoKZGVmIHNhdmVfdHJhaW5pbmdfY29uZmlnKHRyYWluX21vZGVsX3R5cGUsIHRyYWluX2NvbmZpZ19wYXRoLCB0cmFpbl9kYXRhc2V0X3R5cGUsIHRyYWluX2RhdGFzZXRfcGF0aCwgdHJhaW5fdmFsaWRfcGF0aCwgdHJhaW5fbnVtX3dvcmtlcnMsIHRyYWluX2RldmljZV9pZHMsIHRyYWluX3NlZWQsIHRyYWluX3Bpbl9tZW1vcnksIHRyYWluX3VzZV9tdWx0aXN0ZnRfbG9zcywgdHJhaW5fdXNlX21zZV9sb3NzLCB0cmFpbl91c2VfbDFfbG9zcywgdHJhaW5fcmVzdWx0c19wYXRoLCB0cmFpbl9hY2NlbGVyYXRlLCB0cmFpbl9wcmVfdmFsaWRhdGUpOgogICAgY29uZmlnID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJRykKICAgIGNvbmZpZ1sndHJhaW5pbmcnXVsnbW9kZWxfdHlwZSddID0gdHJhaW5fbW9kZWxfdHlwZQogICAgY29uZmlnWyd0cmFpbmluZyddWydjb25maWdfcGF0aCddID0gdHJhaW5fY29uZmlnX3BhdGgKICAgIGNvbmZpZ1sndHJhaW5pbmcnXVsnZGF0YXNldF90eXBlJ10gPSB0cmFpbl9kYXRhc2V0X3R5cGUKICAgIGNvbmZpZ1sndHJhaW5pbmcnXVsnZGF0YXNldF9wYXRoJ10gPSB0cmFpbl9kYXRhc2V0X3BhdGgKICAgIGNvbmZpZ1sndHJhaW5pbmcnXVsndmFsaWRfcGF0aCddID0gdHJhaW5fdmFsaWRfcGF0aAogICAgY29uZmlnWyd0cmFpbmluZyddWydudW1fd29ya2VycyddID0gdHJhaW5fbnVtX3dvcmtlcnMKICAgIGNvbmZpZ1sndHJhaW5pbmcnXVsnZGV2aWNlX2lkcyddID0gdHJhaW5fZGV2aWNlX2lkcwogICAgY29uZmlnWyd0cmFpbmluZyddWydzZWVkJ10gPSB0cmFpbl9zZWVkCiAgICBjb25maWdbJ3RyYWluaW5nJ11bJ3Bpbl9tZW1vcnknXSA9IHRyYWluX3Bpbl9tZW1vcnkKICAgIGNvbmZpZ1sndHJhaW5pbmcnXVsndXNlX211bHRpc3RmdF9sb3NzJ10gPSB0cmFpbl91c2VfbXVsdGlzdGZ0X2xvc3MKICAgIGNvbmZpZ1sndHJhaW5pbmcnXVsndXNlX21zZV9sb3NzJ10gPSB0cmFpbl91c2VfbXNlX2xvc3MKICAgIGNvbmZpZ1sndHJhaW5pbmcnXVsndXNlX2wxX2xvc3MnXSA9IHRyYWluX3VzZV9sMV9sb3NzCiAgICBjb25maWdbJ3RyYWluaW5nJ11bJ2FjY2VsZXJhdGUnXSA9IHRyYWluX2FjY2VsZXJhdGUKICAgIGNvbmZpZ1sndHJhaW5pbmcnXVsncHJlX3ZhbGlkJ10gPSB0cmFpbl9wcmVfdmFsaWRhdGUKICAgIGNvbmZpZ1sndHJhaW5pbmcnXVsncmVzdWx0c19wYXRoJ10gPSB0cmFpbl9yZXN1bHRzX3BhdGgKICAgIHNhdmVfY29uZmlncyhjb25maWcsIFdFQlVJX0NPTkZJRykKICAgIHJldHVybiBpMThuKCLphY3nva7kv53lrZjmiJDlip8hIikKCmRlZiBzYXZlX3ZyX2luZmVyZW5jZV9jb25maWcodnJfc2VsZWN0X21vZGVsLCB2cl93aW5kb3dfc2l6ZSwgdnJfYWdncmVzc2lvbiwgdnJfb3V0cHV0X2Zvcm1hdCwgdnJfdXNlX2NwdSwgdnJfcHJpbWFyeV9zdGVtX29ubHksIHZyX3NlY29uZGFyeV9zdGVtX29ubHksIHZyX211bHRpcGxlX2F1ZGlvX2lucHV0LCB2cl9zdG9yZV9kaXIsIHZyX2JhdGNoX3NpemUsIHZyX25vcm1hbGl6YXRpb24sIHZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGQsIHZyX2ludmVydF9zcGVjdCwgdnJfZW5hYmxlX3R0YSwgdnJfaGlnaF9lbmRfcHJvY2VzcywgdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcywgdnJfZGVidWdfbW9kZSk6CiAgICBjb25maWcgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKQogICAgY29uZmlnWydpbmZlcmVuY2UnXVsndnJfc2VsZWN0X21vZGVsJ10gPSB2cl9zZWxlY3RfbW9kZWwKICAgIGNvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX3dpbmRvd19zaXplJ10gPSB2cl93aW5kb3dfc2l6ZQogICAgY29uZmlnWydpbmZlcmVuY2UnXVsndnJfYWdncmVzc2lvbiddID0gdnJfYWdncmVzc2lvbgogICAgY29uZmlnWydpbmZlcmVuY2UnXVsndnJfb3V0cHV0X2Zvcm1hdCddID0gdnJfb3V0cHV0X2Zvcm1hdAogICAgY29uZmlnWydpbmZlcmVuY2UnXVsndnJfdXNlX2NwdSddID0gdnJfdXNlX2NwdQogICAgY29uZmlnWydpbmZlcmVuY2UnXVsndnJfcHJpbWFyeV9zdGVtX29ubHknXSA9IHZyX3ByaW1hcnlfc3RlbV9vbmx5CiAgICBjb25maWdbJ2luZmVyZW5jZSddWyd2cl9zZWNvbmRhcnlfc3RlbV9vbmx5J10gPSB2cl9zZWNvbmRhcnlfc3RlbV9vbmx5CiAgICBjb25maWdbJ2luZmVyZW5jZSddWyd2cl9tdWx0aXBsZV9hdWRpb19pbnB1dCddID0gdnJfbXVsdGlwbGVfYXVkaW9faW5wdXQKICAgIGNvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX3N0b3JlX2RpciddID0gdnJfc3RvcmVfZGlyCiAgICBjb25maWdbJ2luZmVyZW5jZSddWyd2cl9iYXRjaF9zaXplJ10gPSB2cl9iYXRjaF9zaXplCiAgICBjb25maWdbJ2luZmVyZW5jZSddWyd2cl9ub3JtYWxpemF0aW9uJ10gPSB2cl9ub3JtYWxpemF0aW9uCiAgICBjb25maWdbJ2luZmVyZW5jZSddWyd2cl9wb3N0X3Byb2Nlc3NfdGhyZXNob2xkJ10gPSB2cl9wb3N0X3Byb2Nlc3NfdGhyZXNob2xkCiAgICBjb25maWdbJ2luZmVyZW5jZSddWyd2cl9pbnZlcnRfc3BlY3QnXSA9IHZyX2ludmVydF9zcGVjdAogICAgY29uZmlnWydpbmZlcmVuY2UnXVsndnJfZW5hYmxlX3R0YSddID0gdnJfZW5hYmxlX3R0YQogICAgY29uZmlnWydpbmZlcmVuY2UnXVsndnJfaGlnaF9lbmRfcHJvY2VzcyddID0gdnJfaGlnaF9lbmRfcHJvY2VzcwogICAgY29uZmlnWydpbmZlcmVuY2UnXVsndnJfZW5hYmxlX3Bvc3RfcHJvY2VzcyddID0gdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcwogICAgY29uZmlnWydpbmZlcmVuY2UnXVsndnJfZGVidWdfbW9kZSddID0gdnJfZGVidWdfbW9kZQogICAgc2F2ZV9jb25maWdzKGNvbmZpZywgV0VCVUlfQ09ORklHKQoKZGVmIHNhdmVfbXNzdF9pbmZlcmVuY2VfY29uZmlnKHNlbGVjdGVkX21vZGVsLCBpbnB1dF9mb2xkZXIsIHN0b3JlX2RpciwgZXh0cmFjdF9pbnN0cnVtZW50YWwsIGdwdV9pZCwgb3V0cHV0X2Zvcm1hdCwgZm9yY2VfY3B1LCB1c2VfdHRhKToKICAgIGNvbmZpZyA9IGxvYWRfY29uZmlncyhXRUJVSV9DT05GSUcpCiAgICBjb25maWdbJ2luZmVyZW5jZSddWydzZWxlY3RlZF9tb2RlbCddID0gc2VsZWN0ZWRfbW9kZWwKICAgIGNvbmZpZ1snaW5mZXJlbmNlJ11bJ2dwdV9pZCddID0gZ3B1X2lkCiAgICBjb25maWdbJ2luZmVyZW5jZSddWydvdXRwdXRfZm9ybWF0J10gPSBvdXRwdXRfZm9ybWF0CiAgICBjb25maWdbJ2luZmVyZW5jZSddWydmb3JjZV9jcHUnXSA9IGZvcmNlX2NwdQogICAgY29uZmlnWydpbmZlcmVuY2UnXVsnZXh0cmFjdF9pbnN0cnVtZW50YWwnXSA9IGV4dHJhY3RfaW5zdHJ1bWVudGFsCiAgICBjb25maWdbJ2luZmVyZW5jZSddWyd1c2VfdHRhJ10gPSB1c2VfdHRhCiAgICBjb25maWdbJ2luZmVyZW5jZSddWydzdG9yZV9kaXInXSA9IHN0b3JlX2RpcgogICAgY29uZmlnWydpbmZlcmVuY2UnXVsnbXVsdGlwbGVfYXVkaW9faW5wdXQnXSA9IGlucHV0X2ZvbGRlcgogICAgc2F2ZV9jb25maWdzKGNvbmZpZywgV0VCVUlfQ09ORklHKQoKZGVmIHNhdmVfdXZyX21vZGVsZGlyKHNlbGVjdF91dnJfbW9kZWxfZGlyKToKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhzZWxlY3RfdXZyX21vZGVsX2Rpcik6CiAgICAgICAgcmV0dXJuIGkxOG4oIuivt+mAieaLqeato+ehrueahOaooeWei+ebruW9lSIpCiAgICBjb25maWcgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKQogICAgY29uZmlnWydzZXR0aW5ncyddWyd1dnJfbW9kZWxfZGlyJ10gPSBzZWxlY3RfdXZyX21vZGVsX2RpcgogICAgc2F2ZV9jb25maWdzKGNvbmZpZywgV0VCVUlfQ09ORklHKQogICAgcmV0dXJuIGkxOG4oIuiuvue9ruS/neWtmOaIkOWKnyEg6K+36YeN5ZCvV2ViVUnku6XlupTnlKjjgIIiKQoKZGVmIHJlc2V0X3NldHRpbmdzKCk6CiAgICB0cnk6CiAgICAgICAgY29uZmlnID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJRykKICAgICAgICBjb25maWdfYmFja3VwID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJR19CQUNLVVApCiAgICAgICAgZm9yIGtleSBpbiBjb25maWdfYmFja3VwWydzZXR0aW5ncyddW2tleV06CiAgICAgICAgICAgIGNvbmZpZ1snc2V0dGluZ3MnXVtrZXldID0gY29uZmlnX2JhY2t1cFsnc2V0dGluZ3MnXVtrZXldCiAgICAgICAgc2F2ZV9jb25maWdzKGNvbmZpZywgV0VCVUlfQ09ORklHKQogICAgICAgIHJldHVybiBpMThuKCLorr7nva7ph43nva7miJDlip8sIOivt+mHjeWQr1dlYlVJ5Yi35pawISAiKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGUpCiAgICAgICAgcmV0dXJuIGkxOG4oIuiuvue9rumHjee9ruWksei0pSEiKQoKZGVmIHJlc2V0X3dlYnVpX2NvbmZpZygpOgogICAgdHJ5OgogICAgICAgIGNvbmZpZyA9IGxvYWRfY29uZmlncyhXRUJVSV9DT05GSUcpCiAgICAgICAgY29uZmlnX2JhY2t1cCA9IGxvYWRfY29uZmlncyhXRUJVSV9DT05GSUdfQkFDS1VQKQogICAgICAgIGZvciBrZXkgaW4gY29uZmlnX2JhY2t1cFsndHJhaW5pbmcnXVtrZXldOgogICAgICAgICAgICBjb25maWdbJ3RyYWluaW5nJ11ba2V5XSA9IGNvbmZpZ19iYWNrdXBbJ3RyYWluaW5nJ11ba2V5XQogICAgICAgIGZvciBrZXkgaW4gY29uZmlnX2JhY2t1cFsnaW5mZXJlbmNlJ11ba2V5XToKICAgICAgICAgICAgY29uZmlnWydpbmZlcmVuY2UnXVtrZXldID0gY29uZmlnX2JhY2t1cFsnaW5mZXJlbmNlJ11ba2V5XQogICAgICAgIGZvciBrZXkgaW4gY29uZmlnX2JhY2t1cFsndG9vbHMnXVtrZXldOgogICAgICAgICAgICBjb25maWdbJ3Rvb2xzJ11ba2V5XSA9IGNvbmZpZ19iYWNrdXBbJ3Rvb2xzJ11ba2V5XQogICAgICAgIHNhdmVfY29uZmlncyhjb25maWcsIFdFQlVJX0NPTkZJRykKICAgICAgICByZXR1cm4gaTE4bigi6K6w5b2V6YeN572u5oiQ5YqfLCDor7fph43lkK9XZWJVSeWIt+aWsCEgIikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChlKQogICAgICAgIHJldHVybiBpMThuKCLorrDlvZXph43nva7lpLHotKUhIikKCmRlZiBpbml0X3NlbGVjdGVkX21vZGVsKCk6CiAgICB0cnk6CiAgICAgICAgYmF0Y2hfc2l6ZSwgZGltX3QsIG51bV9vdmVybGFwID0gaTE4bigi6K+l5qih5Z6L5LiN5pSv5oyB5L+u5pS55q2k5YC8IiksIGkxOG4oIuivpeaooeWei+S4jeaUr+aMgeS/ruaUueatpOWAvCIpLCBpMThuKCLor6XmqKHlnovkuI3mlK/mjIHkv67mlLnmraTlgLwiKQogICAgICAgIGNvbmZpZyA9IGxvYWRfY29uZmlncyhXRUJVSV9DT05GSUcpCiAgICAgICAgc2VsZWN0ZWRfbW9kZWwgPSBjb25maWdbJ2luZmVyZW5jZSddWydzZWxlY3RlZF9tb2RlbCddCiAgICAgICAgXywgY29uZmlnX3BhdGgsIF8sIF8gPSBnZXRfbXNzdF9tb2RlbChzZWxlY3RlZF9tb2RlbCkKICAgICAgICBjb25maWcgPSBsb2FkX2NvbmZpZ3MoY29uZmlnX3BhdGgpCiAgICAgICAgaWYgY29uZmlnLmluZmVyZW5jZS5nZXQoJ2JhdGNoX3NpemUnKToKICAgICAgICAgICAgYmF0Y2hfc2l6ZSA9IGNvbmZpZy5pbmZlcmVuY2UuZ2V0KCdiYXRjaF9zaXplJykKICAgICAgICBpZiBjb25maWcuaW5mZXJlbmNlLmdldCgnZGltX3QnKToKICAgICAgICAgICAgZGltX3QgPSBjb25maWcuaW5mZXJlbmNlLmdldCgnZGltX3QnKQogICAgICAgIGlmIGNvbmZpZy5pbmZlcmVuY2UuZ2V0KCdudW1fb3ZlcmxhcCcpOgogICAgICAgICAgICBudW1fb3ZlcmxhcCA9IGNvbmZpZy5pbmZlcmVuY2UuZ2V0KCdudW1fb3ZlcmxhcCcpCiAgICAgICAgcmV0dXJuIGJhdGNoX3NpemUsIGRpbV90LCBudW1fb3ZlcmxhcAogICAgZXhjZXB0OiByZXR1cm4gaTE4bigi6K+35YWI6YCJ5oup5qih5Z6LIiksIGkxOG4oIuivt+WFiOmAieaLqeaooeWeiyIpLCBpMThuKCLor7flhYjpgInmi6nmqKHlnosiKQoKZGVmIGluaXRfc2VsZWN0ZWRfdnJfbW9kZWwoKToKICAgIHdlYnVpX2NvbmZpZyA9IGxvYWRfY29uZmlncyhXRUJVSV9DT05GSUcpCiAgICBtb2RlbCA9IHdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX3NlbGVjdF9tb2RlbCddCiAgICB2cl9wcmltYXJ5X3N0ZW1fb25seSA9IGkxOG4oIuS7hei+k+WHuuS4u+mfs+i9qCIpCiAgICB2cl9zZWNvbmRhcnlfc3RlbV9vbmx5ID0gaTE4bigi5LuF6L6T5Ye65qyh6Z+z6L2oIikKICAgIGlmIG5vdCBtb2RlbDoKICAgICAgICByZXR1cm4gdnJfcHJpbWFyeV9zdGVtX29ubHksIHZyX3NlY29uZGFyeV9zdGVtX29ubHkKICAgIHRyeToKICAgICAgICBwcmltYXJ5X3N0ZW0sIHNlY29uZGFyeV9zdGVtLCBfLCBfID0gZ2V0X3ZyX21vZGVsKG1vZGVsKQogICAgICAgIHZyX3ByaW1hcnlfc3RlbV9vbmx5ID0gZiJ7cHJpbWFyeV9zdGVtfSBPbmx5IgogICAgICAgIHZyX3NlY29uZGFyeV9zdGVtX29ubHkgPSBmIntzZWNvbmRhcnlfc3RlbX0gT25seSIKICAgICAgICByZXR1cm4gdnJfcHJpbWFyeV9zdGVtX29ubHksIHZyX3NlY29uZGFyeV9zdGVtX29ubHkKICAgIGV4Y2VwdDogcmV0dXJuIHZyX3ByaW1hcnlfc3RlbV9vbmx5LCB2cl9zZWNvbmRhcnlfc3RlbV9vbmx5CgpkZWYgdXBkYXRlX3RyYWluX3N0YXJ0X2NoZWNrX3BvaW50KHBhdGgpOgogICAgaWYgbm90IG9zLnBhdGguaXNkaXIocGF0aCk6CiAgICAgICAgcmFpc2UgZ3IuRXJyb3IoaTE4bigi6K+35YWI6YCJ5oup5qih5Z6L5L+d5a2Y6Lev5b6EISAiKSkKICAgIGNrcHRfZmlsZXMgPSBbZiBmb3IgZiBpbiBvcy5saXN0ZGlyKHBhdGgpIGlmIGYuZW5kc3dpdGgoKCcuY2twdCcsICcuY2hwdCcsICcudGgnKSldCiAgICByZXR1cm4gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi5Yid5aeL5qih5Z6LIiksIGNob2ljZXM9Y2twdF9maWxlcyBpZiBja3B0X2ZpbGVzIGVsc2UgWyJOb25lIl0pCgpkZWYgdXBkYXRlX3NlbGVjdGVkX21vZGVsKG1vZGVsX3R5cGUpOgogICAgd2VidWlfY29uZmlnID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJRykKICAgIHdlYnVpX2NvbmZpZ1siaW5mZXJlbmNlIl1bIm1vZGVsX3R5cGUiXSA9IG1vZGVsX3R5cGUKICAgIHNhdmVfY29uZmlncyh3ZWJ1aV9jb25maWcsIFdFQlVJX0NPTkZJRykKICAgIHJldHVybiBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6nmqKHlnosiKSwgY2hvaWNlcz1sb2FkX3NlbGVjdGVkX21vZGVsKCksIHZhbHVlPU5vbmUsIGludGVyYWN0aXZlPVRydWUsIHNjYWxlPTQpCgpkZWYgdXBkYXRlX2luZmVyZW5jZV9zZXR0aW5ncyhzZWxlY3RlZF9tb2RlbCk6CiAgICBiYXRjaF9zaXplID0gZ3IuVGV4dGJveChsYWJlbD0iYmF0Y2hfc2l6ZSIsIHZhbHVlPWkxOG4oIuivpeaooeWei+S4jeaUr+aMgeS/ruaUueatpOWAvCIpLCBpbnRlcmFjdGl2ZT1GYWxzZSkKICAgIGRpbV90ID0gZ3IuVGV4dGJveChsYWJlbD0iZGltX3QiLCB2YWx1ZT1pMThuKCLor6XmqKHlnovkuI3mlK/mjIHkv67mlLnmraTlgLwiKSwgaW50ZXJhY3RpdmU9RmFsc2UpCiAgICBudW1fb3ZlcmxhcCA9IGdyLlRleHRib3gobGFiZWw9Im51bV9vdmVybGFwIiwgdmFsdWU9aTE4bigi6K+l5qih5Z6L5LiN5pSv5oyB5L+u5pS55q2k5YC8IiksIGludGVyYWN0aXZlPUZhbHNlKQogICAgbm9ybWFsaXplID0gZ3IuQ2hlY2tib3gobGFiZWw9aTE4bigibm9ybWFsaXplICjor6XmqKHlnovkuI3mlK/mjIHkv67mlLnmraTlgLwpICIpLCB2YWx1ZT1GYWxzZSwgaW50ZXJhY3RpdmU9RmFsc2UpCiAgICBpZiBzZWxlY3RlZF9tb2RlbCBhbmQgc2VsZWN0ZWRfbW9kZWwgIT0iIjoKICAgICAgICBfLCBjb25maWdfcGF0aCwgXywgXyA9IGdldF9tc3N0X21vZGVsKHNlbGVjdGVkX21vZGVsKQogICAgICAgIGNvbmZpZyA9IGxvYWRfY29uZmlncyhjb25maWdfcGF0aCkKICAgICAgICBpZiBjb25maWcuaW5mZXJlbmNlLmdldCgnYmF0Y2hfc2l6ZScpOgogICAgICAgICAgICBiYXRjaF9zaXplID0gZ3IuVGV4dGJveChsYWJlbD0iYmF0Y2hfc2l6ZSIsIHZhbHVlPXN0cihjb25maWcuaW5mZXJlbmNlLmdldCgnYmF0Y2hfc2l6ZScpKSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICBpZiBjb25maWcuaW5mZXJlbmNlLmdldCgnZGltX3QnKToKICAgICAgICAgICAgZGltX3QgPSBnci5UZXh0Ym94KGxhYmVsPSJkaW1fdCIsIHZhbHVlPXN0cihjb25maWcuaW5mZXJlbmNlLmdldCgnZGltX3QnKSksIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgaWYgY29uZmlnLmluZmVyZW5jZS5nZXQoJ251bV9vdmVybGFwJyk6CiAgICAgICAgICAgIG51bV9vdmVybGFwID0gZ3IuVGV4dGJveChsYWJlbD0ibnVtX292ZXJsYXAiLCB2YWx1ZT1zdHIoY29uZmlnLmluZmVyZW5jZS5nZXQoJ251bV9vdmVybGFwJykpLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgIGlmIGNvbmZpZy5pbmZlcmVuY2UuZ2V0KCdub3JtYWxpemUnKToKICAgICAgICAgICAgbm9ybWFsaXplID0gZ3IuQ2hlY2tib3gobGFiZWw9Im5vcm1hbGl6ZSIsIHZhbHVlPWNvbmZpZy5pbmZlcmVuY2UuZ2V0KCdub3JtYWxpemUnKSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgIHJldHVybiBiYXRjaF9zaXplLCBkaW1fdCwgbnVtX292ZXJsYXAsIG5vcm1hbGl6ZQoKZGVmIHNhdmVfY29uZmlnKHNlbGVjdGVkX21vZGVsLCBiYXRjaF9zaXplLCBkaW1fdCwgbnVtX292ZXJsYXAsIG5vcm1hbGl6ZSk6CiAgICBfLCBjb25maWdfcGF0aCwgXywgXyA9IGdldF9tc3N0X21vZGVsKHNlbGVjdGVkX21vZGVsKQogICAgY29uZmlnID0gbG9hZF9jb25maWdzKGNvbmZpZ19wYXRoKQogICAgaWYgY29uZmlnLmluZmVyZW5jZS5nZXQoJ2JhdGNoX3NpemUnKToKICAgICAgICBjb25maWcuaW5mZXJlbmNlWydiYXRjaF9zaXplJ10gPSBpbnQoYmF0Y2hfc2l6ZSkgaWYgYmF0Y2hfc2l6ZS5pc2RpZ2l0KCkgZWxzZSBOb25lCiAgICBpZiBjb25maWcuaW5mZXJlbmNlLmdldCgnZGltX3QnKToKICAgICAgICBjb25maWcuaW5mZXJlbmNlWydkaW1fdCddID0gaW50KGRpbV90KSBpZiBkaW1fdC5pc2RpZ2l0KCkgZWxzZSBOb25lCiAgICBpZiBjb25maWcuaW5mZXJlbmNlLmdldCgnbnVtX292ZXJsYXAnKToKICAgICAgICBjb25maWcuaW5mZXJlbmNlWydudW1fb3ZlcmxhcCddID0gaW50KG51bV9vdmVybGFwKSBpZiBudW1fb3ZlcmxhcC5pc2RpZ2l0KCkgZWxzZSBOb25lCiAgICBpZiBjb25maWcuaW5mZXJlbmNlLmdldCgnbm9ybWFsaXplJyk6CiAgICAgICAgY29uZmlnLmluZmVyZW5jZVsnbm9ybWFsaXplJ10gPSBub3JtYWxpemUKICAgIHNhdmVfY29uZmlncyhjb25maWcsIGNvbmZpZ19wYXRoKQogICAgcmV0dXJuIGkxOG4oIumFjee9ruS/neWtmOaIkOWKnyEiKQoKZGVmIHJlc2V0X2NvbmZpZyhzZWxlY3RlZF9tb2RlbCk6CiAgICBfLCBvcmlnaW5hbF9jb25maWdfcGF0aCwgXywgXyA9IGdldF9tc3N0X21vZGVsKHNlbGVjdGVkX21vZGVsKQogICAgaWYgb3JpZ2luYWxfY29uZmlnX3BhdGguc3RhcnRzd2l0aChVTk9GRklDSUFMX01PREVMKToKICAgICAgICByZXR1cm4gaTE4bigi6Z2e5a6Y5pa55qih5Z6L5LiN5pSv5oyB6YeN572u6YWN572uISIpCiAgICBkaXJfcGF0aCwgZmlsZV9uYW1lID0gb3MucGF0aC5zcGxpdChvcmlnaW5hbF9jb25maWdfcGF0aCkKICAgIGJhY2t1cF9kaXJfcGF0aCA9IGRpcl9wYXRoLnJlcGxhY2UoImNvbmZpZ3MiLCAiY29uZmlnc19iYWNrdXAiLCAxKQogICAgYmFja3VwX2NvbmZpZ19wYXRoID0gb3MucGF0aC5qb2luKGJhY2t1cF9kaXJfcGF0aCwgZmlsZV9uYW1lKQogICAgaWYgb3MucGF0aC5leGlzdHMoYmFja3VwX2NvbmZpZ19wYXRoKToKICAgICAgICBzaHV0aWwuY29weShiYWNrdXBfY29uZmlnX3BhdGgsIG9yaWdpbmFsX2NvbmZpZ19wYXRoKQogICAgICAgIHVwZGF0ZV9pbmZlcmVuY2Vfc2V0dGluZ3Moc2VsZWN0ZWRfbW9kZWwpCiAgICAgICAgcmV0dXJuIGkxOG4oIumFjee9rumHjee9ruaIkOWKnyEiKQogICAgZWxzZToKICAgICAgICByZXR1cm4gaTE4bigi5aSH5Lu96YWN572u5paH5Lu25LiN5a2Y5ZyoISIpCgpkZWYgcnVuX2NvbW1hbmQoY29tbWFuZCk6CiAgICBnbG9iYWwgc3RvcF9hbGxfdGhyZWFkcwogICAgc3RvcF9hbGxfdGhyZWFkcyA9IEZhbHNlCiAgICBwcmludF9jb21tYW5kKGNvbW1hbmQpCiAgICB0cnk6CiAgICAgICAgcHJvY2VzcyA9IHN1YnByb2Nlc3MuUG9wZW4oY29tbWFuZCwgc2hlbGw9VHJ1ZSkKICAgICAgICBwcm9jID0gcHN1dGlsLlByb2Nlc3MocHJvY2Vzcy5waWQpCiAgICAgICAgd2hpbGUgcHJvY2Vzcy5wb2xsKCkgaXMgTm9uZToKICAgICAgICAgICAgaWYgc3RvcF9hbGxfdGhyZWFkczoKICAgICAgICAgICAgICAgIGZvciBjaGlsZCBpbiBwcm9jLmNoaWxkcmVuKHJlY3Vyc2l2ZT1UcnVlKToKICAgICAgICAgICAgICAgICAgICBjaGlsZC50ZXJtaW5hdGUoKQogICAgICAgICAgICAgICAgcHJvY2Vzcy50ZXJtaW5hdGUoKQogICAgICAgICAgICAgICAgc3RvcF9hbGxfdGhyZWFkcyA9IEZhbHNlCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBwcm9jZXNzLnJldHVybmNvZGUgIT0gMDoKICAgICAgICAgICAgZ3IuRXJyb3IoaTE4bigi5Y+R55Sf6ZSZ6K+vISDor7fliY3lvoDnu4jnq6/mn6XnnIvor6bnu4bkv6Hmga8iKSkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChlKQogICAgICAgIHJhaXNlIGdyLkVycm9yKGkxOG4oIuWPkeeUn+mUmeivryEg6K+35YmN5b6A57uI56uv5p+l55yL6K+m57uG5L+h5oGvIikpCgpkZWYgc3RvcF9hbGxfdGhyZWFkKCk6CiAgICBnbG9iYWwgc3RvcF9hbGxfdGhyZWFkcywgc3RvcF9pbmZlcl9mbG93CiAgICBmb3IgdGhyZWFkIGluIHRocmVhZGluZy5lbnVtZXJhdGUoKToKICAgICAgICBpZiB0aHJlYWQubmFtZSBpbiBbIm1zc3RfaW5mZXJlbmNlIiwgInZyX2luZmVyZW5jZSIsICJtc3N0X3RyYWluaW5nIiwgIm1zc3RfdmFsaWQiXToKICAgICAgICAgICAgc3RvcF9hbGxfdGhyZWFkcyA9IFRydWUKICAgICAgICAgICAgc3RvcF9pbmZlcl9mbG93ID0gVHJ1ZQogICAgICAgICAgICBnci5JbmZvKGkxOG4oIuW3suWBnOatoui/m+eoiyIpKQogICAgICAgICAgICBwcmludCgiW0lORk9dICIgKyBpMThuKCLlt7LlgZzmraLov5vnqIsiKSkKCmRlZiBydW5faW5mZXJlbmNlX3NpbmdsZShzZWxlY3RlZF9tb2RlbCwgaW5wdXRfYXVkaW8sIHN0b3JlX2RpciwgZXh0cmFjdF9pbnN0cnVtZW50YWwsIGdwdV9pZCwgb3V0cHV0X2Zvcm1hdCwgZm9yY2VfY3B1LCB1c2VfdHRhKToKICAgIGlucHV0X2ZvbGRlciA9IE5vbmUKICAgIGlmIG5vdCBpbnB1dF9hdWRpbzoKICAgICAgICByZXR1cm4gaTE4bigi6K+35LiK5Lyg5LiA5Liq6Z+z6aKR5paH5Lu244CCIikKICAgIGlmIG9zLnBhdGguZXhpc3RzKFRFTVBfUEFUSCk6CiAgICAgICAgc2h1dGlsLnJtdHJlZShURU1QX1BBVEgpCiAgICBvcy5tYWtlZGlycyhURU1QX1BBVEgpCiAgICBzaHV0aWwuY29weShpbnB1dF9hdWRpbywgVEVNUF9QQVRIKQogICAgaW5wdXRfcGF0aCA9IFRFTVBfUEFUSAogICAgc2F2ZV9tc3N0X2luZmVyZW5jZV9jb25maWcoc2VsZWN0ZWRfbW9kZWwsIGlucHV0X2ZvbGRlciwgc3RvcmVfZGlyLCBleHRyYWN0X2luc3RydW1lbnRhbCwgZ3B1X2lkLCBvdXRwdXRfZm9ybWF0LCBmb3JjZV9jcHUsIHVzZV90dGEpCiAgICBydW5faW5mZXJlbmNlKHNlbGVjdGVkX21vZGVsLCBpbnB1dF9wYXRoLCBzdG9yZV9kaXIsZXh0cmFjdF9pbnN0cnVtZW50YWwsIGdwdV9pZCwgb3V0cHV0X2Zvcm1hdCwgZm9yY2VfY3B1LCB1c2VfdHRhKQogICAgcmV0dXJuIGkxOG4oIuWkhOeQhuWujOaIkCEg5YiG56a75a6M5oiQ55qE6Z+z6aKR5paH5Lu25bey5L+d5a2Y5ZyoIikgKyBzdG9yZV9kaXIKCmRlZiBydW5fbXVsdGlfaW5mZXJlbmNlKHNlbGVjdGVkX21vZGVsLCBpbnB1dF9mb2xkZXIsIHN0b3JlX2RpciwgZXh0cmFjdF9pbnN0cnVtZW50YWwsIGdwdV9pZCwgb3V0cHV0X2Zvcm1hdCwgZm9yY2VfY3B1LCB1c2VfdHRhKToKICAgIHNhdmVfbXNzdF9pbmZlcmVuY2VfY29uZmlnKHNlbGVjdGVkX21vZGVsLCBpbnB1dF9mb2xkZXIsIHN0b3JlX2RpciwgZXh0cmFjdF9pbnN0cnVtZW50YWwsIGdwdV9pZCwgb3V0cHV0X2Zvcm1hdCwgZm9yY2VfY3B1LCB1c2VfdHRhKQogICAgcnVuX2luZmVyZW5jZShzZWxlY3RlZF9tb2RlbCwgaW5wdXRfZm9sZGVyLCBzdG9yZV9kaXIsZXh0cmFjdF9pbnN0cnVtZW50YWwsIGdwdV9pZCwgb3V0cHV0X2Zvcm1hdCwgZm9yY2VfY3B1LCB1c2VfdHRhKQogICAgcmV0dXJuIGkxOG4oIuWkhOeQhuWujOaIkCEg5YiG56a75a6M5oiQ55qE6Z+z6aKR5paH5Lu25bey5L+d5a2Y5ZyoIikgKyBzdG9yZV9kaXIKCmRlZiBydW5faW5mZXJlbmNlKHNlbGVjdGVkX21vZGVsLCBpbnB1dF9mb2xkZXIsIHN0b3JlX2RpciwgZXh0cmFjdF9pbnN0cnVtZW50YWwsIGdwdV9pZCwgb3V0cHV0X2Zvcm1hdCwgZm9yY2VfY3B1LCB1c2VfdHRhLCBleHRyYV9zdG9yZV9kaXI9Tm9uZSk6CiAgICBpZiBub3QgYm9vbChyZS5tYXRjaChyJ14oXGQrKSg/OlxzKD8hXDEpXGQrKSokJywgZ3B1X2lkKSk6CiAgICAgICAgcmFpc2UgZ3IuRXJyb3IoaTE4bigiR1BVIElE5qC85byP6ZSZ6K+vLCDor7fph43mlrDovpPlhaUiKSkKICAgIGlmIHNlbGVjdGVkX21vZGVsID09ICIiOgogICAgICAgIHJhaXNlIGdyLkVycm9yKGkxOG4oIuivt+mAieaLqeaooeWeiyIpKQogICAgaWYgaW5wdXRfZm9sZGVyID09ICIiOgogICAgICAgIHJhaXNlIGdyLkVycm9yKGkxOG4oIuivt+mAieaLqei+k+WFpeebruW9lSIpKQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHN0b3JlX2Rpcik6CiAgICAgICAgb3MubWFrZWRpcnMoc3RvcmVfZGlyKQogICAgaWYgZXh0cmFfc3RvcmVfZGlyIGFuZCBub3Qgb3MucGF0aC5leGlzdHMoZXh0cmFfc3RvcmVfZGlyKToKICAgICAgICBvcy5tYWtlZGlycyhleHRyYV9zdG9yZV9kaXIpCiAgICBzdGFydF9jaGVja19wb2ludCwgY29uZmlnX3BhdGgsIG1vZGVsX3R5cGUsIF8gPSBnZXRfbXNzdF9tb2RlbChzZWxlY3RlZF9tb2RlbCkKICAgIGdwdV9pZHMgPSBncHVfaWQgaWYgbm90IGZvcmNlX2NwdSBlbHNlICIwIgogICAgZXh0cmFjdF9pbnN0cnVtZW50YWxfb3B0aW9uID0gIi0tZXh0cmFjdF9pbnN0cnVtZW50YWwiIGlmIGV4dHJhY3RfaW5zdHJ1bWVudGFsIGVsc2UgIiIKICAgIGZvcmNlX2NwdV9vcHRpb24gPSAiLS1mb3JjZV9jcHUiIGlmIGZvcmNlX2NwdSBlbHNlICIiCiAgICB1c2VfdHRhX29wdGlvbiA9ICItLXVzZV90dGEiIGlmIHVzZV90dGEgZWxzZSAiIgogICAgZXh0cmFfc3RvcmVfZGlyID0gZiItLWV4dHJhX3N0b3JlX2RpciBcIntleHRyYV9zdG9yZV9kaXJ9XCIiIGlmIGV4dHJhX3N0b3JlX2RpciBlbHNlICIiCiAgICBjb21tYW5kID0gZiJ7UFlUSE9OfSBtc3N0X2luZmVyZW5jZS5weSAtLW1vZGVsX3R5cGUge21vZGVsX3R5cGV9IC0tY29uZmlnX3BhdGggXCJ7Y29uZmlnX3BhdGh9XCIgLS1zdGFydF9jaGVja19wb2ludCBcIntzdGFydF9jaGVja19wb2ludH1cIiAtLWlucHV0X2ZvbGRlciBcIntpbnB1dF9mb2xkZXJ9XCIgLS1zdG9yZV9kaXIgXCJ7c3RvcmVfZGlyfVwiIC0tZGV2aWNlX2lkcyB7Z3B1X2lkc30gLS1vdXRwdXRfZm9ybWF0IHtvdXRwdXRfZm9ybWF0fSB7ZXh0cmFjdF9pbnN0cnVtZW50YWxfb3B0aW9ufSB7Zm9yY2VfY3B1X29wdGlvbn0ge3VzZV90dGFfb3B0aW9ufSB7ZXh0cmFfc3RvcmVfZGlyfSIKICAgIG1zc3RfaW5mZXJlbmNlID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9cnVuX2NvbW1hbmQsIGFyZ3M9KGNvbW1hbmQsKSwgbmFtZT0ibXNzdF9pbmZlcmVuY2UiKQogICAgbXNzdF9pbmZlcmVuY2Uuc3RhcnQoKQogICAgbXNzdF9pbmZlcmVuY2Uuam9pbigpCgpkZWYgdnJfaW5mZXJlbmNlX3NpbmdsZSh2cl9zZWxlY3RfbW9kZWwsIHZyX3dpbmRvd19zaXplLCB2cl9hZ2dyZXNzaW9uLCB2cl9vdXRwdXRfZm9ybWF0LCB2cl91c2VfY3B1LCB2cl9wcmltYXJ5X3N0ZW1fb25seSwgdnJfc2Vjb25kYXJ5X3N0ZW1fb25seSwgdnJfc2luZ2xlX2F1ZGlvLCB2cl9zdG9yZV9kaXIsIHZyX2JhdGNoX3NpemUsIHZyX25vcm1hbGl6YXRpb24sIHZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGQsIHZyX2ludmVydF9zcGVjdCwgdnJfZW5hYmxlX3R0YSwgdnJfaGlnaF9lbmRfcHJvY2VzcywgdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcywgdnJfZGVidWdfbW9kZSk6CiAgICB2cl9tdWx0aXBsZV9hdWRpb19pbnB1dCA9IE5vbmUKICAgIGlmIG5vdCBvcy5wYXRoLmlzZmlsZSh2cl9zaW5nbGVfYXVkaW8pOgogICAgICAgIHJldHVybiBpMThuKCLor7fkuIrkvKDkuIDkuKrpn7PpopHmlofku7YiKQogICAgaWYgbm90IHZyX3NlbGVjdF9tb2RlbDoKICAgICAgICByZXR1cm4gaTE4bigi6K+36YCJ5oup5qih5Z6LIikKICAgIGlmIG5vdCB2cl9zdG9yZV9kaXI6CiAgICAgICAgcmV0dXJuIGkxOG4oIuivt+mAieaLqei+k+WHuuebruW9lSIpCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHModnJfc3RvcmVfZGlyKToKICAgICAgICBvcy5tYWtlZGlycyh2cl9zdG9yZV9kaXIpCiAgICBpZiBvcy5wYXRoLmV4aXN0cyhURU1QX1BBVEgpOgogICAgICAgIHNodXRpbC5ybXRyZWUoVEVNUF9QQVRIKQogICAgb3MubWFrZWRpcnMoVEVNUF9QQVRIKQogICAgc2h1dGlsLmNvcHkodnJfc2luZ2xlX2F1ZGlvLCBURU1QX1BBVEgpCiAgICB2cl9zaW5nbGVfYXVkaW8gPSBvcy5wYXRoLmpvaW4oVEVNUF9QQVRILCBvcy5wYXRoLmJhc2VuYW1lKHZyX3NpbmdsZV9hdWRpbykpCiAgICBzYXZlX3ZyX2luZmVyZW5jZV9jb25maWcodnJfc2VsZWN0X21vZGVsLCB2cl93aW5kb3dfc2l6ZSwgdnJfYWdncmVzc2lvbiwgdnJfb3V0cHV0X2Zvcm1hdCwgdnJfdXNlX2NwdSwgdnJfcHJpbWFyeV9zdGVtX29ubHksIHZyX3NlY29uZGFyeV9zdGVtX29ubHksIHZyX211bHRpcGxlX2F1ZGlvX2lucHV0LCB2cl9zdG9yZV9kaXIsIHZyX2JhdGNoX3NpemUsIHZyX25vcm1hbGl6YXRpb24sIHZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGQsIHZyX2ludmVydF9zcGVjdCwgdnJfZW5hYmxlX3R0YSwgdnJfaGlnaF9lbmRfcHJvY2VzcywgdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcywgdnJfZGVidWdfbW9kZSkKICAgIHZyX2luZmVyZW5jZSh2cl9zZWxlY3RfbW9kZWwsIHZyX3dpbmRvd19zaXplLCB2cl9hZ2dyZXNzaW9uLCB2cl9vdXRwdXRfZm9ybWF0LCB2cl91c2VfY3B1LCB2cl9wcmltYXJ5X3N0ZW1fb25seSwgdnJfc2Vjb25kYXJ5X3N0ZW1fb25seSwgdnJfc2luZ2xlX2F1ZGlvLCB2cl9zdG9yZV9kaXIsIHZyX2JhdGNoX3NpemUsIHZyX25vcm1hbGl6YXRpb24sIHZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGQsIHZyX2ludmVydF9zcGVjdCwgdnJfZW5hYmxlX3R0YSwgdnJfaGlnaF9lbmRfcHJvY2VzcywgdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcywgdnJfZGVidWdfbW9kZSkKICAgIHJldHVybiBpMThuKCLlpITnkIblrozmiJAsIOe7k+aenOW3suS/neWtmOiHsyIpICsgdnJfc3RvcmVfZGlyCgpkZWYgdnJfaW5mZXJlbmNlX211bHRpKHZyX3NlbGVjdF9tb2RlbCwgdnJfd2luZG93X3NpemUsIHZyX2FnZ3Jlc3Npb24sIHZyX291dHB1dF9mb3JtYXQsIHZyX3VzZV9jcHUsIHZyX3ByaW1hcnlfc3RlbV9vbmx5LCB2cl9zZWNvbmRhcnlfc3RlbV9vbmx5LCB2cl9tdWx0aXBsZV9hdWRpb19pbnB1dCwgdnJfc3RvcmVfZGlyLCB2cl9iYXRjaF9zaXplLCB2cl9ub3JtYWxpemF0aW9uLCB2cl9wb3N0X3Byb2Nlc3NfdGhyZXNob2xkLCB2cl9pbnZlcnRfc3BlY3QsIHZyX2VuYWJsZV90dGEsIHZyX2hpZ2hfZW5kX3Byb2Nlc3MsIHZyX2VuYWJsZV9wb3N0X3Byb2Nlc3MsIHZyX2RlYnVnX21vZGUpOgogICAgaWYgbm90IG9zLnBhdGguaXNkaXIodnJfbXVsdGlwbGVfYXVkaW9faW5wdXQpOgogICAgICAgIHJldHVybiBpMThuKCLor7fpgInmi6novpPlhaXmlofku7blpLkiKQogICAgaWYgbm90IHZyX3NlbGVjdF9tb2RlbDoKICAgICAgICByZXR1cm4gaTE4bigi6K+36YCJ5oup5qih5Z6LIikKICAgIGlmIG5vdCB2cl9zdG9yZV9kaXI6CiAgICAgICAgcmV0dXJuIGkxOG4oIuivt+mAieaLqei+k+WHuuebruW9lSIpCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHModnJfc3RvcmVfZGlyKToKICAgICAgICBvcy5tYWtlZGlycyh2cl9zdG9yZV9kaXIpCiAgICBzYXZlX3ZyX2luZmVyZW5jZV9jb25maWcodnJfc2VsZWN0X21vZGVsLCB2cl93aW5kb3dfc2l6ZSwgdnJfYWdncmVzc2lvbiwgdnJfb3V0cHV0X2Zvcm1hdCwgdnJfdXNlX2NwdSwgdnJfcHJpbWFyeV9zdGVtX29ubHksIHZyX3NlY29uZGFyeV9zdGVtX29ubHksIHZyX211bHRpcGxlX2F1ZGlvX2lucHV0LCB2cl9zdG9yZV9kaXIsIHZyX2JhdGNoX3NpemUsIHZyX25vcm1hbGl6YXRpb24sIHZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGQsIHZyX2ludmVydF9zcGVjdCwgdnJfZW5hYmxlX3R0YSwgdnJfaGlnaF9lbmRfcHJvY2VzcywgdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcywgdnJfZGVidWdfbW9kZSkKICAgIHZyX2luZmVyZW5jZSh2cl9zZWxlY3RfbW9kZWwsIHZyX3dpbmRvd19zaXplLCB2cl9hZ2dyZXNzaW9uLCB2cl9vdXRwdXRfZm9ybWF0LCB2cl91c2VfY3B1LCB2cl9wcmltYXJ5X3N0ZW1fb25seSwgdnJfc2Vjb25kYXJ5X3N0ZW1fb25seSwgdnJfbXVsdGlwbGVfYXVkaW9faW5wdXQsIHZyX3N0b3JlX2RpciwgdnJfYmF0Y2hfc2l6ZSwgdnJfbm9ybWFsaXphdGlvbiwgdnJfcG9zdF9wcm9jZXNzX3RocmVzaG9sZCwgdnJfaW52ZXJ0X3NwZWN0LCB2cl9lbmFibGVfdHRhLCB2cl9oaWdoX2VuZF9wcm9jZXNzLCB2cl9lbmFibGVfcG9zdF9wcm9jZXNzLCB2cl9kZWJ1Z19tb2RlKQogICAgcmV0dXJuIGkxOG4oIuWkhOeQhuWujOaIkCwg57uT5p6c5bey5L+d5a2Y6IezIikgKyB2cl9zdG9yZV9kaXIKCmRlZiB2cl9pbmZlcmVuY2UodnJfc2VsZWN0X21vZGVsLCB2cl93aW5kb3dfc2l6ZSwgdnJfYWdncmVzc2lvbiwgdnJfb3V0cHV0X2Zvcm1hdCwgdnJfdXNlX2NwdSwgdnJfcHJpbWFyeV9zdGVtX29ubHksIHZyX3NlY29uZGFyeV9zdGVtX29ubHksIHZyX2F1ZGlvX2lucHV0LCB2cl9zdG9yZV9kaXIsIHZyX2JhdGNoX3NpemUsIHZyX25vcm1hbGl6YXRpb24sIHZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGQsIHZyX2ludmVydF9zcGVjdCwgdnJfZW5hYmxlX3R0YSwgdnJfaGlnaF9lbmRfcHJvY2VzcywgdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcywgdnJfZGVidWdfbW9kZSwgc2F2ZV9hbm90aGVyX3N0ZW09RmFsc2UsIGV4dHJhX291dHB1dF9kaXI9Tm9uZSk6CiAgICBwcmltYXJ5X3N0ZW0sIHNlY29uZGFyeV9zdGVtLCBfLCBtb2RlbF9maWxlX2RpciA9IGdldF92cl9tb2RlbCh2cl9zZWxlY3RfbW9kZWwpCiAgICBhdWRpb19maWxlID0gdnJfYXVkaW9faW5wdXQKICAgIG1vZGVsX2ZpbGVuYW1lID0gdnJfc2VsZWN0X21vZGVsCiAgICBvdXRwdXRfZm9ybWF0ID0gdnJfb3V0cHV0X2Zvcm1hdAogICAgb3V0cHV0X2RpciA9IHZyX3N0b3JlX2RpcgogICAgaW52ZXJ0X3NwZWN0ID0gIi0taW52ZXJ0X3NwZWN0IiBpZiB2cl9pbnZlcnRfc3BlY3QgZWxzZSAiIgogICAgbm9ybWFsaXphdGlvbiA9IHZyX25vcm1hbGl6YXRpb24KICAgIGRlYnVnX21vZGUgPSAiLS1kZWJ1ZyIgaWYgdnJfZGVidWdfbW9kZSBlbHNlICIiCiAgICBpZiB2cl9wcmltYXJ5X3N0ZW1fb25seToKICAgICAgICBpZiB2cl9zZWNvbmRhcnlfc3RlbV9vbmx5OgogICAgICAgICAgICBzaW5nbGVfc3RlbSA9ICIiCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2luZ2xlX3N0ZW0gPSBmIi0tc2luZ2xlX3N0ZW0gXCJ7cHJpbWFyeV9zdGVtfVwiIgogICAgZWxzZToKICAgICAgICBpZiB2cl9zZWNvbmRhcnlfc3RlbV9vbmx5OgogICAgICAgICAgICBzaW5nbGVfc3RlbSA9IGYiLS1zaW5nbGVfc3RlbSBcIntzZWNvbmRhcnlfc3RlbX1cIiIKICAgICAgICBlbHNlOgogICAgICAgICAgICBzaW5nbGVfc3RlbSA9ICIiCiAgICB2cl9iYXRjaF9zaXplID0gaW50KHZyX2JhdGNoX3NpemUpCiAgICB2cl9hZ2dyZXNzaW9uID0gaW50KHZyX2FnZ3Jlc3Npb24pCiAgICB1c2VfY3B1ID0gIi0tdXNlX2NwdSIgaWYgdnJfdXNlX2NwdSBlbHNlICIiCiAgICB2cl9lbmFibGVfdHRhID0gIi0tdnJfZW5hYmxlX3R0YSIgaWYgdnJfZW5hYmxlX3R0YSBlbHNlICIiCiAgICB2cl9oaWdoX2VuZF9wcm9jZXNzID0gIi0tdnJfaGlnaF9lbmRfcHJvY2VzcyIgaWYgdnJfaGlnaF9lbmRfcHJvY2VzcyBlbHNlICIiCiAgICB2cl9lbmFibGVfcG9zdF9wcm9jZXNzID0gIi0tdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcyIgaWYgdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcyBlbHNlICIiCiAgICBzYXZlX2Fub3RoZXJfc3RlbSA9ICItLXNhdmVfYW5vdGhlcl9zdGVtIiBpZiBzYXZlX2Fub3RoZXJfc3RlbSBlbHNlICIiCiAgICBleHRyYV9vdXRwdXRfZGlyID0gZiItLWV4dHJhX291dHB1dF9kaXIgXCJ7ZXh0cmFfb3V0cHV0X2Rpcn1cIiIgaWYgZXh0cmFfb3V0cHV0X2RpciBlbHNlICIiCiAgICBjb21tYW5kID0gZiJ7UFlUSE9OfSB1dnJfaW5mZXJlbmNlLnB5IFwie2F1ZGlvX2ZpbGV9XCIge2RlYnVnX21vZGV9IC0tbW9kZWxfZmlsZW5hbWUgXCJ7bW9kZWxfZmlsZW5hbWV9XCIgLS1vdXRwdXRfZm9ybWF0IHtvdXRwdXRfZm9ybWF0fSAtLW91dHB1dF9kaXIgXCJ7b3V0cHV0X2Rpcn1cIiAtLW1vZGVsX2ZpbGVfZGlyIFwie21vZGVsX2ZpbGVfZGlyfVwiIHtpbnZlcnRfc3BlY3R9IC0tbm9ybWFsaXphdGlvbiB7bm9ybWFsaXphdGlvbn0ge3NpbmdsZV9zdGVtfSB7dXNlX2NwdX0gLS12cl9iYXRjaF9zaXplIHt2cl9iYXRjaF9zaXplfSAtLXZyX3dpbmRvd19zaXplIHt2cl93aW5kb3dfc2l6ZX0gLS12cl9hZ2dyZXNzaW9uIHt2cl9hZ2dyZXNzaW9ufSB7dnJfZW5hYmxlX3R0YX0ge3ZyX2hpZ2hfZW5kX3Byb2Nlc3N9IHt2cl9lbmFibGVfcG9zdF9wcm9jZXNzfSAtLXZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGQge3ZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGR9IHtzYXZlX2Fub3RoZXJfc3RlbX0ge2V4dHJhX291dHB1dF9kaXJ9IgogICAgdnJfaW5mZXJlbmNlID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9cnVuX2NvbW1hbmQsIGFyZ3M9KGNvbW1hbmQsKSwgbmFtZT0idnJfaW5mZXJlbmNlIikKICAgIHZyX2luZmVyZW5jZS5zdGFydCgpCiAgICB2cl9pbmZlcmVuY2Uuam9pbigpCgpkZWYgdXBkYXRlX21vZGVsX25hbWUobW9kZWxfdHlwZSk6CiAgICBpZiBtb2RlbF90eXBlID09ICJVVlJfVlJfTW9kZWxzIjoKICAgICAgICBtb2RlbF9tYXAgPSBsb2FkX3ZyX21vZGVsKCkKICAgICAgICByZXR1cm4gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5qih5Z6LIiksIGNob2ljZXM9bW9kZWxfbWFwLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgZWxzZToKICAgICAgICBtb2RlbF9tYXAgPSBsb2FkX3NlbGVjdGVkX21vZGVsKG1vZGVsX3R5cGUpCiAgICAgICAgcmV0dXJuIGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIumAieaLqeaooeWeiyIpLCBjaG9pY2VzPW1vZGVsX21hcCwgaW50ZXJhY3RpdmU9VHJ1ZSkKCmRlZiB1cGRhdGVfbW9kZWxfc3RlbShtb2RlbF90eXBlLCBtb2RlbF9uYW1lKToKICAgIGlmIG1vZGVsX3R5cGUgPT0gIlVWUl9WUl9Nb2RlbHMiOgogICAgICAgIHByaW1hcnlfc3RlbSwgc2Vjb25kYXJ5X3N0ZW0sIF8sIF8gPSBnZXRfdnJfbW9kZWwobW9kZWxfbmFtZSkKICAgICAgICByZXR1cm4gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6L6T5Ye66Z+z6L2oIiksIGNob2ljZXM9W3ByaW1hcnlfc3RlbSwgc2Vjb25kYXJ5X3N0ZW1dLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgZWxzZToKICAgICAgICByZXR1cm4gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6L6T5Ye66Z+z6L2oIiksIGNob2ljZXM9WyJwcmltYXJ5X3N0ZW0iXSwgdmFsdWU9InByaW1hcnlfc3RlbSIsIGludGVyYWN0aXZlPUZhbHNlKQoKZGVmIGFkZF90b19mbG93X2Z1bmMobW9kZWxfdHlwZSwgbW9kZWxfbmFtZSwgc3RlbSwgc2Vjb25kYXJ5X291dHB1dCwgZGYpOgogICAgaWYgbm90IG1vZGVsX3R5cGUgb3Igbm90IG1vZGVsX25hbWU6CiAgICAgICAgcmV0dXJuIGRmCiAgICBpZiBtb2RlbF90eXBlID09ICJVVlJfVlJfTW9kZWxzIiBhbmQgbm90IHN0ZW06CiAgICAgICAgcmV0dXJuIGRmCiAgICBpZiBtb2RlbF90eXBlID09ICJVVlJfVlJfTW9kZWxzIiBhbmQgc3RlbSA9PSAicHJpbWFyeV9zdGVtIjoKICAgICAgICByZXR1cm4gZGYKICAgIGlmIG5vdCBzZWNvbmRhcnlfb3V0cHV0IG9yIHNlY29uZGFyeV9vdXRwdXQgPT0gIiI6CiAgICAgICAgc2Vjb25kYXJ5X291dHB1dCA9ICJGYWxzZSIKICAgIG5ld19kYXRhID0gcGQuRGF0YUZyYW1lKHsibW9kZWxfdHlwZSI6IFttb2RlbF90eXBlXSwgIm1vZGVsX25hbWUiOiBbbW9kZWxfbmFtZV0sICJzdGVtIjogW3N0ZW1dLCAic2Vjb25kYXJ5X291dHB1dCI6IFtzZWNvbmRhcnlfb3V0cHV0XX0pCiAgICBpZiBkZlsibW9kZWxfdHlwZSJdLmlsb2NbMF0gPT0gIiIgb3IgZGZbIm1vZGVsX25hbWUiXS5pbG9jWzBdID09ICIiOgogICAgICAgIHJldHVybiBuZXdfZGF0YQogICAgdXBkYXRlZF9kZiA9IHBkLmNvbmNhdChbZGYsIG5ld19kYXRhXSwgaWdub3JlX2luZGV4PVRydWUpCiAgICByZXR1cm4gdXBkYXRlZF9kZgoKZGVmIHNhdmVfZmxvd19mdW5jKHByZXNldF9uYW1lLCBkZik6CiAgICBwcmVzZXRfZGF0YSA9IGxvYWRfY29uZmlncyhQUkVTRVRTKQogICAgaWYgcHJlc2V0X25hbWUgaXMgTm9uZSBvciBwcmVzZXRfbmFtZSA9PSAiIjoKICAgICAgICBvdXRwdXRfbWVzc2FnZSA9IGkxOG4oIuivt+Whq+WGmemihOiuvuWQjeensCIpCiAgICAgICAgcHJlc2V0X25hbWVfZGVsZXRlID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6K+36YCJ5oup6aKE6K6+IiksIGNob2ljZXM9bGlzdChwcmVzZXRfZGF0YS5rZXlzKCkpKQogICAgICAgIHByZXNldF9uYW1lX3NlbGVjdCA9IGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIuivt+mAieaLqemihOiuviIpLCBjaG9pY2VzPWxpc3QocHJlc2V0X2RhdGEua2V5cygpKSkKICAgICAgICByZXR1cm4gb3V0cHV0X21lc3NhZ2UsIHByZXNldF9uYW1lX2RlbGV0ZSwgcHJlc2V0X25hbWVfc2VsZWN0CiAgICBwcmVzZXRfZGljdCA9IHtmIlN0ZXBfe2luZGV4ICsgMX0iOiByb3cuZHJvcG5hKCkudG9fZGljdCgpIGZvciBpbmRleCwgcm93IGluIGRmLml0ZXJyb3dzKCl9CiAgICBwcmVzZXRfZGF0YVtwcmVzZXRfbmFtZV0gPSBwcmVzZXRfZGljdAogICAgc2F2ZV9jb25maWdzKHByZXNldF9kYXRhLCBQUkVTRVRTKQogICAgb3V0cHV0X21lc3NhZ2UgPSBpMThuKCLpooTorr4iKSArIHByZXNldF9uYW1lICsgaTE4bigi5L+d5a2Y5oiQ5YqfIikKICAgIHByZXNldF9uYW1lX2RlbGV0ZSA9IGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIuivt+mAieaLqemihOiuviIpLCBjaG9pY2VzPWxpc3QocHJlc2V0X2RhdGEua2V5cygpKSkKICAgIHByZXNldF9uYW1lX3NlbGVjdCA9IGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIuivt+mAieaLqemihOiuviIpLCBjaG9pY2VzPWxpc3QocHJlc2V0X2RhdGEua2V5cygpKSkKICAgIHJldHVybiBvdXRwdXRfbWVzc2FnZSwgcHJlc2V0X25hbWVfZGVsZXRlLCBwcmVzZXRfbmFtZV9zZWxlY3QKCmRlZiByZXNldF9mbG93X2Z1bmMoKToKICAgIHJldHVybiBnci5EYXRhZnJhbWUocGQuRGF0YUZyYW1lKHsibW9kZWxfdHlwZSI6IFsiIl0sICJtb2RlbF9uYW1lIjogWyIiXSwgInN0ZW0iOiBbIiJdfSksIGludGVyYWN0aXZlPUZhbHNlLCBsYWJlbD1Ob25lKQoKZGVmIGxvYWRfcHJlc2V0KHByZXNldF9uYW1lKToKICAgIHByZXNldF9kYXRhID0gbG9hZF9jb25maWdzKFBSRVNFVFMpCiAgICBpZiBwcmVzZXRfbmFtZSBpbiBwcmVzZXRfZGF0YS5rZXlzKCk6CiAgICAgICAgcHJlc2V0X2Zsb3cgPSBwZC5EYXRhRnJhbWUoeyJtb2RlbF90eXBlIjogWyIiXSwgIm1vZGVsX25hbWUiOiBbIiJdLCAic3RlbSI6IFsiIl0sICJzZWNvbmRhcnlfb3V0cHV0IjogWyIiXX0pCiAgICAgICAgcHJlc2V0X2RpY3QgPSBwcmVzZXRfZGF0YVtwcmVzZXRfbmFtZV0KICAgICAgICBmb3Iga2V5IGluIHByZXNldF9kaWN0LmtleXMoKToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2Vjb25kYXJ5X291dHB1dCA9IHByZXNldF9kaWN0W2tleV1bInNlY29uZGFyeV9vdXRwdXQiXQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgICAgICBzZWNvbmRhcnlfb3V0cHV0ID0gIkZhbHNlIgogICAgICAgICAgICBwcmVzZXRfZmxvdyA9IGFkZF90b19mbG93X2Z1bmMocHJlc2V0X2RpY3Rba2V5XVsibW9kZWxfdHlwZSJdLCBwcmVzZXRfZGljdFtrZXldWyJtb2RlbF9uYW1lIl0sIHByZXNldF9kaWN0W2tleV1bInN0ZW0iXSwgc2Vjb25kYXJ5X291dHB1dCwgcHJlc2V0X2Zsb3cpCiAgICAgICAgcmV0dXJuIHByZXNldF9mbG93CiAgICByZXR1cm4gZ3IuRGF0YWZyYW1lKHBkLkRhdGFGcmFtZSh7Im1vZGVsX3R5cGUiOiBbaTE4bigi6aKE6K6+5LiN5a2Y5ZyoIildLCAibW9kZWxfbmFtZSI6IFtpMThuKCLpooTorr7kuI3lrZjlnKgiKV0sICJzdGVtIjogW2kxOG4oIumihOiuvuS4jeWtmOWcqCIpXSwgInNlY29uZGFyeV9vdXRwdXQiOiBbaTE4bigi6aKE6K6+5LiN5a2Y5ZyoIildfSksIGludGVyYWN0aXZlPUZhbHNlLCBsYWJlbD1Ob25lKQoKZGVmIGRlbGV0ZV9mdW5jKHByZXNldF9uYW1lKToKICAgIHByZXNldF9kYXRhID0gbG9hZF9jb25maWdzKFBSRVNFVFMpCiAgICBpZiBwcmVzZXRfbmFtZSBpbiBwcmVzZXRfZGF0YS5rZXlzKCk6CiAgICAgICAgXywgc2VsZWN0X3ByZXNldF9iYWNrdXAgPSBiYWNrdXBfcHJlc2V0X2Z1bmMoKQogICAgICAgIGRlbCBwcmVzZXRfZGF0YVtwcmVzZXRfbmFtZV0KICAgICAgICBzYXZlX2NvbmZpZ3MocHJlc2V0X2RhdGEsIFBSRVNFVFMpCiAgICAgICAgb3V0cHV0X21lc3NhZ2UgPSBpMThuKCLpooTorr4iKSArIHByZXNldF9uYW1lICsgaTE4bigi5Yig6Zmk5oiQ5YqfIikKICAgICAgICBwcmVzZXRfbmFtZV9kZWxldGUgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLor7fpgInmi6npooTorr4iKSwgY2hvaWNlcz1saXN0KHByZXNldF9kYXRhLmtleXMoKSkpCiAgICAgICAgcHJlc2V0X25hbWVfc2VsZWN0ID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6K+36YCJ5oup6aKE6K6+IiksIGNob2ljZXM9bGlzdChwcmVzZXRfZGF0YS5rZXlzKCkpKQogICAgICAgIHByZXNldF9mbG93X2RlbGV0ZSA9IGdyLkRhdGFmcmFtZShwZC5EYXRhRnJhbWUoeyJtb2RlbF90eXBlIjogW2kxOG4oIumihOiuvuW3suWIoOmZpCIpXSwgIm1vZGVsX25hbWUiOiBbaTE4bigi6aKE6K6+5bey5Yig6ZmkIildLCAic3RlbSI6IFtpMThuKCLpooTorr7lt7LliKDpmaQiKV0sICJzZWNvbmRhcnlfb3V0cHV0IjogW2kxOG4oIumihOiuvuW3suWIoOmZpCIpXX0pLCBpbnRlcmFjdGl2ZT1GYWxzZSwgbGFiZWw9Tm9uZSkKICAgICAgICByZXR1cm4gb3V0cHV0X21lc3NhZ2UsIHByZXNldF9uYW1lX2RlbGV0ZSwgcHJlc2V0X25hbWVfc2VsZWN0LCBwcmVzZXRfZmxvd19kZWxldGUsIHNlbGVjdF9wcmVzZXRfYmFja3VwCiAgICBlbHNlOgogICAgICAgIHJldHVybiBpMThuKCLpooTorr7kuI3lrZjlnKgiKQoKZGVmIHJ1bl9zaW5nbGVfaW5mZXJlbmNlX2Zsb3coaW5wdXRfYXVkaW8sIHN0b3JlX2RpciwgcHJlc2V0X25hbWUsIGZvcmNlX2NwdSwgb3V0cHV0X2Zvcm1hdF9mbG93KToKICAgIGlmIG5vdCBpbnB1dF9hdWRpbzoKICAgICAgICByZXR1cm4gaTE4bigi6K+35LiK5Lyg5LiA5Liq6Z+z6aKR5paH5Lu2IikKICAgIGlmIG9zLnBhdGguZXhpc3RzKFRFTVBfUEFUSCk6CiAgICAgICAgc2h1dGlsLnJtdHJlZShURU1QX1BBVEgpCiAgICBvcy5tYWtlZGlycyhURU1QX1BBVEgpCiAgICBzaHV0aWwuY29weShpbnB1dF9hdWRpbywgVEVNUF9QQVRIKQogICAgaW5wdXRfZm9sZGVyID0gVEVNUF9QQVRICiAgICBtc2cgPSBydW5faW5mZXJlbmNlX2Zsb3coaW5wdXRfZm9sZGVyLCBzdG9yZV9kaXIsIHByZXNldF9uYW1lLCBmb3JjZV9jcHUsIG91dHB1dF9mb3JtYXRfZmxvdywgaXNTaW5nbGU9VHJ1ZSkKICAgIHJldHVybiBtc2cKCmRlZiBydW5faW5mZXJlbmNlX2Zsb3coaW5wdXRfZm9sZGVyLCBzdG9yZV9kaXIsIHByZXNldF9uYW1lLCBmb3JjZV9jcHUsIG91dHB1dF9mb3JtYXRfZmxvdywgaXNTaW5nbGU9RmFsc2UpOgogICAgZ2xvYmFsIHN0b3BfaW5mZXJfZmxvdwogICAgc3RvcF9pbmZlcl9mbG93ID0gRmFsc2UKICAgIHN0YXJ0X3RpbWUgPSB0aW1lLnRpbWUoKQogICAgcHJlc2V0X2RhdGEgPSBsb2FkX2NvbmZpZ3MoUFJFU0VUUykKICAgIGlmIG5vdCBwcmVzZXRfbmFtZSBpbiBwcmVzZXRfZGF0YS5rZXlzKCk6CiAgICAgICAgcmV0dXJuIGkxOG4oIumihOiuviIpICsgcHJlc2V0X25hbWUgKyBpMThuKCLkuI3lrZjlnKgiKQogICAgY29uZmlnID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJRykKICAgIGNvbmZpZ1snaW5mZXJlbmNlJ11bJ3ByZXNldCddID0gcHJlc2V0X25hbWUKICAgIGNvbmZpZ1snaW5mZXJlbmNlJ11bJ2ZvcmNlX2NwdSddID0gZm9yY2VfY3B1CiAgICBjb25maWdbJ2luZmVyZW5jZSddWydvdXRwdXRfZm9ybWF0X2Zsb3cnXSA9IG91dHB1dF9mb3JtYXRfZmxvdwogICAgY29uZmlnWydpbmZlcmVuY2UnXVsnaW5wdXRfZm9sZGVyX2Zsb3cnXSA9IGlucHV0X2ZvbGRlcgogICAgY29uZmlnWydpbmZlcmVuY2UnXVsnc3RvcmVfZGlyX2Zsb3cnXSA9IHN0b3JlX2RpcgogICAgc2F2ZV9jb25maWdzKGNvbmZpZywgV0VCVUlfQ09ORklHKQogICAgbW9kZWxfbGlzdCA9IHByZXNldF9kYXRhW3ByZXNldF9uYW1lXQogICAgaW5wdXRfdG9fdXNlID0gaW5wdXRfZm9sZGVyCiAgICBpZiBvcy5wYXRoLmV4aXN0cyhURU1QX1BBVEgpIGFuZCBub3QgaXNTaW5nbGU6CiAgICAgICAgc2h1dGlsLnJtdHJlZShURU1QX1BBVEgpCiAgICB0bXBfc3RvcmVfZGlyID0gZiJ7VEVNUF9QQVRIfS9pbmZlcmZsb3dfc3RlcDFfb3V0cHV0IgogICAgZm9yIHN0ZXAgaW4gbW9kZWxfbGlzdC5rZXlzKCk6CiAgICAgICAgbW9kZWxfbmFtZSA9IG1vZGVsX2xpc3Rbc3RlcF1bIm1vZGVsX25hbWUiXQogICAgICAgIGlmIG1vZGVsX25hbWUgbm90IGluIGxvYWRfbXNzdF9tb2RlbCgpIGFuZCBtb2RlbF9uYW1lIG5vdCBpbiBsb2FkX3ZyX21vZGVsKCk6CiAgICAgICAgICAgIHJldHVybiBpMThuKCLmqKHlnosiKSArIG1vZGVsX25hbWUgKyBpMThuKCLkuI3lrZjlnKgiKQogICAgaSA9IDAKICAgIGZvciBzdGVwIGluIG1vZGVsX2xpc3Qua2V5cygpOgogICAgICAgIGlmIHN0b3BfaW5mZXJfZmxvdzoKICAgICAgICAgICAgc3RvcF9pbmZlcl9mbG93ID0gRmFsc2UKICAgICAgICAgICAgYnJlYWsKICAgICAgICBpZiBpID09IDA6CiAgICAgICAgICAgIGlucHV0X3RvX3VzZSA9IGlucHV0X2ZvbGRlcgogICAgICAgIGVsaWYgaSA8IGxlbihtb2RlbF9saXN0LmtleXMoKSkgLSAxIGFuZCBpID4gMDoKICAgICAgICAgICAgaWYgaW5wdXRfdG9fdXNlICE9IGlucHV0X2ZvbGRlcjoKICAgICAgICAgICAgICAgIHNodXRpbC5ybXRyZWUoaW5wdXRfdG9fdXNlKQogICAgICAgICAgICBpbnB1dF90b191c2UgPSB0bXBfc3RvcmVfZGlyCiAgICAgICAgICAgIHRtcF9zdG9yZV9kaXIgPSBmIntURU1QX1BBVEh9L2luZmVyZmxvd19zdGVwe2krMX1fb3V0cHV0IgogICAgICAgIGVsaWYgaSA9PSBsZW4obW9kZWxfbGlzdC5rZXlzKCkpIC0gMToKICAgICAgICAgICAgaW5wdXRfdG9fdXNlID0gdG1wX3N0b3JlX2RpcgogICAgICAgICAgICB0bXBfc3RvcmVfZGlyID0gc3RvcmVfZGlyCiAgICAgICAgY29uc29sZSA9IENvbnNvbGUoKQogICAgICAgIG1vZGVsX25hbWUgPSBtb2RlbF9saXN0W3N0ZXBdWyJtb2RlbF9uYW1lIl0KICAgICAgICBjb25zb2xlLnJ1bGUoZiJbeWVsbG93XVN0ZXAge2krMX06IFJ1bm5pbmcgaW5mZXJlbmNlIHVzaW5nIHttb2RlbF9uYW1lfSIsIHN0eWxlPSJ5ZWxsb3ciKQogICAgICAgIGlmIG1vZGVsX2xpc3Rbc3RlcF1bIm1vZGVsX3R5cGUiXSA9PSAiVVZSX1ZSX01vZGVscyI6CiAgICAgICAgICAgIHByaW1hcnlfc3RlbSwgc2Vjb25kYXJ5X3N0ZW0sIF8sIF8gPSBnZXRfdnJfbW9kZWwobW9kZWxfbmFtZSkKICAgICAgICAgICAgc3RlbSA9IG1vZGVsX2xpc3Rbc3RlcF1bInN0ZW0iXQogICAgICAgICAgICB2cl9zZWxlY3RfbW9kZWwgPSBtb2RlbF9uYW1lCiAgICAgICAgICAgIHZyX3dpbmRvd19zaXplID0gY29uZmlnWydpbmZlcmVuY2UnXVsndnJfd2luZG93X3NpemUnXQogICAgICAgICAgICB2cl9hZ2dyZXNzaW9uID0gY29uZmlnWydpbmZlcmVuY2UnXVsndnJfYWdncmVzc2lvbiddCiAgICAgICAgICAgIHZyX291dHB1dF9mb3JtYXQgPSBvdXRwdXRfZm9ybWF0X2Zsb3cKICAgICAgICAgICAgdnJfdXNlX2NwdSA9IGZvcmNlX2NwdQogICAgICAgICAgICB2cl9wcmltYXJ5X3N0ZW1fb25seSA9IFRydWUgaWYgc3RlbSA9PSBwcmltYXJ5X3N0ZW0gZWxzZSBGYWxzZQogICAgICAgICAgICB2cl9zZWNvbmRhcnlfc3RlbV9vbmx5ID0gVHJ1ZSBpZiBzdGVtID09IHNlY29uZGFyeV9zdGVtIGVsc2UgRmFsc2UKICAgICAgICAgICAgdnJfYXVkaW9faW5wdXQgPSBpbnB1dF90b191c2UKICAgICAgICAgICAgdnJfc3RvcmVfZGlyID0gdG1wX3N0b3JlX2RpcgogICAgICAgICAgICB2cl9iYXRjaF9zaXplID0gY29uZmlnWydpbmZlcmVuY2UnXVsndnJfYmF0Y2hfc2l6ZSddCiAgICAgICAgICAgIHZyX25vcm1hbGl6YXRpb24gPSBjb25maWdbJ2luZmVyZW5jZSddWyd2cl9ub3JtYWxpemF0aW9uJ10KICAgICAgICAgICAgdnJfcG9zdF9wcm9jZXNzX3RocmVzaG9sZCA9IGNvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGQnXQogICAgICAgICAgICB2cl9pbnZlcnRfc3BlY3QgPSBjb25maWdbJ2luZmVyZW5jZSddWyd2cl9pbnZlcnRfc3BlY3QnXQogICAgICAgICAgICB2cl9lbmFibGVfdHRhID0gY29uZmlnWydpbmZlcmVuY2UnXVsndnJfZW5hYmxlX3R0YSddCiAgICAgICAgICAgIHZyX2hpZ2hfZW5kX3Byb2Nlc3MgPSBjb25maWdbJ2luZmVyZW5jZSddWyd2cl9oaWdoX2VuZF9wcm9jZXNzJ10KICAgICAgICAgICAgdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcyA9IGNvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX2VuYWJsZV9wb3N0X3Byb2Nlc3MnXQogICAgICAgICAgICB2cl9kZWJ1Z19tb2RlID0gY29uZmlnWydpbmZlcmVuY2UnXVsndnJfZGVidWdfbW9kZSddCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlY29uZGFyeV9vdXRwdXQgPSBtb2RlbF9saXN0W3N0ZXBdWyJzZWNvbmRhcnlfb3V0cHV0Il0KICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgc2Vjb25kYXJ5X291dHB1dCA9ICJGYWxzZSIKICAgICAgICAgICAgaWYgc2Vjb25kYXJ5X291dHB1dCA9PSAiVHJ1ZSI6CiAgICAgICAgICAgICAgICBzYXZlX2Fub3RoZXJfc3RlbSA9IFRydWUKICAgICAgICAgICAgICAgIGV4dHJhX291dHB1dF9kaXIgPSBvcy5wYXRoLmpvaW4oc3RvcmVfZGlyLCAic2Vjb25kYXJ5X291dHB1dCIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzYXZlX2Fub3RoZXJfc3RlbSA9IEZhbHNlCiAgICAgICAgICAgICAgICBleHRyYV9vdXRwdXRfZGlyID0gTm9uZQogICAgICAgICAgICB2cl9pbmZlcmVuY2UodnJfc2VsZWN0X21vZGVsLCB2cl93aW5kb3dfc2l6ZSwgdnJfYWdncmVzc2lvbiwgdnJfb3V0cHV0X2Zvcm1hdCwgdnJfdXNlX2NwdSwgdnJfcHJpbWFyeV9zdGVtX29ubHksIHZyX3NlY29uZGFyeV9zdGVtX29ubHksIHZyX2F1ZGlvX2lucHV0LCB2cl9zdG9yZV9kaXIsIHZyX2JhdGNoX3NpemUsIHZyX25vcm1hbGl6YXRpb24sIHZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGQsIHZyX2ludmVydF9zcGVjdCwgdnJfZW5hYmxlX3R0YSwgdnJfaGlnaF9lbmRfcHJvY2VzcywgdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcywgdnJfZGVidWdfbW9kZSwgc2F2ZV9hbm90aGVyX3N0ZW0sIGV4dHJhX291dHB1dF9kaXIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZ3B1X2lkID0gY29uZmlnWydpbmZlcmVuY2UnXVsnZ3B1X2lkJ10gaWYgbm90IGZvcmNlX2NwdSBlbHNlICIwIgogICAgICAgICAgICB1c2VfdHRhID0gY29uZmlnWydpbmZlcmVuY2UnXVsndXNlX3R0YSddCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlY29uZGFyeV9vdXRwdXQgPSBtb2RlbF9saXN0W3N0ZXBdWyJzZWNvbmRhcnlfb3V0cHV0Il0KICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgc2Vjb25kYXJ5X291dHB1dCA9ICJGYWxzZSIKICAgICAgICAgICAgaWYgc2Vjb25kYXJ5X291dHB1dCA9PSAiVHJ1ZSI6CiAgICAgICAgICAgICAgICBleHRyYWN0X2luc3RydW1lbnRhbCA9IFRydWUKICAgICAgICAgICAgICAgIGV4dHJhX3N0b3JlX2RpciA9IG9zLnBhdGguam9pbihzdG9yZV9kaXIsICJzZWNvbmRhcnlfb3V0cHV0IikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGV4dHJhY3RfaW5zdHJ1bWVudGFsID0gRmFsc2UKICAgICAgICAgICAgICAgIGV4dHJhX3N0b3JlX2RpciA9IE5vbmUKICAgICAgICAgICAgcnVuX2luZmVyZW5jZShtb2RlbF9uYW1lLCBpbnB1dF90b191c2UsIHRtcF9zdG9yZV9kaXIsIGV4dHJhY3RfaW5zdHJ1bWVudGFsLCBncHVfaWQsIG91dHB1dF9mb3JtYXRfZmxvdywgZm9yY2VfY3B1LCB1c2VfdHRhLCBleHRyYV9zdG9yZV9kaXIpCiAgICAgICAgaSArPSAxCiAgICBzaHV0aWwucm10cmVlKFRFTVBfUEFUSCkKICAgIGZpbmlzaF90aW1lID0gdGltZS50aW1lKCkKICAgIGVsYXBzZWRfdGltZSA9IGZpbmlzaF90aW1lIC0gc3RhcnRfdGltZQogICAgQ29uc29sZSgpLnJ1bGUoZiJbeWVsbG93XUZpbmlzaGVkIHJ1bmluZyB7cHJlc2V0X25hbWV9ISBDb3N0cyB7ZWxhcHNlZF90aW1lOi4yZn1zIiwgc3R5bGU9InllbGxvdyIpCiAgICByZXR1cm4gaTE4bigi5aSE55CG5a6M5oiQISDliIbnprvlrozmiJDnmoTpn7PpopHmlofku7blt7Lkv53lrZjlnKgiKSArIHN0b3JlX2RpcgoKZGVmIHByZXNldF9iYWNrdXBfbGlzdCgpOgogICAgYmFja3VwX2RpciA9IEJBQ0tVUAogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGJhY2t1cF9kaXIpOgogICAgICAgIHJldHVybiBbaTE4bigi5pqC5peg5aSH5Lu95paH5Lu2IildCiAgICBiYWNrdXBfZmlsZXMgPSBbXQogICAgZm9yIGZpbGUgaW4gb3MubGlzdGRpcihiYWNrdXBfZGlyKToKICAgICAgICBpZiBmaWxlLnN0YXJ0c3dpdGgoInByZXNldF9iYWNrdXBfIikgYW5kIGZpbGUuZW5kc3dpdGgoIi5qc29uIik6CiAgICAgICAgICAgIGJhY2t1cF9maWxlcy5hcHBlbmQoZmlsZSkKICAgIGlmIGJhY2t1cF9maWxlcyA9PSBbXToKICAgICAgICByZXR1cm4gW2kxOG4oIuaaguaXoOWkh+S7veaWh+S7tiIpXQogICAgcmV0dXJuIGJhY2t1cF9maWxlcwoKZGVmIHJlc3RvcmVfcHJlc2V0X2Z1bmMoYmFja3VwX2ZpbGUpOgogICAgYmFja3VwX2RpciA9IEJBQ0tVUAogICAgaWYgbm90IGJhY2t1cF9maWxlIG9yIGJhY2t1cF9maWxlID09IGkxOG4oIuaaguaXoOWkh+S7veaWh+S7tiIpOgogICAgICAgIHJldHVybiBpMThuKCLor7fpgInmi6nlpIfku73mlofku7YiKQogICAgYmFja3VwX2RhdGEgPSBsb2FkX2NvbmZpZ3Mob3MucGF0aC5qb2luKGJhY2t1cF9kaXIsIGJhY2t1cF9maWxlKSkKICAgIHNhdmVfY29uZmlncyhiYWNrdXBfZGF0YSwgUFJFU0VUUykKICAgIG91dHB1dF9tZXNzYWdlX21hbmFnZSA9IGkxOG4oIuW3suaIkOWKn+aBouWkjeWkh+S7vSIpICsgYmFja3VwX2ZpbGUKICAgIHByZXNldF9kcm9wZG93biA9IGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIuivt+mAieaLqemihOiuviIpLCBjaG9pY2VzPWxpc3QoYmFja3VwX2RhdGEua2V5cygpKSkKICAgIHByZXNldF9uYW1lX2RlbGV0ID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6K+36YCJ5oup6aKE6K6+IiksIGNob2ljZXM9bGlzdChiYWNrdXBfZGF0YS5rZXlzKCkpKQogICAgcHJlc2V0X2Zsb3dfZGVsZXRlID0gcGQuRGF0YUZyYW1lKHsibW9kZWxfdHlwZSI6IFtpMThuKCLor7flhYjpgInmi6npooTorr4iKV0sICJtb2RlbF9uYW1lIjogW2kxOG4oIuivt+WFiOmAieaLqemihOiuviIpXSwgInN0ZW0iOiBbaTE4bigi6K+35YWI6YCJ5oup6aKE6K6+IildLCAic2Vjb25kYXJ5X291dHB1dCI6IFtpMThuKCLor7flhYjpgInmi6npooTorr4iKV19KQogICAgcmV0dXJuIG91dHB1dF9tZXNzYWdlX21hbmFnZSwgcHJlc2V0X2Ryb3Bkb3duLCBwcmVzZXRfbmFtZV9kZWxldCwgcHJlc2V0X2Zsb3dfZGVsZXRlCgpkZWYgYmFja3VwX3ByZXNldF9mdW5jKCk6CiAgICBiYWNrdXBfZGlyID0gQkFDS1VQCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoYmFja3VwX2Rpcik6CiAgICAgICAgb3MubWFrZWRpcnMoYmFja3VwX2RpcikKICAgIGJhY2t1cF9maWxlID0gZiJwcmVzZXRfYmFja3VwX3tkYXRldGltZS5ub3coKS5zdHJmdGltZSgnJVktJW0tJWRfJUgtJU0tJVMnKX0uanNvbiIKICAgIHByZXNldF9kYXRhID0gbG9hZF9jb25maWdzKFBSRVNFVFMpCiAgICBzYXZlX2NvbmZpZ3MocHJlc2V0X2RhdGEsIG9zLnBhdGguam9pbihiYWNrdXBfZGlyLCBiYWNrdXBfZmlsZSkpCiAgICBtc2cgPSBpMThuKCLlt7LmiJDlip/lpIfku73oh7MiKSArIGJhY2t1cF9maWxlCiAgICBzZWxlY3RfcHJlc2V0X2JhY2t1cCA9IGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIumAieaLqemcgOimgeaBouWkjeeahOmihOiuvua1geeoi+Wkh+S7vSIpLCBjaG9pY2VzPXByZXNldF9iYWNrdXBfbGlzdCgpLCBpbnRlcmFjdGl2ZT1UcnVlLCBzY2FsZT00KQogICAgcmV0dXJuIG1zZywgc2VsZWN0X3ByZXNldF9iYWNrdXAKCmRlZiBjb252ZXJ0X2F1ZGlvKHVwbG9hZGVkX2ZpbGVzLCBmZm1wZWdfb3V0cHV0X2Zvcm1hdCwgZmZtcGVnX291dHB1dF9mb2xkZXIpOgogICAgaWYgbm90IHVwbG9hZGVkX2ZpbGVzOgogICAgICAgIHJldHVybiBpMThuKCLor7fkuIrkvKDoh7PlsJHkuIDkuKrmlofku7YiKQogICAgc3VjY2Vzc19maWxlcyA9IFtdCiAgICBmb3IgdXBsb2FkZWRfZmlsZSBpbiB1cGxvYWRlZF9maWxlczoKICAgICAgICB1cGxvYWRlZF9maWxlX3BhdGggPSB1cGxvYWRlZF9maWxlLm5hbWUKICAgICAgICBvdXRwdXRfcGF0aCA9IGZmbXBlZ19vdXRwdXRfZm9sZGVyCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKG91dHB1dF9wYXRoKToKICAgICAgICAgICAgb3MubWFrZWRpcnMob3V0cHV0X3BhdGgpCiAgICAgICAgY29uZmlnID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJRykKICAgICAgICBjb25maWdbJ3Rvb2xzJ11bJ2ZmbXBlZ19vdXRwdXRfZm9ybWF0J10gPSBmZm1wZWdfb3V0cHV0X2Zvcm1hdAogICAgICAgIGNvbmZpZ1sndG9vbHMnXVsnZmZtcGVnX291dHB1dF9mb2xkZXInXSA9IGZmbXBlZ19vdXRwdXRfZm9sZGVyCiAgICAgICAgc2F2ZV9jb25maWdzKGNvbmZpZywgV0VCVUlfQ09ORklHKQogICAgICAgIG91dHB1dF9maWxlID0gb3MucGF0aC5qb2luKG91dHB1dF9wYXRoLCBvcy5wYXRoLnNwbGl0ZXh0KAogICAgICAgICAgICBvcy5wYXRoLmJhc2VuYW1lKHVwbG9hZGVkX2ZpbGVfcGF0aCkpWzBdICsgIi4iICsgZmZtcGVnX291dHB1dF9mb3JtYXQpCiAgICAgICAgY29tbWFuZCA9IGYie0ZGTVBFR30gLWkgXCJ7dXBsb2FkZWRfZmlsZV9wYXRofVwiIFwie291dHB1dF9maWxlfVwiIgogICAgICAgIHByaW50X2NvbW1hbmQoY29tbWFuZCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIHNoZWxsPVRydWUsIGNoZWNrPVRydWUpCiAgICAgICAgICAgIHN1Y2Nlc3NfZmlsZXMuYXBwZW5kKG91dHB1dF9maWxlKQogICAgICAgIGV4Y2VwdCBzdWJwcm9jZXNzLkNhbGxlZFByb2Nlc3NFcnJvcjoKICAgICAgICAgICAgcHJpbnQoZiJGYWlsIHRvIGNvbnZlcnQgZmlsZToge3VwbG9hZGVkX2ZpbGVfcGF0aH1cbiIpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICBpZiBub3Qgc3VjY2Vzc19maWxlczoKICAgICAgICByZXR1cm4gaTE4bigi5omA5pyJ5paH5Lu26L2s5o2i5aSx6LSlLCDor7fmo4Dmn6Xmlofku7bmoLzlvI/lkoxmZm1wZWfot6/lvoTjgIIiKQogICAgZWxzZToKICAgICAgICB0ZXh0ID0gaTE4bigi5aSE55CG5a6M5oiQLCDmlofku7blt7Lkv53lrZjkuLo6ICIpICsgIlxuIiArICJcbiIuam9pbihzdWNjZXNzX2ZpbGVzKQogICAgICAgIHJldHVybiB0ZXh0CgpkZWYgbWVyZ2VfYXVkaW9zKGlucHV0X2ZvbGRlciwgb3V0cHV0X2ZvbGRlcik6CiAgICBjb25maWcgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKQogICAgY29uZmlnWyd0b29scyddWydtZXJnZV9hdWRpb19pbnB1dCddID0gaW5wdXRfZm9sZGVyCiAgICBjb25maWdbJ3Rvb2xzJ11bJ21lcmdlX2F1ZGlvX291dHB1dCddID0gb3V0cHV0X2ZvbGRlcgogICAgc2F2ZV9jb25maWdzKGNvbmZpZywgV0VCVUlfQ09ORklHKQogICAgY29tYmluZWRfYXVkaW8gPSBBdWRpb1NlZ21lbnQuZW1wdHkoKQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKG91dHB1dF9mb2xkZXIpOgogICAgICAgIG9zLm1ha2VkaXJzKG91dHB1dF9mb2xkZXIpCiAgICBvdXRwdXRfZmlsZSA9IG9zLnBhdGguam9pbihvdXRwdXRfZm9sZGVyLCAibWVyZ2VkX2F1ZGlvLndhdiIpCiAgICBmb3IgZmlsZW5hbWUgaW4gc29ydGVkKG9zLmxpc3RkaXIoaW5wdXRfZm9sZGVyKSk6CiAgICAgICAgaWYgZmlsZW5hbWUuZW5kc3dpdGgoKCcubXAzJywgJy53YXYnLCAnLm9nZycsICcuZmxhYycpKToKICAgICAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKGlucHV0X2ZvbGRlciwgZmlsZW5hbWUpCiAgICAgICAgICAgIGF1ZGlvID0gQXVkaW9TZWdtZW50LmZyb21fZmlsZShmaWxlX3BhdGgpCiAgICAgICAgICAgIGNvbWJpbmVkX2F1ZGlvICs9IGF1ZGlvCiAgICB0cnk6CiAgICAgICAgY29tYmluZWRfYXVkaW8uZXhwb3J0KG91dHB1dF9maWxlLCBmb3JtYXQ9IndhdiIpCiAgICAgICAgcmV0dXJuIGkxOG4oIuWkhOeQhuWujOaIkCwg5paH5Lu25bey5L+d5a2Y5Li6OiAiKSArIG91dHB1dF9maWxlCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZSkKICAgICAgICByZXR1cm4gaTE4bigi5aSE55CG5aSx6LSlISIpCgpkZWYgcmVhZF9hbmRfcmVzYW1wbGVfYXVkaW8oZmlsZV9wYXRoLCB0YXJnZXRfc3I9NDQxMDApOgogICAgYXVkaW8sIF8gPSBsaWJyb3NhLmxvYWQoZmlsZV9wYXRoLCBzcj10YXJnZXRfc3IsIG1vbm89RmFsc2UpCiAgICBpZiBhdWRpby5uZGltID09IDE6CiAgICAgICAgYXVkaW8gPSBucC52c3RhY2soKGF1ZGlvLCBhdWRpbykpCiAgICBlbGlmIGF1ZGlvLm5kaW0gPT0gMiBhbmQgYXVkaW8uc2hhcGVbMF0gPT0gMToKICAgICAgICBhdWRpbyA9IG5wLnZzdGFjaygoYXVkaW9bMF0sIGF1ZGlvWzBdKSkKICAgIHJldHVybiBhdWRpbwoKZGVmIG1hdGNoX2xlbmd0aChyZWZfYXVkaW8sIGVzdF9hdWRpbyk6CiAgICBtaW5fbGVuZ3RoID0gbWluKHJlZl9hdWRpby5zaGFwZVsxXSwgZXN0X2F1ZGlvLnNoYXBlWzFdKQogICAgcmVmX2F1ZGlvID0gcmVmX2F1ZGlvWzosIDptaW5fbGVuZ3RoXQogICAgZXN0X2F1ZGlvID0gZXN0X2F1ZGlvWzosIDptaW5fbGVuZ3RoXQogICAgcmV0dXJuIHJlZl9hdWRpbywgZXN0X2F1ZGlvCgpkZWYgY29tcHV0ZV9zZHIocmVmZXJlbmNlLCBlc3RpbWF0ZWQpOgogICAgc2RyLCBfLCBfLCBfID0gYnNzX2V2YWxfc291cmNlcyhyZWZlcmVuY2UsIGVzdGltYXRlZCkKICAgIHJldHVybiBzZHIKCmRlZiBwcm9jZXNzX2F1ZGlvKHRydWVfcGF0aCwgZXN0aW1hdGVkX3BhdGgpOgogICAgdGFyZ2V0X3NyID0gNDQxMDAKICAgIHRydWVfYXVkaW8gPSByZWFkX2FuZF9yZXNhbXBsZV9hdWRpbygKICAgICAgICB0cnVlX3BhdGgsIHRhcmdldF9zcikKICAgIGVzdGltYXRlZF9hdWRpbyA9IHJlYWRfYW5kX3Jlc2FtcGxlX2F1ZGlvKAogICAgICAgIGVzdGltYXRlZF9wYXRoLCB0YXJnZXRfc3IpCiAgICB0cnVlX2F1ZGlvLCBlc3RpbWF0ZWRfYXVkaW8gPSBtYXRjaF9sZW5ndGgodHJ1ZV9hdWRpbywgZXN0aW1hdGVkX2F1ZGlvKQogICAgc2RyID0gY29tcHV0ZV9zZHIodHJ1ZV9hdWRpbywgZXN0aW1hdGVkX2F1ZGlvKQogICAgcHJpbnQoZiJTRFI6IHtzZHJ9IikKICAgIHJldHVybiBzZHIKCmRlZiBlbnNlbWJsZShmaWxlcywgZW5zZW1ibGVfbW9kZSwgd2VpZ2h0cywgb3V0cHV0X3BhdGgpOgogICAgaWYgbGVuKGZpbGVzKSA8IDI6CiAgICAgICAgcmV0dXJuIGkxOG4oIuivt+S4iuS8oOiHs+WwkTLkuKrmlofku7YiKQogICAgaWYgbGVuKGZpbGVzKSAhPSBsZW4od2VpZ2h0cy5zcGxpdCgpKToKICAgICAgICByZXR1cm4gaTE4bigi5LiK5Lyg55qE5paH5Lu25pWw55uu5LiO5p2D6YeN5pWw55uu5LiN5Yy56YWNIikKICAgIGVsc2U6CiAgICAgICAgY29uZmlnID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJRykKICAgICAgICBjb25maWdbJ3Rvb2xzJ11bJ2Vuc2VtYmxlX3R5cGUnXSA9IGVuc2VtYmxlX21vZGUKICAgICAgICBjb25maWdbJ3Rvb2xzJ11bJ2Vuc2VtYmxlX291dHB1dF9mb2xkZXInXSA9IG91dHB1dF9wYXRoCiAgICAgICAgc2F2ZV9jb25maWdzKGNvbmZpZywgV0VCVUlfQ09ORklHKQogICAgICAgIGZpbGVzX2FyZ3VtZW50ID0gIiAiLmpvaW4oZmlsZXMpCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKG91dHB1dF9wYXRoKToKICAgICAgICAgICAgb3MubWFrZWRpcnMob3V0cHV0X3BhdGgpCiAgICAgICAgb3V0cHV0X3BhdGggPSBvcy5wYXRoLmpvaW4ob3V0cHV0X3BhdGgsIGYiZW5zZW1ibGVfe2Vuc2VtYmxlX21vZGV9LndhdiIpCiAgICAgICAgY29tbWFuZCA9IGYie1BZVEhPTn0gZW5zZW1ibGUucHkgLS1maWxlcyB7ZmlsZXNfYXJndW1lbnR9IC0tdHlwZSB7ZW5zZW1ibGVfbW9kZX0gLS13ZWlnaHRzIHt3ZWlnaHRzfSAtLW91dHB1dCB7b3V0cHV0X3BhdGh9IgogICAgICAgIHByaW50X2NvbW1hbmQoY29tbWFuZCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIHNoZWxsID0gVHJ1ZSkKICAgICAgICAgICAgcmV0dXJuIGkxOG4oIuWkhOeQhuWujOaIkCwg5paH5Lu25bey5L+d5a2Y5Li6OiAiKSArIG91dHB1dF9wYXRoCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByZXR1cm4gaTE4bigi5aSE55CG5aSx6LSlISIpCgpkZWYgc29tZV9pbmZlcmVuY2UoYXVkaW9fZmlsZSwgYnBtLCBvdXRwdXRfZGlyKToKICAgIG1vZGVsID0gInRvb2xzL1NPTUVfd2VpZ2h0cy9tb2RlbF9zdGVwc182NDAwMF9zaW1wbGlmaWVkLmNrcHQiCiAgICBpZiBub3Qgb3MucGF0aC5pc2ZpbGUobW9kZWwpOgogICAgICAgIHJldHVybiBpMThuKCLor7flhYjkuIvovb1TT01F6aKE5aSE55CG5qih5Z6L5bm25pS+572u5ZyodG9vbHMvU09NRV93ZWlnaHRz5paH5Lu25aS55LiLISAiKQogICAgaWYgbm90IGF1ZGlvX2ZpbGUuZW5kc3dpdGgoJy53YXYnKToKICAgICAgICByZXR1cm4gaTE4bigi6K+35LiK5Lygd2F25qC85byP5paH5Lu2IikKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhvdXRwdXRfZGlyKToKICAgICAgICBvcy5tYWtlZGlycyhvdXRwdXRfZGlyKQogICAgY29uZmlnID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJRykKICAgIGNvbmZpZ1sndG9vbHMnXVsnc29tZV9vdXRwdXRfZm9sZGVyJ10gPSBvdXRwdXRfZGlyCiAgICBzYXZlX2NvbmZpZ3MoY29uZmlnLCBXRUJVSV9DT05GSUcpCiAgICB0ZW1wbyA9IGludChicG0pCiAgICBmaWxlX25hbWUgPSBvcy5wYXRoLmJhc2VuYW1lKGF1ZGlvX2ZpbGUpWzA6LTRdCiAgICBtaWRpID0gb3MucGF0aC5qb2luKG91dHB1dF9kaXIsIGYie2ZpbGVfbmFtZX0ubWlkIikKICAgIGNvbW1hbmQgPSBmIntQWVRIT059IHRvb2xzL1NPTUUvaW5mZXIucHkgLS1tb2RlbCB7bW9kZWx9IC0td2F2IFwie2F1ZGlvX2ZpbGV9XCIgLS1taWRpIFwie21pZGl9XCIgLS10ZW1wbyB7dGVtcG99IgogICAgcHJpbnRfY29tbWFuZChjb21tYW5kKQogICAgdHJ5OgogICAgICAgIHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIHNoZWxsPVRydWUpCiAgICAgICAgcmV0dXJuIGkxOG4oIuWkhOeQhuWujOaIkCwg5paH5Lu25bey5L+d5a2Y5Li6OiAiKSArIG1pZGkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICByZXR1cm4gaTE4bigi5aSE55CG5aSx6LSlISIpCgpkZWYgdXBncmFkZV9kb3dubG9hZF9tb2RlbF9uYW1lKG1vZGVsX3R5cGVfZHJvcGRvd24pOgogICAgaWYgbW9kZWxfdHlwZV9kcm9wZG93biA9PSAiVVZSX1ZSX01vZGVscyI6CiAgICAgICAgbW9kZWxfbWFwID0gbG9hZF9jb25maWdzKFZSX01PREVMKQogICAgICAgIHJldHVybiBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6nmqKHlnosiKSwgY2hvaWNlcz1ba2V5cyBmb3Iga2V5cyBpbiBtb2RlbF9tYXAua2V5cygpXSkKICAgIGVsc2U6CiAgICAgICAgbW9kZWxfbWFwID0gbG9hZF9jb25maWdzKE1TU1RfTU9ERUwpCiAgICAgICAgcmV0dXJuIGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIumAieaLqeaooeWeiyIpLCBjaG9pY2VzPVttb2RlbFsibmFtZSJdIGZvciBtb2RlbCBpbiBtb2RlbF9tYXBbbW9kZWxfdHlwZV9kcm9wZG93bl1dKQoKZGVmIGRvd25sb2FkX21vZGVsKG1vZGVsX3R5cGUsIG1vZGVsX25hbWUpOgogICAgaWYgbW9kZWxfdHlwZSBub3QgaW4gTU9ERUxfQ0hPSUNFUzoKICAgICAgICByZXR1cm4gaTE4bigi6K+36YCJ5oup5qih5Z6L57G75Z6LIikKICAgIGlmIG1vZGVsX3R5cGUgPT0gIlVWUl9WUl9Nb2RlbHMiOgogICAgICAgIGRvd25sb2FkZWRfbW9kZWwgPSBsb2FkX3ZyX21vZGVsKCkKICAgICAgICBpZiBtb2RlbF9uYW1lIGluIGRvd25sb2FkZWRfbW9kZWw6CiAgICAgICAgICAgIHJldHVybiBpMThuKCLmqKHlnosiKSArIG1vZGVsX25hbWUgKyBpMThuKCLlt7Llronoo4UiKQogICAgICAgIF8sIF8sIG1vZGVsX3VybCwgbW9kZWxfcGF0aCA9IGdldF92cl9tb2RlbChtb2RlbF9uYW1lKQogICAgICAgIG9zLm1ha2VkaXJzKG1vZGVsX3BhdGgsIGV4aXN0X29rPVRydWUpCiAgICAgICAgcmV0dXJuIGRvd25sb2FkX2ZpbGUobW9kZWxfdXJsLCBvcy5wYXRoLmpvaW4obW9kZWxfcGF0aCwgbW9kZWxfbmFtZSksIG1vZGVsX25hbWUpCiAgICBlbHNlOgogICAgICAgIHByZXNldHMgPSBsb2FkX2NvbmZpZ3MoTVNTVF9NT0RFTCkKICAgICAgICBtb2RlbF9tYXBwaW5nID0gbG9hZF9tc3N0X21vZGVsKCkKICAgICAgICBpZiBtb2RlbF9uYW1lIGluIG1vZGVsX21hcHBpbmc6CiAgICAgICAgICAgIHJldHVybiBpMThuKCLmqKHlnosiKSArIG1vZGVsX25hbWUgKyBpMThuKCLlt7Llronoo4UiKQogICAgICAgIGlmIG1vZGVsX3R5cGUgbm90IGluIHByZXNldHM6CiAgICAgICAgICAgIHJldHVybiBpMThuKCLmqKHlnovnsbvlnosiKSArIG1vZGVsX3R5cGUgKyBpMThuKCLkuI3lrZjlnKgiKQogICAgICAgIF8sIF8sIF8sIG1vZGVsX3VybCA9IGdldF9tc3N0X21vZGVsKG1vZGVsX25hbWUpCiAgICAgICAgbW9kZWxfcGF0aCA9IGYicHJldHJhaW4ve21vZGVsX3R5cGV9L3ttb2RlbF9uYW1lfSIKICAgICAgICBvcy5tYWtlZGlycyhvcy5wYXRoLmRpcm5hbWUobW9kZWxfcGF0aCksIGV4aXN0X29rPVRydWUpCiAgICAgICAgcmV0dXJuIGRvd25sb2FkX2ZpbGUobW9kZWxfdXJsLCBtb2RlbF9wYXRoLCBtb2RlbF9uYW1lKQoKZGVmIGRvd25sb2FkX2ZpbGUodXJsLCBwYXRoLCBtb2RlbF9uYW1lKToKICAgIHRyeToKICAgICAgICBwcmludChpMThuKCLmqKHlnosiKSArIG1vZGVsX25hbWUgKyBpMThuKCLkuIvovb3kuK0iKSkKICAgICAgICB3aXRoIHJlcXVlc3RzLmdldCh1cmwsIHN0cmVhbT1UcnVlKSBhcyByOgogICAgICAgICAgICByLnJhaXNlX2Zvcl9zdGF0dXMoKQogICAgICAgICAgICB0b3RhbF9zaXplID0gaW50KHIuaGVhZGVycy5nZXQoJ2NvbnRlbnQtbGVuZ3RoJywgMCkpCiAgICAgICAgICAgIHdpdGggb3BlbihwYXRoLCAnd2InKSBhcyBmLCB0cWRtKAogICAgICAgICAgICAgICAgdG90YWw9dG90YWxfc2l6ZSwgdW5pdD0nQicsIHVuaXRfc2NhbGU9VHJ1ZQogICAgICAgICAgICApIGFzIHByb2dyZXNzX2JhcjoKICAgICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgICAgICAgICAgYnl0ZXNfd3JpdHRlbiA9IDAKICAgICAgICAgICAgICAgIGZvciBkYXRhIGluIHIuaXRlcl9jb250ZW50KDEwMjQpOgogICAgICAgICAgICAgICAgICAgIGYud3JpdGUoZGF0YSkKICAgICAgICAgICAgICAgICAgICBieXRlc193cml0dGVuICs9IGxlbihkYXRhKQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfdGltZSA9IHRpbWUudGltZSgpCiAgICAgICAgICAgICAgICAgICAgaWYgY3VycmVudF90aW1lIC0gbGFzdF91cGRhdGVfdGltZSA+PSAxOgogICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc19iYXIudXBkYXRlKGJ5dGVzX3dyaXR0ZW4pCiAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGVzX3dyaXR0ZW4gPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWUgPSBjdXJyZW50X3RpbWUKICAgICAgICAgICAgICAgIHByb2dyZXNzX2Jhci51cGRhdGUoYnl0ZXNfd3JpdHRlbikKICAgICAgICByZXR1cm4gaTE4bigi5qih5Z6LIikgKyBtb2RlbF9uYW1lICsgaTE4bigi5LiL6L295oiQ5YqfIikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChlKQogICAgICAgIHJldHVybiBpMThuKCLmqKHlnosiKSArIG1vZGVsX25hbWUgKyBpMThuKCLkuIvovb3lpLHotKUiKQoKZGVmIG1hbnVhbF9kb3dubG9hZF9tb2RlbChtb2RlbF90eXBlLCBtb2RlbF9uYW1lKToKICAgIGlmIG1vZGVsX3R5cGUgbm90IGluIE1PREVMX0NIT0lDRVM6CiAgICAgICAgcmV0dXJuIGkxOG4oIuivt+mAieaLqeaooeWei+exu+WeiyIpCiAgICBpZiBtb2RlbF90eXBlID09ICJVVlJfVlJfTW9kZWxzIjoKICAgICAgICBkb3dubG9hZGVkX21vZGVsID0gbG9hZF92cl9tb2RlbCgpCiAgICAgICAgaWYgbW9kZWxfbmFtZSBpbiBkb3dubG9hZGVkX21vZGVsOgogICAgICAgICAgICByZXR1cm4gaTE4bigi5qih5Z6LIikgKyBtb2RlbF9uYW1lICsgaTE4bigi5bey5a6J6KOFIikKICAgICAgICBfLCBfLCBtb2RlbF91cmwsIF8gPSBnZXRfdnJfbW9kZWwobW9kZWxfbmFtZSkKICAgIGVsc2U6CiAgICAgICAgcHJlc2V0cyA9IGxvYWRfY29uZmlncyhNU1NUX01PREVMKQogICAgICAgIG1vZGVsX21hcHBpbmcgPSBsb2FkX21zc3RfbW9kZWwoKQogICAgICAgIGlmIG1vZGVsX25hbWUgaW4gbW9kZWxfbWFwcGluZzoKICAgICAgICAgICAgcmV0dXJuIGkxOG4oIuaooeWeiyIpICsgbW9kZWxfbmFtZSArIGkxOG4oIuW3suWuieijhSIpCiAgICAgICAgaWYgbW9kZWxfdHlwZSBub3QgaW4gcHJlc2V0czoKICAgICAgICAgICAgcmV0dXJuIGkxOG4oIuaooeWei+exu+WeiyIpICsgbW9kZWxfdHlwZSArIGkxOG4oIuS4jeWtmOWcqCIpCiAgICAgICAgXywgXywgXywgbW9kZWxfdXJsID0gZ2V0X21zc3RfbW9kZWwobW9kZWxfbmFtZSkKICAgIHdlYmJyb3dzZXIub3Blbihtb2RlbF91cmwpCiAgICByZXR1cm4gaTE4bigi5bey5omT5byAIikgKyBtb2RlbF9uYW1lICsgaTE4bigi55qE5LiL6L296ZO+5o6lIikKCmRlZiB1cGRhdGVfdnJfcGFyYW0oaXNfQlZfbW9kZWwsIGlzX1ZSNTFfbW9kZWwsIG1vZGVsX3BhcmFtKToKICAgIGJhbGFuY2VfdmFsdWUgPSBnci5OdW1iZXIobGFiZWw9ImJhbGFuY2VfdmFsdWUiLCB2YWx1ZT0wLjAsIG1pbmltdW09MC4wLCBtYXhpbXVtPTAuOSwgc3RlcD0wLjEsIGludGVyYWN0aXZlPVRydWUsIHZpc2libGU9VHJ1ZSBpZiBpc19CVl9tb2RlbCBlbHNlIEZhbHNlKQogICAgb3V0X2NoYW5uZWxzID0gZ3IuTnVtYmVyKGxhYmVsPSJPdXQgQ2hhbm5lbHMiLCB2YWx1ZT0zMiwgbWluaW11bT0xLCBzdGVwPTEsIGludGVyYWN0aXZlPVRydWUsIHZpc2libGU9VHJ1ZSBpZiBpc19WUjUxX21vZGVsIGVsc2UgRmFsc2UpCiAgICBvdXRfY2hhbm5lbHNfbHN0bSA9IGdyLk51bWJlcihsYWJlbD0iT3V0IENoYW5uZWxzIChMU1RNIGxheWVyKSIsIHZhbHVlPTEyOCwgbWluaW11bT0xLCBzdGVwPTEsIGludGVyYWN0aXZlPVRydWUsIHZpc2libGU9VHJ1ZSBpZiBpc19WUjUxX21vZGVsIGVsc2UgRmFsc2UpCiAgICB1cGxvYWRfcGFyYW0gPSBnci5GaWxlKGxhYmVsPWkxOG4oIuS4iuS8oOWPguaVsOaWh+S7tiIpLCB0eXBlPSJmaWxlcGF0aCIsIGludGVyYWN0aXZlPVRydWUsIHZpc2libGU9VHJ1ZSBpZiBtb2RlbF9wYXJhbSA9PSBpMThuKCLkuIrkvKDlj4LmlbAiKSBlbHNlIEZhbHNlKQogICAgcmV0dXJuIGJhbGFuY2VfdmFsdWUsIG91dF9jaGFubmVscywgb3V0X2NoYW5uZWxzX2xzdG0sIHVwbG9hZF9wYXJhbQoKZGVmIGluc3RhbGxfdW5tc3N0X21vZGVsKHVubXNzdF9tb2RlbCwgdW5tc3N0X2NvbmZpZywgdW5tb2RlbF9jbGFzcywgdW5tb2RlbF90eXBlLCB1bm1zc3RfbW9kZWxfbGluayk6CiAgICBvcy5tYWtlZGlycyhvcy5wYXRoLmpvaW4oVU5PRkZJQ0lBTF9NT0RFTCwgIm1zc3RfY29uZmlnIiksIGV4aXN0X29rPVRydWUpCiAgICB0cnk6CiAgICAgICAgbW9kZWxfbWFwID0gbG9hZF9jb25maWdzKG9zLnBhdGguam9pbihVTk9GRklDSUFMX01PREVMLCAidW5vZmZpY2lhbF9tc3N0X21vZGVsLmpzb24iKSkKICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoKICAgICAgICBtb2RlbF9tYXAgPSB7Im11bHRpX3N0ZW1fbW9kZWxzIjogW10sICJzaW5nbGVfc3RlbV9tb2RlbHMiOiBbXSwgInZvY2FsX21vZGVscyI6IFtdfQogICAgdHJ5OgogICAgICAgIG1vZGVsX25hbWUgPSBvcy5wYXRoLmJhc2VuYW1lKHVubXNzdF9tb2RlbCkKICAgICAgICBpZiBtb2RlbF9uYW1lIGluIGxvYWRfbXNzdF9tb2RlbCgpOgogICAgICAgICAgICByZXR1cm4gaTE4bigi5qih5Z6LIikgKyBtb2RlbF9uYW1lICsgaTE4bigi5bey5a6J6KOFIikKICAgICAgICBpZiB1bm1zc3RfbW9kZWwuZW5kc3dpdGgoKCIuY2twdCIsICIuY2hwdCIsICIudGgiKSk6CiAgICAgICAgICAgIHNodXRpbC5jb3B5KHVubXNzdF9tb2RlbCwgb3MucGF0aC5qb2luKE1PREVMX0ZPTERFUiwgdW5tb2RlbF9jbGFzcykpCiAgICAgICAgZWxzZTogcmV0dXJuIGkxOG4oIuivt+S4iuS8oCdja3B0JywgJ2NocHQnLCAndGgn5qC85byP55qE5qih5Z6L5paH5Lu2IikKICAgICAgICBpZiB1bm1zc3RfY29uZmlnLmVuZHN3aXRoKCIueWFtbCIpOgogICAgICAgICAgICBzaHV0aWwuY29weSh1bm1zc3RfY29uZmlnLCBvcy5wYXRoLmpvaW4oVU5PRkZJQ0lBTF9NT0RFTCwgIm1zc3RfY29uZmlnIikpCiAgICAgICAgZWxzZTogcmV0dXJuIGkxOG4oIuivt+S4iuS8oCcueWFtbCfmoLzlvI/nmoTphY3nva7mlofku7YiKQogICAgICAgIGNvbmZpZyA9IHsKICAgICAgICAgICAgIm5hbWUiOiBtb2RlbF9uYW1lLAogICAgICAgICAgICAiY29uZmlnX3BhdGgiOiBvcy5wYXRoLmpvaW4oVU5PRkZJQ0lBTF9NT0RFTCwgIm1zc3RfY29uZmlnIiwgb3MucGF0aC5iYXNlbmFtZSh1bm1zc3RfY29uZmlnKSksCiAgICAgICAgICAgICJtb2RlbF90eXBlIjogdW5tb2RlbF90eXBlLAogICAgICAgICAgICAibGluayI6IHVubXNzdF9tb2RlbF9saW5rCiAgICAgICAgfQogICAgICAgIG1vZGVsX21hcFt1bm1vZGVsX2NsYXNzXS5hcHBlbmQoY29uZmlnKQogICAgICAgIHNhdmVfY29uZmlncyhtb2RlbF9tYXAsIG9zLnBhdGguam9pbihVTk9GRklDSUFMX01PREVMLCAidW5vZmZpY2lhbF9tc3N0X21vZGVsLmpzb24iKSkKICAgICAgICByZXR1cm4gaTE4bigi5qih5Z6LIikgKyBvcy5wYXRoLmJhc2VuYW1lKHVubXNzdF9tb2RlbCkgKyBpMThuKCLlronoo4XmiJDlip/jgILph43lkK9XZWJVSeS7peWIt+aWsOaooeWei+WIl+ihqCIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZSkKICAgICAgICByZXR1cm4gaTE4bigi5qih5Z6LIikgKyBvcy5wYXRoLmJhc2VuYW1lKHVubXNzdF9tb2RlbCkgKyBpMThuKCLlronoo4XlpLHotKUiKQoKZGVmIGluc3RhbGxfdW52cl9tb2RlbCh1bnZyX21vZGVsLCB1bnZyX3ByaW1hcnlfc3RlbSwgdW52cl9zZWNvbmRhcnlfc3RlbSwgbW9kZWxfcGFyYW0sIGlzX2thcmFva2VfbW9kZWwsIGlzX0JWX21vZGVsLCBpc19WUjUxX21vZGVsLCBiYWxhbmNlX3ZhbHVlLCBvdXRfY2hhbm5lbHMsIG91dF9jaGFubmVsc19sc3RtLCB1cGxvYWRfcGFyYW0sIHVudnJfbW9kZWxfbGluayk6CiAgICBvcy5tYWtlZGlycyhVTk9GRklDSUFMX01PREVMLCBleGlzdF9vaz1UcnVlKQogICAgdHJ5OgogICAgICAgIG1vZGVsX21hcCA9IGxvYWRfY29uZmlncyhvcy5wYXRoLmpvaW4oVU5PRkZJQ0lBTF9NT0RFTCwgInVub2ZmaWNpYWxfdnJfbW9kZWwuanNvbiIpKQogICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOgogICAgICAgIG1vZGVsX21hcCA9IHt9CiAgICB0cnk6CiAgICAgICAgbW9kZWxfbmFtZSA9IG9zLnBhdGguYmFzZW5hbWUodW52cl9tb2RlbCkKICAgICAgICBpZiBtb2RlbF9uYW1lIGluIGxvYWRfdnJfbW9kZWwoKToKICAgICAgICAgICAgcmV0dXJuIGkxOG4oIuaooeWeiyIpICsgbW9kZWxfbmFtZSArIGkxOG4oIuW3suWuieijhSIpCiAgICAgICAgaWYgdW52cl9tb2RlbC5lbmRzd2l0aCgiLnB0aCIpOgogICAgICAgICAgICBzaHV0aWwuY29weSh1bnZyX21vZGVsLCAicHJldHJhaW4vVlJfTW9kZWxzIikKICAgICAgICBlbHNlOiByZXR1cm4gaTE4bigi6K+35LiK5LygJy5wdGgn5qC85byP55qE5qih5Z6L5paH5Lu2IikKICAgICAgICBpZiB1bnZyX3ByaW1hcnlfc3RlbSAhPSAiIiBhbmQgdW52cl9zZWNvbmRhcnlfc3RlbSAhPSAiIiBhbmQgdW52cl9wcmltYXJ5X3N0ZW0gIT0gdW52cl9zZWNvbmRhcnlfc3RlbToKICAgICAgICAgICAgbW9kZWxfbWFwW21vZGVsX25hbWVdID0ge30KICAgICAgICAgICAgbW9kZWxfbWFwW21vZGVsX25hbWVdWyJtb2RlbF9wYXRoIl0gPSBvcy5wYXRoLmpvaW4oTU9ERUxfRk9MREVSLCAiVlJfTW9kZWxzIiwgbW9kZWxfbmFtZSkKICAgICAgICAgICAgbW9kZWxfbWFwW21vZGVsX25hbWVdWyJwcmltYXJ5X3N0ZW0iXSA9IHVudnJfcHJpbWFyeV9zdGVtCiAgICAgICAgICAgIG1vZGVsX21hcFttb2RlbF9uYW1lXVsic2Vjb25kYXJ5X3N0ZW0iXSA9IHVudnJfc2Vjb25kYXJ5X3N0ZW0KICAgICAgICAgICAgbW9kZWxfbWFwW21vZGVsX25hbWVdWyJkb3dubG9hZF9saW5rIl0gPSB1bnZyX21vZGVsX2xpbmsKICAgICAgICBlbHNlOiByZXR1cm4gaTE4bigi6K+36L6T5YWl5q2j56Gu55qE6Z+z6L2o5ZCN56ewIikKICAgICAgICBpZiBtb2RlbF9wYXJhbSA9PSBpMThuKCLkuIrkvKDlj4LmlbAiKToKICAgICAgICAgICAgaWYgdXBsb2FkX3BhcmFtLmVuZHN3aXRoKCIuanNvbiIpOgogICAgICAgICAgICAgICAgb3MubWFrZWRpcnMob3MucGF0aC5qb2luKFVOT0ZGSUNJQUxfTU9ERUwsICJ2cl9tb2RlbHBhcmFtcyIpLCBleGlzdF9vaz1UcnVlKQogICAgICAgICAgICAgICAgc2h1dGlsLmNvcHkodXBsb2FkX3BhcmFtLCBvcy5wYXRoLmpvaW4oVU5PRkZJQ0lBTF9NT0RFTCwgInZyX21vZGVscGFyYW1zIikpCiAgICAgICAgICAgICAgICBtb2RlbF9tYXBbbW9kZWxfbmFtZV1bInZyX21vZGVsX3BhcmFtIl0gPSBvcy5wYXRoLmJhc2VuYW1lKHVwbG9hZF9wYXJhbSlbOi01XQogICAgICAgICAgICBlbHNlOiByZXR1cm4gaTE4bigi6K+35LiK5LygJy5qc29uJ+agvOW8j+eahOWPguaVsOaWh+S7tiIpCiAgICAgICAgZWxzZTogbW9kZWxfbWFwW21vZGVsX25hbWVdWyJ2cl9tb2RlbF9wYXJhbSJdID0gbW9kZWxfcGFyYW0KICAgICAgICBpZiBpc19rYXJhb2tlX21vZGVsOgogICAgICAgICAgICBtb2RlbF9tYXBbbW9kZWxfbmFtZV1bImlzX2thcmFva2UiXSA9IFRydWUKICAgICAgICBpZiBpc19CVl9tb2RlbDoKICAgICAgICAgICAgbW9kZWxfbWFwW21vZGVsX25hbWVdWyJpc19idl9tb2RlbCJdID0gVHJ1ZQogICAgICAgICAgICBtb2RlbF9tYXBbbW9kZWxfbmFtZV1bImlzX2J2X21vZGVsX3JlYmFsYW5jZWQiXSA9IGJhbGFuY2VfdmFsdWUKICAgICAgICBpZiBpc19WUjUxX21vZGVsOgogICAgICAgICAgICBtb2RlbF9tYXBbbW9kZWxfbmFtZV1bIm5vdXQiXSA9IG91dF9jaGFubmVscwogICAgICAgICAgICBtb2RlbF9tYXBbbW9kZWxfbmFtZV1bIm5vdXRfbHN0bSJdID0gb3V0X2NoYW5uZWxzX2xzdG0KICAgICAgICBzYXZlX2NvbmZpZ3MobW9kZWxfbWFwLCBvcy5wYXRoLmpvaW4oVU5PRkZJQ0lBTF9NT0RFTCwgInVub2ZmaWNpYWxfdnJfbW9kZWwuanNvbiIpKQogICAgICAgIHJldHVybiBpMThuKCLmqKHlnosiKSArIG9zLnBhdGguYmFzZW5hbWUodW52cl9tb2RlbCkgKyBpMThuKCLlronoo4XmiJDlip/jgILph43lkK9XZWJVSeS7peWIt+aWsOaooeWei+WIl+ihqCIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZSkKICAgICAgICByZXR1cm4gaTE4bigi5qih5Z6LIikgKyBvcy5wYXRoLmJhc2VuYW1lKHVudnJfbW9kZWwpICsgaTE4bigi5a6J6KOF5aSx6LSlIikKCmRlZiBnZXRfYWxsX21vZGVsX3BhcmFtKCk6CiAgICBtb2RlbF9wYXJhbSA9IFtpMThuKCLkuIrkvKDlj4LmlbAiKV0KICAgIGZvciBmaWxlIGluIG9zLmxpc3RkaXIoVlJfTU9ERUxQQVJBTVMpOgogICAgICAgIGlmIGZpbGUuZW5kc3dpdGgoIi5qc29uIik6CiAgICAgICAgICAgIG1vZGVsX3BhcmFtLmFwcGVuZChmaWxlWzotNV0pCiAgICByZXR1cm4gbW9kZWxfcGFyYW0KCmRlZiBzdGFydF90cmFpbmluZyh0cmFpbl9tb2RlbF90eXBlLCB0cmFpbl9jb25maWdfcGF0aCwgdHJhaW5fZGF0YXNldF90eXBlLCB0cmFpbl9kYXRhc2V0X3BhdGgsIHRyYWluX3ZhbGlkX3BhdGgsIHRyYWluX251bV93b3JrZXJzLCB0cmFpbl9kZXZpY2VfaWRzLCB0cmFpbl9zZWVkLCB0cmFpbl9waW5fbWVtb3J5LCB0cmFpbl91c2VfbXVsdGlzdGZ0X2xvc3MsIHRyYWluX3VzZV9tc2VfbG9zcywgdHJhaW5fdXNlX2wxX2xvc3MsIHRyYWluX3Jlc3VsdHNfcGF0aCwgdHJhaW5fc3RhcnRfY2hlY2tfcG9pbnQsIHRyYWluX2FjY2VsZXJhdGUsIHRyYWluX3ByZV92YWxpZGF0ZSk6CiAgICBtb2RlbF90eXBlID0gdHJhaW5fbW9kZWxfdHlwZQogICAgY29uZmlnX3BhdGggPSB0cmFpbl9jb25maWdfcGF0aAogICAgc3RhcnRfY2hlY2tfcG9pbnQgPSB0cmFpbl9zdGFydF9jaGVja19wb2ludAogICAgcmVzdWx0c19wYXRoID0gdHJhaW5fcmVzdWx0c19wYXRoCiAgICBkYXRhX3BhdGggPSB0cmFpbl9kYXRhc2V0X3BhdGgKICAgIGRhdGFzZXRfdHlwZSA9IHRyYWluX2RhdGFzZXRfdHlwZQogICAgdmFsaWRfcGF0aCA9IHRyYWluX3ZhbGlkX3BhdGgKICAgIG51bV93b3JrZXJzID0gaW50KHRyYWluX251bV93b3JrZXJzKQogICAgZGV2aWNlX2lkcyA9IHRyYWluX2RldmljZV9pZHMKICAgIHNlZWQgPSBpbnQodHJhaW5fc2VlZCkKICAgIHBpbl9tZW1vcnkgPSAiLS1waW5fbWVtb3J5IiBpZiB0cmFpbl9waW5fbWVtb3J5IGVsc2UgIiIKICAgIHVzZV9tdWx0aXN0ZnRfbG9zcyA9ICItLXVzZV9tdWx0aXN0ZnRfbG9zcyIgaWYgdHJhaW5fdXNlX211bHRpc3RmdF9sb3NzIGVsc2UgIiIKICAgIHVzZV9tc2VfbG9zcyA9ICItLXVzZV9tc2VfbG9zcyIgaWYgdHJhaW5fdXNlX21zZV9sb3NzIGVsc2UgIiIKICAgIHVzZV9sMV9sb3NzID0gIi0tdXNlX2wxX2xvc3MiIGlmIHRyYWluX3VzZV9sMV9sb3NzIGVsc2UgIiIKICAgIHByZV92YWxpZCA9ICItLXByZV92YWxpZCIgaWYgKHRyYWluX2FjY2VsZXJhdGUgYW5kIHRyYWluX3ByZV92YWxpZGF0ZSkgZWxzZSAiIgogICAgaWYgdHJhaW5fYWNjZWxlcmF0ZToKICAgICAgICB0cmFpbl9maWxlID0gInRyYWluX2FjY2VsZXJhdGUucHkiCiAgICBlbHNlOgogICAgICAgIHRyYWluX2ZpbGUgPSAidHJhaW4ucHkiCiAgICBpZiBtb2RlbF90eXBlIG5vdCBpbiBNT0RFTF9UWVBFOgogICAgICAgIHJldHVybiBpMThuKCLmqKHlnovnsbvlnovplJnor68sIOivt+mHjeaWsOmAieaLqSIpCiAgICBpZiBub3Qgb3MucGF0aC5pc2ZpbGUoY29uZmlnX3BhdGgpOgogICAgICAgIHJldHVybiBpMThuKCLphY3nva7mlofku7bkuI3lrZjlnKgsIOivt+mHjeaWsOmAieaLqSIpCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocmVzdWx0c19wYXRoKToKICAgICAgICBvcy5tYWtlZGlycyhyZXN1bHRzX3BhdGgpCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoZGF0YV9wYXRoKToKICAgICAgICByZXR1cm4gaTE4bigi5pWw5o2u6ZuG6Lev5b6E5LiN5a2Y5ZyoLCDor7fph43mlrDpgInmi6kiKQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHZhbGlkX3BhdGgpOgogICAgICAgIHJldHVybiBpMThuKCLpqozor4Hpm4bot6/lvoTkuI3lrZjlnKgsIOivt+mHjeaWsOmAieaLqSIpCiAgICBpZiBkYXRhc2V0X3R5cGUgbm90IGluIFsxLCAyLCAzLCA0XToKICAgICAgICByZXR1cm4gaTE4bigi5pWw5o2u6ZuG57G75Z6L6ZSZ6K+vLCDor7fph43mlrDpgInmi6kiKQogICAgaWYgbm90IGJvb2wocmUubWF0Y2gocideKFxkKykoPzpccyg/IVwxKVxkKykqJCcsIGRldmljZV9pZHMpKToKICAgICAgICByZXR1cm4gaTE4bigiZGV2aWNlX2lkc+agvOW8j+mUmeivrywg6K+36YeN5paw6L6T5YWlIikKICAgIGlmIHRyYWluX3N0YXJ0X2NoZWNrX3BvaW50ID09ICJOb25lIiBvciB0cmFpbl9zdGFydF9jaGVja19wb2ludCA9PSAiIjoKICAgICAgICBzdGFydF9jaGVja19wb2ludCA9ICIiCiAgICBlbGlmIG9zLnBhdGguZXhpc3RzKHJlc3VsdHNfcGF0aCk6CiAgICAgICAgc3RhcnRfY2hlY2tfcG9pbnQgPSAiLS1zdGFydF9jaGVja19wb2ludCAiICsgIlwiIiArIG9zLnBhdGguam9pbihyZXN1bHRzX3BhdGgsIHRyYWluX3N0YXJ0X2NoZWNrX3BvaW50KSArICJcIiIKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIGkxOG4oIuaooeWei+S/neWtmOi3r+W+hOS4jeWtmOWcqCwg6K+36YeN5paw6YCJ5oupIikKICAgIGNvbW1hbmQgPSBmIntQWVRIT059IHt0cmFpbl9maWxlfSAtLW1vZGVsX3R5cGUge21vZGVsX3R5cGV9IC0tY29uZmlnX3BhdGggXCJ7Y29uZmlnX3BhdGh9XCIge3N0YXJ0X2NoZWNrX3BvaW50fSAtLXJlc3VsdHNfcGF0aCBcIntyZXN1bHRzX3BhdGh9XCIgLS1kYXRhX3BhdGggXCJ7ZGF0YV9wYXRofVwiIC0tZGF0YXNldF90eXBlIHtkYXRhc2V0X3R5cGV9IC0tdmFsaWRfcGF0aCBcInt2YWxpZF9wYXRofVwiIC0tbnVtX3dvcmtlcnMge251bV93b3JrZXJzfSAtLWRldmljZV9pZHMge2RldmljZV9pZHN9IC0tc2VlZCB7c2VlZH0ge3Bpbl9tZW1vcnl9IHt1c2VfbXVsdGlzdGZ0X2xvc3N9IHt1c2VfbXNlX2xvc3N9IHt1c2VfbDFfbG9zc30ge3ByZV92YWxpZH0iCiAgICB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1ydW5fY29tbWFuZCwgYXJncz0oY29tbWFuZCwpLCBuYW1lPSJtc3N0X3RyYWluaW5nIikuc3RhcnQoKQogICAgcmV0dXJuIGkxOG4oIuiuree7g+WQr+WKqOaIkOWKnyEg6K+35YmN5b6A5o6n5Yi25Y+w5p+l55yL6K6t57uD5L+h5oGvISAiKQoKZGVmIHZhbGlkYXRlX21vZGVsKHZhbGlkX21vZGVsX3R5cGUsIHZhbGlkX2NvbmZpZ19wYXRoLCB2YWxpZF9tb2RlbF9wYXRoLCB2YWxpZF9wYXRoLCB2YWxpZF9yZXN1bHRzX3BhdGgsIHZhbGlkX2RldmljZV9pZHMsIHZhbGlkX251bV93b3JrZXJzLCB2YWxpZF9leHRlbnNpb24sIHZhbGlkX3Bpbl9tZW1vcnksIHZhbGlkX3VzZV90dGEpOgogICAgaWYgdmFsaWRfbW9kZWxfdHlwZSBub3QgaW4gTU9ERUxfVFlQRToKICAgICAgICByZXR1cm4gaTE4bigi5qih5Z6L57G75Z6L6ZSZ6K+vLCDor7fph43mlrDpgInmi6kiKQogICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKHZhbGlkX2NvbmZpZ19wYXRoKToKICAgICAgICByZXR1cm4gaTE4bigi6YWN572u5paH5Lu25LiN5a2Y5ZyoLCDor7fph43mlrDpgInmi6kiKQogICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKHZhbGlkX21vZGVsX3BhdGgpOgogICAgICAgIHJldHVybiBpMThuKCLmqKHlnovkuI3lrZjlnKgsIOivt+mHjeaWsOmAieaLqSIpCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHModmFsaWRfcGF0aCk6CiAgICAgICAgcmV0dXJuIGkxOG4oIumqjOivgembhui3r+W+hOS4jeWtmOWcqCwg6K+36YeN5paw6YCJ5oupIikKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyh2YWxpZF9yZXN1bHRzX3BhdGgpOgogICAgICAgIG9zLm1ha2VkaXJzKHZhbGlkX3Jlc3VsdHNfcGF0aCkKICAgIGlmIG5vdCBib29sKHJlLm1hdGNoKHInXihcZCspKD86XHMoPyFcMSlcZCspKiQnLCB2YWxpZF9kZXZpY2VfaWRzKSk6CiAgICAgICAgcmV0dXJuIGkxOG4oImRldmljZV9pZHPmoLzlvI/plJnor68sIOivt+mHjeaWsOi+k+WFpSIpCiAgICBwaW5fbWVtb3J5ID0gIi0tcGluX21lbW9yeSIgaWYgdmFsaWRfcGluX21lbW9yeSBlbHNlICIiCiAgICB1c2VfdHRhID0gIi0tdXNlX3R0YSIgaWYgdmFsaWRfdXNlX3R0YSBlbHNlICIiCiAgICBjb21tYW5kID0gZiJ7UFlUSE9OfSB2YWxpZC5weSAtLW1vZGVsX3R5cGUge3ZhbGlkX21vZGVsX3R5cGV9IC0tY29uZmlnX3BhdGggXCJ7dmFsaWRfY29uZmlnX3BhdGh9XCIgLS1zdGFydF9jaGVja19wb2ludCBcInt2YWxpZF9tb2RlbF9wYXRofVwiIC0tdmFsaWRfcGF0aCBcInt2YWxpZF9wYXRofVwiIC0tc3RvcmVfZGlyIFwie3ZhbGlkX3Jlc3VsdHNfcGF0aH1cIiAtLWRldmljZV9pZHMge3ZhbGlkX2RldmljZV9pZHN9IC0tbnVtX3dvcmtlcnMge3ZhbGlkX251bV93b3JrZXJzfSAtLWV4dGVuc2lvbiB7dmFsaWRfZXh0ZW5zaW9ufSB7cGluX21lbW9yeX0ge3VzZV90dGF9IgogICAgbXNzdF92YWxpZCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXJ1bl9jb21tYW5kLCBhcmdzPShjb21tYW5kLCksIG5hbWU9Im1zc3RfdmFsaWQiKQogICAgbXNzdF92YWxpZC5zdGFydCgpCiAgICBtc3N0X3ZhbGlkLmpvaW4oKQogICAgcmV0dXJuIGkxOG4oIumqjOivgeWujOaIkCEg6K+35omT5byA6L6T5Ye65paH5Lu25aS55p+l55yL6K+m57uG57uT5p6cIikKCmRlZiBjaGVja193ZWJ1aV91cGRhdGUoKToKICAgIHVybCA9ICJodHRwczovL2dpdGh1Yi5jb20vU1VDLURyaXZlck9sZC9NU1NULVdlYlVJL3JlbGVhc2VzL2xhdGVzdCIKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwpCiAgICAgICAgcmVzcG9uc2UucmFpc2VfZm9yX3N0YXR1cygpCiAgICAgICAgbGF0ZXN0X3ZlcnNpb24gPSByZXNwb25zZS51cmwuc3BsaXQoIi8iKVstMV0KICAgICAgICBpZiBsYXRlc3RfdmVyc2lvbiAhPSBQQUNLQUdFX1ZFUlNJT046CiAgICAgICAgICAgIHJldHVybiBpMThuKCLlvZPliY3niYjmnKw6ICIpICsgUEFDS0FHRV9WRVJTSU9OICsgaTE4bigiLCDlj5HnjrDmlrDniYjmnKw6ICIpICsgbGF0ZXN0X3ZlcnNpb24KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gaTE4bigi5b2T5YmN54mI5pysOiAiKSArIFBBQ0tBR0VfVkVSU0lPTiArIGkxOG4oIiwg5bey5piv5pyA5paw54mI5pysIikKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIGkxOG4oIuajgOafpeabtOaWsOWksei0pSIpCgpkZWYgd2VidWlfZ290b19naXRodWIoKToKICAgIHdlYmJyb3dzZXIub3BlbigiaHR0cHM6Ly9naXRodWIuY29tL1NVQy1Ecml2ZXJPbGQvTVNTVC1XZWJVSS9yZWxlYXNlcy9sYXRlc3QiKQoKZGVmIGNoYW5nZV9sYW5ndWFnZShsYW5ndWFnZSk6CiAgICBjb25maWcgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKQogICAgaWYgbGFuZ3VhZ2UgaW4gbGFuZ3VhZ2VfZGljdC5rZXlzKCk6CiAgICAgICAgY29uZmlnWydzZXR0aW5ncyddWydsYW5ndWFnZSddID0gbGFuZ3VhZ2VfZGljdFtsYW5ndWFnZV0KICAgIGVsc2U6CiAgICAgICAgY29uZmlnWydzZXR0aW5ncyddWydsYW5ndWFnZSddID0gIkF1dG8iCiAgICBzYXZlX2NvbmZpZ3MoY29uZmlnLCBXRUJVSV9DT05GSUcpCiAgICByZXR1cm4gaTE4bigi6K+t6KiA5bey5pu05pS5LCDph43lkK9XZWJVSeeUn+aViCIpCgpkZWYgZ2V0X2xhbmd1YWdlKCk6CiAgICBjb25maWcgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKQogICAgbGFuZ3VhZ2UgPSBjb25maWdbJ3NldHRpbmdzJ11bJ2xhbmd1YWdlJ10KICAgIGZvciBrZXksIHZhbHVlIGluIGxhbmd1YWdlX2RpY3QuaXRlbXMoKToKICAgICAgICBpZiB2YWx1ZSA9PSBsYW5ndWFnZToKICAgICAgICAgICAgcmV0dXJuIGtleQogICAgcmV0dXJuICJBdXRvIgoKZGVmIHNhdmVfcG9ydF90b19jb25maWcocG9ydCk6CiAgICBwb3J0ID0gaW50KHBvcnQpCiAgICBjb25maWcgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKQogICAgY29uZmlnWydzZXR0aW5ncyddWydwb3J0J10gPSBwb3J0CiAgICBzYXZlX2NvbmZpZ3MoY29uZmlnLCBXRUJVSV9DT05GSUcpCiAgICByZXR1cm4gaTE4bigi5oiQ5Yqf5bCG56uv5Y+j6K6+572u5Li6IikgKyBzdHIocG9ydCkgKyBpMThuKCIsIOmHjeWQr1dlYlVJ55Sf5pWIIikKCmRlZiBjaGFuZ2VfZG93bmxvYWRfbGluayhsaW5rKToKICAgIGNvbmZpZyA9IGxvYWRfY29uZmlncyhXRUJVSV9DT05GSUcpCiAgICBpZiBsaW5rID09IGkxOG4oImh1Z2dpbmdmYWNlLmNvICjpnIDopoHprZTms5UpIik6CiAgICAgICAgY29uZmlnWydzZXR0aW5ncyddWydkb3dubG9hZF9saW5rJ10gPSAiaHVnZ2luZ2ZhY2UuY28iCiAgICBlbGlmIGxpbmsgPT0gaTE4bigiaGYtbWlycm9yLmNvbSAo6ZWc5YOP56uZ5Y+v55u06L+eKSIpOgogICAgICAgIGNvbmZpZ1snc2V0dGluZ3MnXVsnZG93bmxvYWRfbGluayddID0gImhmLW1pcnJvci5jb20iCiAgICBlbHNlOgogICAgICAgIGNvbmZpZ1snc2V0dGluZ3MnXVsnZG93bmxvYWRfbGluayddID0gIkF1dG8iCiAgICBzYXZlX2NvbmZpZ3MoY29uZmlnLCBXRUJVSV9DT05GSUcpCiAgICByZXR1cm4gaTE4bigi5LiL6L296ZO+5o6l5bey5pu05pS5IikKCmRlZiBjaGFuZ2Vfc2hhcmVfbGluayhmbGFnKToKICAgIGNvbmZpZyA9IGxvYWRfY29uZmlncyhXRUJVSV9DT05GSUcpCiAgICBpZiBmbGFnOgogICAgICAgIGNvbmZpZ1snc2V0dGluZ3MnXVsnc2hhcmVfbGluayddID0gVHJ1ZQogICAgICAgIHNhdmVfY29uZmlncyhjb25maWcsIFdFQlVJX0NPTkZJRykKICAgICAgICByZXR1cm4gaTE4bigi5YWs5YWx6ZO+5o6l5bey5byA5ZCvLCDph43lkK9XZWJVSeeUn+aViCIpCiAgICBlbHNlOgogICAgICAgIGNvbmZpZ1snc2V0dGluZ3MnXVsnc2hhcmVfbGluayddID0gRmFsc2UKICAgICAgICBzYXZlX2NvbmZpZ3MoY29uZmlnLCBXRUJVSV9DT05GSUcpCiAgICAgICAgcmV0dXJuIGkxOG4oIuWFrOWFsemTvuaOpeW3suWFs+mXrSwg6YeN5ZCvV2ViVUnnlJ/mlYgiKQoKZGVmIGNoYW5nZV9sb2NhbF9saW5rKGZsYWcpOgogICAgY29uZmlnID0gbG9hZF9jb25maWdzKFdFQlVJX0NPTkZJRykKICAgIGlmIGZsYWc6CiAgICAgICAgY29uZmlnWydzZXR0aW5ncyddWydsb2NhbF9saW5rJ10gPSBUcnVlCiAgICAgICAgc2F2ZV9jb25maWdzKGNvbmZpZywgV0VCVUlfQ09ORklHKQogICAgICAgIHJldHVybiBpMThuKCLlt7LlvIDlkK/lsYDln5/nvZHliIbkuqssIOmHjeWQr1dlYlVJ55Sf5pWIIikKICAgIGVsc2U6CiAgICAgICAgY29uZmlnWydzZXR0aW5ncyddWydsb2NhbF9saW5rJ10gPSBGYWxzZQogICAgICAgIHNhdmVfY29uZmlncyhjb25maWcsIFdFQlVJX0NPTkZJRykKICAgICAgICByZXR1cm4gaTE4bigi5bey5YWz6Zet5bGA5Z+f572R5YiG5LqrLCDph43lkK9XZWJVSeeUn+aViCIpCgpkZWYgdXBkYXRlX3JlbmFtZV9tb2RlbF9uYW1lKG1vZGVsX3R5cGUpOgogICAgaWYgbW9kZWxfdHlwZSA9PSAiVVZSX1ZSX01vZGVscyI6CiAgICAgICAgZG93bmxvYWRlZF9tb2RlbCA9IGxvYWRfdnJfbW9kZWwoKQogICAgICAgIHJldHVybiBnci5Ecm9wZG93bihsYWJlbD1pMThuKGtleT0i6YCJ5oup5qih5Z6LIiksIGNob2ljZXM9ZG93bmxvYWRlZF9tb2RlbCwgaW50ZXJhY3RpdmU9VHJ1ZSwgc2NhbGU9NCkKICAgIGVsc2U6CiAgICAgICAgZG93bmxvYWRlZF9tb2RlbCA9IGxvYWRfc2VsZWN0ZWRfbW9kZWwobW9kZWxfdHlwZSkKICAgICAgICByZXR1cm4gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5qih5Z6LIiksIGNob2ljZXM9ZG93bmxvYWRlZF9tb2RlbCwgaW50ZXJhY3RpdmU9VHJ1ZSwgc2NhbGU9NCkKCmRlZiByZW5hbWVfbmFtZShtb2RlbF90eXBlLCBtb2RlbF9uYW1lLCBuZXdfbmFtZSk6CiAgICBtZXNzYWdlID0gaTE4bigi5qih5Z6LIikgKyBtb2RlbF9uYW1lICsgaTE4bigi5bey6YeN5ZG95ZCN5Li6IikgKyBuZXdfbmFtZQogICAgcmVuYW1lX21vZGVsX3R5cGUgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6nmqKHlnovnsbvlnosiKSwgY2hvaWNlcz1NT0RFTF9DSE9JQ0VTLCB2YWx1ZT1Ob25lLCBpbnRlcmFjdGl2ZT1UcnVlLCBzY2FsZT0xKQogICAgcmVuYW1lX21vZGVsX25hbWUgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6nmqKHlnosiKSwgY2hvaWNlcz1baTE4bigi6K+35YWI6YCJ5oup5qih5Z6L57G75Z6LIildLCB2YWx1ZT1pMThuKCLor7flhYjpgInmi6nmqKHlnovnsbvlnosiKSwgaW50ZXJhY3RpdmU9VHJ1ZSwgc2NhbGU9NCkKICAgIGlmIG1vZGVsX3R5cGUgPT0gIiIgb3IgbW9kZWxfbmFtZSA9PSAiIiBvciBuZXdfbmFtZSA9PSAiIjoKICAgICAgICByZXR1cm4gIiIsIHJlbmFtZV9tb2RlbF90eXBlLCByZW5hbWVfbW9kZWxfbmFtZQogICAgb3MubWFrZWRpcnMob3MucGF0aC5qb2luKFVOT0ZGSUNJQUxfTU9ERUwpLCBleGlzdF9vaz1UcnVlKQogICAgdHJ5OgogICAgICAgIGlmIG1vZGVsX3R5cGUgPT0gIlVWUl9WUl9Nb2RlbHMiOgogICAgICAgICAgICBpZiBub3QgbmV3X25hbWUuZW5kc3dpdGgoIi5wdGgiKToKICAgICAgICAgICAgICAgIHJldHVybiBpMThuKCLmlrDmqKHlnovlkI3np7DlkI7nvIDplJnor68hIiksIHJlbmFtZV9tb2RlbF90eXBlLCByZW5hbWVfbW9kZWxfbmFtZQogICAgICAgICAgICBpZiBuZXdfbmFtZSBpbiBsb2FkX3ZyX21vZGVsKCk6CiAgICAgICAgICAgICAgICByZXR1cm4gaTE4bigi5qih5Z6L5ZCN5a2X5bey5a2Y5ZyoISDor7fph43mlrDlkb3lkI0hIiksIHJlbmFtZV9tb2RlbF90eXBlLCByZW5hbWVfbW9kZWxfbmFtZQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBuZXdfbW9kZWxfbWFwID0gbG9hZF9jb25maWdzKG9zLnBhdGguam9pbihVTk9GRklDSUFMX01PREVMLCAidW5vZmZpY2lhbF92cl9tb2RlbC5qc29uIikpCiAgICAgICAgICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoKICAgICAgICAgICAgICAgIG5ld19tb2RlbF9tYXAgPSB7fQogICAgICAgICAgICBtb2RlbF9tYXAgPSBsb2FkX2NvbmZpZ3MoVlJfTU9ERUwpCiAgICAgICAgICAgIHV2cl9tb2RlbF9kaXIgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKVsnc2V0dGluZ3MnXVsndXZyX21vZGVsX2RpciddCiAgICAgICAgICAgIG5ld19jb25maWcgPSB7fQogICAgICAgICAgICBmb3IgbW9kZWwgaW4gbW9kZWxfbWFwLmtleXMoKToKICAgICAgICAgICAgICAgIGlmIG1vZGVsID09IG1vZGVsX25hbWU6CiAgICAgICAgICAgICAgICAgICAgbmV3X2NvbmZpZyA9IG1vZGVsX21hcFttb2RlbF0KICAgICAgICAgICAgICAgICAgICBuZXdfbW9kZWxfbWFwW25ld19uYW1lXSA9IG5ld19jb25maWcKICAgICAgICAgICAgICAgICAgICBzaHV0aWwuY29weShvcy5wYXRoLmpvaW4odXZyX21vZGVsX2RpciwgbW9kZWxfbmFtZSksIG9zLnBhdGguam9pbih1dnJfbW9kZWxfZGlyLCBuZXdfbmFtZSkpCiAgICAgICAgICAgICAgICAgICAgb3MudW5saW5rKG9zLnBhdGguam9pbih1dnJfbW9kZWxfZGlyLCBtb2RlbF9uYW1lKSkKICAgICAgICAgICAgICAgICAgICBzYXZlX2NvbmZpZ3MobmV3X21vZGVsX21hcCwgb3MucGF0aC5qb2luKFVOT0ZGSUNJQUxfTU9ERUwsICJ1bm9mZmljaWFsX3ZyX21vZGVsLmpzb24iKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZSwgcmVuYW1lX21vZGVsX3R5cGUsIHJlbmFtZV9tb2RlbF9uYW1lCiAgICAgICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKG9zLnBhdGguam9pbihVTk9GRklDSUFMX01PREVMLCAidW5vZmZpY2lhbF92cl9tb2RlbC5qc29uIikpOgogICAgICAgICAgICAgICAgdW5vZmZpY2lhbF9tb2RlbF9tYXAgPSBsb2FkX2NvbmZpZ3Mob3MucGF0aC5qb2luKFVOT0ZGSUNJQUxfTU9ERUwsICJ1bm9mZmljaWFsX3ZyX21vZGVsLmpzb24iKSkKICAgICAgICAgICAgICAgIGZvciBtb2RlbCBpbiB1bm9mZmljaWFsX21vZGVsX21hcC5rZXlzKCk6CiAgICAgICAgICAgICAgICAgICAgaWYgbW9kZWwgPT0gbW9kZWxfbmFtZToKICAgICAgICAgICAgICAgICAgICAgICAgbmV3X2NvbmZpZyA9IHVub2ZmaWNpYWxfbW9kZWxfbWFwW21vZGVsXQogICAgICAgICAgICAgICAgICAgICAgICBuZXdfbW9kZWxfbWFwW25ld19uYW1lXSA9IG5ld19jb25maWcKICAgICAgICAgICAgICAgICAgICAgICAgc2h1dGlsLmNvcHkob3MucGF0aC5qb2luKHV2cl9tb2RlbF9kaXIsIG1vZGVsX25hbWUpLCBvcy5wYXRoLmpvaW4odXZyX21vZGVsX2RpciwgbmV3X25hbWUpKQogICAgICAgICAgICAgICAgICAgICAgICBvcy51bmxpbmsob3MucGF0aC5qb2luKHV2cl9tb2RlbF9kaXIsIG1vZGVsX25hbWUpKQogICAgICAgICAgICAgICAgICAgICAgICBzYXZlX2NvbmZpZ3MobmV3X21vZGVsX21hcCwgb3MucGF0aC5qb2luKFVOT0ZGSUNJQUxfTU9ERUwsICJ1bm9mZmljaWFsX3ZyX21vZGVsLmpzb24iKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UsIHJlbmFtZV9tb2RlbF90eXBlLCByZW5hbWVfbW9kZWxfbmFtZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIG5vdCBuZXdfbmFtZS5lbmRzd2l0aCgoIi5ja3B0IiwgIi5jaHB0IiwgIi50aCIpKToKICAgICAgICAgICAgICAgIHJldHVybiBpMThuKCLmlrDmqKHlnovlkI3np7DlkI7nvIDplJnor68hIiksIHJlbmFtZV9tb2RlbF90eXBlLCByZW5hbWVfbW9kZWxfbmFtZQogICAgICAgICAgICBpZiBuZXdfbmFtZSBpbiBsb2FkX21zc3RfbW9kZWwoKToKICAgICAgICAgICAgICAgIHJldHVybiBpMThuKCLmqKHlnovlkI3lrZflt7LlrZjlnKghIOivt+mHjeaWsOWRveWQjSEiKSwgcmVuYW1lX21vZGVsX3R5cGUsIHJlbmFtZV9tb2RlbF9uYW1lCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG5ld19tb2RlbF9tYXAgPSBsb2FkX2NvbmZpZ3Mob3MucGF0aC5qb2luKFVOT0ZGSUNJQUxfTU9ERUwsICJ1bm9mZmljaWFsX21zc3RfbW9kZWwuanNvbiIpKQogICAgICAgICAgICBleGNlcHQgRmlsZU5vdEZvdW5kRXJyb3I6CiAgICAgICAgICAgICAgICBuZXdfbW9kZWxfbWFwID0geyJtdWx0aV9zdGVtX21vZGVscyI6IFtdLCAic2luZ2xlX3N0ZW1fbW9kZWxzIjogW10sICJ2b2NhbF9tb2RlbHMiOiBbXX0KICAgICAgICAgICAgbW9kZWxfbWFwID0gbG9hZF9jb25maWdzKE1TU1RfTU9ERUwpCiAgICAgICAgICAgIGZvciBtb2RlbCBpbiBtb2RlbF9tYXBbbW9kZWxfdHlwZV06CiAgICAgICAgICAgICAgICBpZiBtb2RlbFsnbmFtZSddID09IG1vZGVsX25hbWU6CiAgICAgICAgICAgICAgICAgICAgbW9kZWxbJ25hbWUnXSA9IG5ld19uYW1lCiAgICAgICAgICAgICAgICAgICAgbmV3X21vZGVsX21hcFttb2RlbF90eXBlXS5hcHBlbmQobW9kZWwpCiAgICAgICAgICAgICAgICAgICAgc2h1dGlsLmNvcHkob3MucGF0aC5qb2luKE1PREVMX0ZPTERFUiwgbW9kZWxfdHlwZSwgbW9kZWxfbmFtZSksIG9zLnBhdGguam9pbihNT0RFTF9GT0xERVIsIG1vZGVsX3R5cGUsIG5ld19uYW1lKSkKICAgICAgICAgICAgICAgICAgICBvcy51bmxpbmsob3MucGF0aC5qb2luKE1PREVMX0ZPTERFUiwgbW9kZWxfdHlwZSwgbW9kZWxfbmFtZSkpCiAgICAgICAgICAgICAgICAgICAgc2F2ZV9jb25maWdzKG5ld19tb2RlbF9tYXAsIG9zLnBhdGguam9pbihVTk9GRklDSUFMX01PREVMLCAidW5vZmZpY2lhbF9tc3N0X21vZGVsLmpzb24iKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZSwgcmVuYW1lX21vZGVsX3R5cGUsIHJlbmFtZV9tb2RlbF9uYW1lCiAgICAgICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKG9zLnBhdGguam9pbihVTk9GRklDSUFMX01PREVMLCAidW5vZmZpY2lhbF9tc3N0X21vZGVsLmpzb24iKSk6CiAgICAgICAgICAgICAgICB1bm9mZmljaWFsX21vZGVsX21hcCA9IGxvYWRfY29uZmlncyhvcy5wYXRoLmpvaW4oVU5PRkZJQ0lBTF9NT0RFTCwgInVub2ZmaWNpYWxfbXNzdF9tb2RlbC5qc29uIikpCiAgICAgICAgICAgICAgICBmb3IgbW9kZWwgaW4gdW5vZmZpY2lhbF9tb2RlbF9tYXBbbW9kZWxfdHlwZV06CiAgICAgICAgICAgICAgICAgICAgaWYgbW9kZWxbJ25hbWUnXSA9PSBtb2RlbF9uYW1lOgogICAgICAgICAgICAgICAgICAgICAgICBtb2RlbFsnbmFtZSddID0gbmV3X25hbWUKICAgICAgICAgICAgICAgICAgICAgICAgbmV3X21vZGVsX21hcFttb2RlbF90eXBlXS5hcHBlbmQobW9kZWwpCiAgICAgICAgICAgICAgICAgICAgICAgIHNodXRpbC5jb3B5KG9zLnBhdGguam9pbihNT0RFTF9GT0xERVIsIG1vZGVsX3R5cGUsIG1vZGVsX25hbWUpLCBvcy5wYXRoLmpvaW4oTU9ERUxfRk9MREVSLCBtb2RlbF90eXBlLCBuZXdfbmFtZSkpCiAgICAgICAgICAgICAgICAgICAgICAgIG9zLnVubGluayhvcy5wYXRoLmpvaW4oTU9ERUxfRk9MREVSLCBtb2RlbF90eXBlLCBtb2RlbF9uYW1lKSkKICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZV9jb25maWdzKG5ld19tb2RlbF9tYXAsIG9zLnBhdGguam9pbihVTk9GRklDSUFMX01PREVMLCAidW5vZmZpY2lhbF9tc3N0X21vZGVsLmpzb24iKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UsIHJlbmFtZV9tb2RlbF90eXBlLCByZW5hbWVfbW9kZWxfbmFtZQogICAgICAgIHJldHVybiBpMThuKCLph43lkb3lkI3lpLHotKUhIiksIHJlbmFtZV9tb2RlbF90eXBlLCByZW5hbWVfbW9kZWxfbmFtZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGUpCiAgICAgICAgcmFpc2UgZ3IuRXJyb3IoaTE4bigi6YeN5ZG95ZCN5aSx6LSlISIpKQoKc2V0dXBfd2VidWkoKQp3aXRoIGdyLkJsb2NrcygKICAgICAgICB0aGVtZT1nci5UaGVtZS5sb2FkKCd0b29scy90aGVtZXMvdGhlbWVfc2NoZW1hQDEuMi4yLmpzb24nKQopIGFzIGFwcDoKICAgIGdyLk1hcmtkb3duKHZhbHVlPWYiIiIjIyMgTXVzaWMtU291cmNlLVNlcGFyYXRpb24tVHJhaW5pbmctSW5mZXJlbmNlLVdlYnVpIHZ7UEFDS0FHRV9WRVJTSU9OfSIiIikKICAgIGdyLk1hcmtkb3duKHZhbHVlPWkxOG4oIuS7heS+m+S4quS6uuWoseS5kOWSjOmdnuWVhuS4mueUqOmAlCwg56aB5q2i55So5LqO6KGA6IWlL+aatOWKmy/mgKfnm7jlhbMv5pS/5rK755u45YWz5YaF5a6544CCW+eCueWHu+WJjeW+gOaVmeeoi+aWh+aho10oaHR0cHM6Ly9yMWtjNjNpejE1bC5mZWlzaHUuY24vd2lraS9KU3Azd2s3enVpbnZJWGtJcVNVY0NYWTFuS2MpPGJyPuacrOaVtOWQiOWMheWujOWFqOWFjei0uSwg5Lil56aB5Lul5Lu75L2V5b2i5byP5YCS5Y2WLCDlpoLmnpzkvaDku47ku7vkvZXlnLDmlrkqKuS7mOi0uSoq6LSt5Lmw5LqG5pys5pW05ZCI5YyFLCDor7cqKueri+WNs+mAgOasvioq44CCPGJyPiDmlbTlkIjljIXkvZzogIU6IFtiaWxpYmlsaUDpmL/ni7jkuI3lkIPpmrzoiJ5dKGh0dHBzOi8vc3BhY2UuYmlsaWJpbGkuY29tLzQwMzMzNTcxNSkgW0dpdGh1YkBLaXRzdW5lWDA3XShodHRwczovL2dpdGh1Yi5jb20vS2l0c3VuZVgwNykgfCBbQmlsaWJpbGlAU3VjaWFsXShodHRwczovL3NwYWNlLmJpbGliaWxpLmNvbS80NDUwMjI0MDkpIFtHaXRodWJAU1VDLURyaXZlck9sZF0oaHR0cHM6Ly9naXRodWIuY29tL1NVQy1Ecml2ZXJPbGQpIHwgR3JhZGlv5Li76aKYOiBbR3JhZGlvIFRoZW1lXShodHRwczovL2h1Z2dpbmdmYWNlLmNvL3NwYWNlcy9Ob0NyeXB0L21pa3UpIikpCiAgICB3aXRoIGdyLlRhYnMoKToKICAgICAgICB3ZWJ1aV9jb25maWcgPSBsb2FkX2NvbmZpZ3MoV0VCVUlfQ09ORklHKQogICAgICAgIHByZXNldHMgPSBsb2FkX2NvbmZpZ3MoUFJFU0VUUykKICAgICAgICBtb2RlbHMgPSBsb2FkX2NvbmZpZ3MoTVNTVF9NT0RFTCkKICAgICAgICB2cl9tb2RlbCA9IGxvYWRfY29uZmlncyhWUl9NT0RFTCkKCiAgICAgICAgd2l0aCBnci5UYWJJdGVtKGxhYmVsPWkxOG4oIk1TU1TliIbnprsiKSk6CiAgICAgICAgICAgIGdyLk1hcmtkb3duKHZhbHVlPWkxOG4oIk1TU1Tpn7PpopHliIbnprvljp/pobnnm67lnLDlnYA6IFtodHRwczovL2dpdGh1Yi5jb20vWkZUdXJiby9NdXNpYy1Tb3VyY2UtU2VwYXJhdGlvbi1UcmFpbmluZ10oaHR0cHM6Ly9naXRodWIuY29tL1pGVHVyYm8vTXVzaWMtU291cmNlLVNlcGFyYXRpb24tVHJhaW5pbmcpIikpCiAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICBzZWxlY3RfbW9kZWxfdHlwZSA9IGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIumAieaLqeaooeWei+exu+WeiyIpLCBjaG9pY2VzPVsidm9jYWxfbW9kZWxzIiwgIm11bHRpX3N0ZW1fbW9kZWxzIiwgInNpbmdsZV9zdGVtX21vZGVscyJdLCB2YWx1ZT13ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWydtb2RlbF90eXBlJ10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnbW9kZWxfdHlwZSddIGVsc2UgTm9uZSwgaW50ZXJhY3RpdmU9VHJ1ZSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgIHNlbGVjdGVkX21vZGVsID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5qih5Z6LIiksY2hvaWNlcz1sb2FkX3NlbGVjdGVkX21vZGVsKCksdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnc2VsZWN0ZWRfbW9kZWwnXSBpZiB3ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWydzZWxlY3RlZF9tb2RlbCddIGVsc2UgTm9uZSxpbnRlcmFjdGl2ZT1UcnVlLHNjYWxlPTQpCiAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICBncHVfaWQgPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIumAieaLqeS9v+eUqOeahEdQVSBJRCwg5aSa5Y2h55So5oi36K+35L2/55So56m65qC85YiG6ZqUR1BVIElE44CC5Y+v5YmN5b6A6K6+572u6aG16Z2i5p+l55yL5pi+5Y2h5L+h5oGv44CCIiksdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnZ3B1X2lkJ10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnZ3B1X2lkJ10gZWxzZSAiMCIsaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgIG91dHB1dF9mb3JtYXQgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLovpPlh7rmoLzlvI8iKSxjaG9pY2VzPVsid2F2IiwgIm1wMyIsICJmbGFjIl0sdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnb3V0cHV0X2Zvcm1hdCddIGlmIHdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ291dHB1dF9mb3JtYXQnXSBlbHNlICJ3YXYiLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgZm9yY2VfY3B1ID0gZ3IuQ2hlY2tib3gobGFiZWw9aTE4bigi5L2/55SoQ1BVICjms6jmhI86IOS9v+eUqENQVeS8muWvvOiHtOmAn+W6pumdnuW4uOaFoikgIiksdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnZm9yY2VfY3B1J10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnZm9yY2VfY3B1J10gZWxzZSBGYWxzZSxpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgZXh0cmFjdF9pbnN0cnVtZW50YWwgPSBnci5DaGVja2JveChsYWJlbD1pMThuKCLlkIzml7bovpPlh7rmrKHnuqfpn7PovagiKSx2YWx1ZT13ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWydleHRyYWN0X2luc3RydW1lbnRhbCddIGlmIHdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ2V4dHJhY3RfaW5zdHJ1bWVudGFsJ10gZWxzZSBGYWxzZSxpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgdXNlX3R0YSA9IGdyLkNoZWNrYm94KGxhYmVsPWkxOG4oIuS9v+eUqFRUQSAo5rWL6K+V5pe25aKe5by6KSwg5Y+v6IO95Lya5o+Q6auY6LSo6YePLCDkvYbpgJ/luqbnqI3mhaIiKSx2YWx1ZT13ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd1c2VfdHRhJ10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndXNlX3R0YSddIGVsc2UgRmFsc2UsaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgd2l0aCBnci5UYWJzKCk6CiAgICAgICAgICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigi5Y2V5Liq6Z+z6aKR5LiK5LygIikpOgogICAgICAgICAgICAgICAgICAgIHNpbmdsZV9hdWRpbyA9IGdyLkZpbGUobGFiZWw9aTE4bigi5Y2V5Liq6Z+z6aKR5LiK5LygIiksIHR5cGU9ImZpbGVwYXRoIikKICAgICAgICAgICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbD1pMThuKCLmibnph4/pn7PpopHkuIrkvKAiKSk6CiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgbXVsdGlwbGVfYXVkaW9faW5wdXQgPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIui+k+WFpeebruW9lSIpLHZhbHVlPXdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ211bHRpcGxlX2F1ZGlvX2lucHV0J10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnbXVsdGlwbGVfYXVkaW9faW5wdXQnXSBlbHNlICJpbnB1dC8iLGludGVyYWN0aXZlPVRydWUsc2NhbGU9MykKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0X211bHRpX2lucHV0X2RpciA9IGdyLkJ1dHRvbihpMThuKCLpgInmi6nmlofku7blpLkiKSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICAgICAgb3Blbl9tdWx0aV9pbnB1dF9kaXIgPSBnci5CdXR0b24oaTE4bigi5omT5byA5paH5Lu25aS5IiksIHNjYWxlPTEpCiAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICBzdG9yZV9kaXIgPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIui+k+WHuuebruW9lSIpLHZhbHVlPXdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3N0b3JlX2RpciddIGlmIHdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3N0b3JlX2RpciddIGVsc2UgInJlc3VsdHMvIixpbnRlcmFjdGl2ZT1UcnVlLHNjYWxlPTMpCiAgICAgICAgICAgICAgICBzZWxlY3Rfc3RvcmVfYnRuID0gZ3IuQnV0dG9uKGkxOG4oIumAieaLqeaWh+S7tuWkuSIpLCBzY2FsZT0xKQogICAgICAgICAgICAgICAgb3Blbl9zdG9yZV9idG4gPSBnci5CdXR0b24oaTE4bigi5omT5byA5paH5Lu25aS5IiksIHNjYWxlPTEpCiAgICAgICAgICAgIHdpdGggZ3IuQWNjb3JkaW9uKGkxOG4oIuaOqOeQhuWPguaVsOiuvue9riwg5LiN5ZCM5qih5Z6L5LmL6Ze05Y+C5pWw55u45LqS54us56uLICjkuIDoiKzkuI3pnIDopoHliqgpICIpLCBvcGVuPUZhbHNlKToKICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKHZhbHVlPWkxOG4oIuWPquacieWcqOeCueWHu+S/neWtmOWQjuaJjeS8mueUn+aViOOAguWPguaVsOebtOaOpeWGmeWFpemFjee9ruaWh+S7tiwg5peg5rOV5pKk6ZSA44CC5YGH5aaC5LiN55+l6YGT5aaC5L2V6K6+572uLCDor7fkv53mjIHpu5jorqTlgLzjgII8YnI+6K+354mi6K6w6Ieq5bex5L+u5pS55YmN55qE5Y+C5pWw5pWw5YC8LCDpmLLmraLlh7rnjrDpl67popjku6XlkI7ml6Dms5XmgaLlpI3jgILor7fnoa7kv53ovpPlhaXmraPnoa7nmoTlj4LmlbAsIOWQpuWImeWPr+iDveS8muWvvOiHtOaooeWei+aXoOazleato+W4uOi/kOihjOOAgjxicj7lgYflpoLkv67mlLnlkI7ml6Dms5XmgaLlpI0sIOivt+eCueWHu2Bg6YeN572uYGDmjInpkq4sIOi/meS8muS9v+W+l+mFjee9ruaWh+S7tuaBouWkjeWIsOm7mOiupOWAvOOAgiIpKQogICAgICAgICAgICAgICAgaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnc2VsZWN0ZWRfbW9kZWwnXToKICAgICAgICAgICAgICAgICAgICBiYXRjaF9zaXplX251bWJlciwgZGltX3RfbnVtYmVyLCBudW1fb3ZlcmxhcF9udW1iZXIgPSBpbml0X3NlbGVjdGVkX21vZGVsKCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgYmF0Y2hfc2l6ZV9udW1iZXIsIGRpbV90X251bWJlciwgbnVtX292ZXJsYXBfbnVtYmVyID0gaTE4bigi6K+35YWI6YCJ5oup5qih5Z6LIiksIGkxOG4oIuivt+WFiOmAieaLqeaooeWeiyIpLCBpMThuKCLor7flhYjpgInmi6nmqKHlnosiKQogICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICBiYXRjaF9zaXplID0gZ3IuVGV4dGJveChsYWJlbD1pMThuKCJiYXRjaF9zaXplOiDmibnmrKHlpKflsI8sIOS4gOiIrOS4jemcgOimgeaUuSIpLCB2YWx1ZT1iYXRjaF9zaXplX251bWJlcikKICAgICAgICAgICAgICAgICAgICBkaW1fdCA9IGdyLlRleHRib3gobGFiZWw9aTE4bigiZGltX3Q6IOaXtuW6j+e7tOW6puWkp+Wwjywg5LiA6Iis5LiN6ZyA6KaB5pS5ICjpg6jliIbmqKHlnovmsqHmnInmraTlj4LmlbApIiksIHZhbHVlPWRpbV90X251bWJlcikKICAgICAgICAgICAgICAgICAgICBudW1fb3ZlcmxhcCA9IGdyLlRleHRib3gobGFiZWw9aTE4bigibnVtX292ZXJsYXA6IOeql+WPo+mHjeWPoOmVv+W6piwg5pWw5YC86LaK5bCP6YCf5bqm6LaK5b+rLCDkvYbkvJrnibrnibLmlYjmnpwiKSwgdmFsdWU9bnVtX292ZXJsYXBfbnVtYmVyKQogICAgICAgICAgICAgICAgbm9ybWFsaXplID0gZ3IuQ2hlY2tib3gobGFiZWw9aTE4bigibm9ybWFsaXplOiDmmK/lkKblr7npn7PpopHov5vooYzlvZLkuIDljJblpITnkIYgKOmDqOWIhuaooeWei+ayoeacieatpOWPguaVsCkiKSwgdmFsdWU9RmFsc2UsIGludGVyYWN0aXZlPUZhbHNlKQogICAgICAgICAgICAgICAgcmVzZXRfY29uZmlnX2J1dHRvbiA9IGdyLkJ1dHRvbihpMThuKCLph43nva7phY3nva4iKSwgdmFyaWFudD0ic2Vjb25kYXJ5IikKICAgICAgICAgICAgICAgIHNhdmVfY29uZmlnX2J1dHRvbiA9IGdyLkJ1dHRvbihpMThuKCLkv53lrZjphY3nva4iKSwgdmFyaWFudD0icHJpbWFyeSIpCiAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICBpbmZlcmVuY2Vfc2luZ2xlID0gZ3IuQnV0dG9uKGkxOG4oIuWNleS4qumfs+mikeWIhuemuyIpLCB2YXJpYW50PSJwcmltYXJ5IikKICAgICAgICAgICAgICAgIGluZmVyZW5jZV9tdWx0aXBsZSA9IGdyLkJ1dHRvbihpMThuKCLmibnph4/pn7PpopHliIbnprsiKSwgdmFyaWFudD0icHJpbWFyeSIpCiAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICBvdXRwdXRfbWVzc2FnZSA9IGdyLlRleHRib3gobGFiZWw9Ik91dHB1dCBNZXNzYWdlIiwgc2NhbGU9NCkKICAgICAgICAgICAgICAgIHN0b3BfdGhyZWFkID0gZ3IuQnV0dG9uKGkxOG4oIuW8uuWItuWBnOatoiIpLCBzY2FsZT0xKQoKICAgICAgICAgICAgaW5mZXJlbmNlX3NpbmdsZS5jbGljayhmbj1ydW5faW5mZXJlbmNlX3NpbmdsZSxpbnB1dHM9W3NlbGVjdGVkX21vZGVsLCBzaW5nbGVfYXVkaW8sIHN0b3JlX2RpciwgZXh0cmFjdF9pbnN0cnVtZW50YWwsIGdwdV9pZCwgb3V0cHV0X2Zvcm1hdCwgZm9yY2VfY3B1LCB1c2VfdHRhXSxvdXRwdXRzPW91dHB1dF9tZXNzYWdlKQogICAgICAgICAgICBpbmZlcmVuY2VfbXVsdGlwbGUuY2xpY2soZm49cnVuX211bHRpX2luZmVyZW5jZSwgaW5wdXRzPVtzZWxlY3RlZF9tb2RlbCwgbXVsdGlwbGVfYXVkaW9faW5wdXQsIHN0b3JlX2RpciwgZXh0cmFjdF9pbnN0cnVtZW50YWwsIGdwdV9pZCwgb3V0cHV0X2Zvcm1hdCwgZm9yY2VfY3B1LCB1c2VfdHRhXSxvdXRwdXRzPW91dHB1dF9tZXNzYWdlKQogICAgICAgICAgICBzZWxlY3RfbW9kZWxfdHlwZS5jaGFuZ2UoZm49dXBkYXRlX3NlbGVjdGVkX21vZGVsLCBpbnB1dHM9W3NlbGVjdF9tb2RlbF90eXBlXSwgb3V0cHV0cz1bc2VsZWN0ZWRfbW9kZWxdKQogICAgICAgICAgICBzZWxlY3RlZF9tb2RlbC5jaGFuZ2UoZm49dXBkYXRlX2luZmVyZW5jZV9zZXR0aW5ncyxpbnB1dHM9W3NlbGVjdGVkX21vZGVsXSxvdXRwdXRzPVtiYXRjaF9zaXplLCBkaW1fdCwgbnVtX292ZXJsYXAsIG5vcm1hbGl6ZV0pCiAgICAgICAgICAgIHNhdmVfY29uZmlnX2J1dHRvbi5jbGljayhmbj1zYXZlX2NvbmZpZyxpbnB1dHM9W3NlbGVjdGVkX21vZGVsLCBiYXRjaF9zaXplLCBkaW1fdCwgbnVtX292ZXJsYXAsIG5vcm1hbGl6ZV0sb3V0cHV0cz1vdXRwdXRfbWVzc2FnZSkKICAgICAgICAgICAgcmVzZXRfY29uZmlnX2J1dHRvbi5jbGljayhmbj1yZXNldF9jb25maWcsaW5wdXRzPVtzZWxlY3RlZF9tb2RlbF0sb3V0cHV0cz1vdXRwdXRfbWVzc2FnZSkKICAgICAgICAgICAgc2VsZWN0X3N0b3JlX2J0bi5jbGljayhmbj1zZWxlY3RfZm9sZGVyLCBvdXRwdXRzPXN0b3JlX2RpcikKICAgICAgICAgICAgb3Blbl9zdG9yZV9idG4uY2xpY2soZm49b3Blbl9mb2xkZXIsIGlucHV0cz1zdG9yZV9kaXIpCiAgICAgICAgICAgIHNlbGVjdF9tdWx0aV9pbnB1dF9kaXIuY2xpY2soZm49c2VsZWN0X2ZvbGRlciwgb3V0cHV0cz1tdWx0aXBsZV9hdWRpb19pbnB1dCkKICAgICAgICAgICAgb3Blbl9tdWx0aV9pbnB1dF9kaXIuY2xpY2soZm49b3Blbl9mb2xkZXIsIGlucHV0cz1tdWx0aXBsZV9hdWRpb19pbnB1dCkKICAgICAgICAgICAgc3RvcF90aHJlYWQuY2xpY2soZm49c3RvcF9hbGxfdGhyZWFkKQoKICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigiVVZS5YiG56a7IikpOgogICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLor7TmmI46IOacrOaVtOWQiOWMheS7heiejeWQiOS6hlVWUueahFZSIEFyY2hpdGVjdHVyZeaooeWeiywgTURYMjND5ZKMSHREZW11Y3PnsbvmqKHlnovlj6/ku6Xnm7TmjqXkvb/nlKjliY3pnaLnmoRNU1NU6Z+z6aKR5YiG56a744CCPGJyPlVWUuWIhuemu+S9v+eUqOmhueebrjogW2h0dHBzOi8vZ2l0aHViLmNvbS9ub21hZGthcmFva2UvcHl0aG9uLWF1ZGlvLXNlcGFyYXRvcl0oaHR0cHM6Ly9naXRodWIuY29tL25vbWFka2FyYW9rZS9weXRob24tYXVkaW8tc2VwYXJhdG9yKSDlubbov5vooYzkuobkvJjljJbjgIIiKSkKICAgICAgICAgICAgdnJfc2VsZWN0X21vZGVsID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5qih5Z6LIiksIGNob2ljZXM9bG9hZF92cl9tb2RlbCgpLCB2YWx1ZT13ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9zZWxlY3RfbW9kZWwnXSBpZiB3ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9zZWxlY3RfbW9kZWwnXSBlbHNlIE5vbmUsaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgIHZyX3dpbmRvd19zaXplID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigiV2luZG93IFNpemU6IOeql+WPo+Wkp+Wwjywg55So5LqO5bmz6KGh6YCf5bqm5ZKM6LSo6YePIiksIGNob2ljZXM9WyIzMjAiLCAiNTEyIiwgIjEwMjQiXSwgdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfd2luZG93X3NpemUnXSBpZiB3ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl93aW5kb3dfc2l6ZSddIGVsc2UgIjUxMiIsIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICB2cl9hZ2dyZXNzaW9uID0gZ3IuTnVtYmVyKGxhYmVsPWkxOG4oIkFnZ3Jlc3Npb246IOS4u+W5suaPkOWPluW8uuW6piwg6IyD5Zu0LTEwMC0xMDAsIOS6uuWjsOivt+mAiTUiKSwgbWluaW11bT0tMTAwLCBtYXhpbXVtPTEwMCwgdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfYWdncmVzc2lvbiddIGlmIHdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX2FnZ3Jlc3Npb24nXSBlbHNlIDUsIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICB2cl9vdXRwdXRfZm9ybWF0ID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6L6T5Ye65qC85byPIiksIGNob2ljZXM9WyJ3YXYiLCAiZmxhYyIsICJtcDMiXSwgdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfb3V0cHV0X2Zvcm1hdCddIGlmIHdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX291dHB1dF9mb3JtYXQnXSBlbHNlICJ3YXYiLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgdnJfcHJpbWFyeV9zdGVtX2xhYmVsLCB2cl9zZWNvbmRhcnlfc3RlbV9sYWJlbCA9IGluaXRfc2VsZWN0ZWRfdnJfbW9kZWwoKQogICAgICAgICAgICAgICAgdnJfdXNlX2NwdSA9IGdyLkNoZWNrYm94KGxhYmVsPWkxOG4oIuS9v+eUqENQVSIpLCB2YWx1ZT13ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl91c2VfY3B1J10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfdXNlX2NwdSddIGVsc2UgRmFsc2UsIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICB2cl9wcmltYXJ5X3N0ZW1fb25seSA9IGdyLkNoZWNrYm94KGxhYmVsPXZyX3ByaW1hcnlfc3RlbV9sYWJlbCwgdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfcHJpbWFyeV9zdGVtX29ubHknXSBpZiB3ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9wcmltYXJ5X3N0ZW1fb25seSddIGVsc2UgRmFsc2UsIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICB2cl9zZWNvbmRhcnlfc3RlbV9vbmx5ID0gZ3IuQ2hlY2tib3gobGFiZWw9dnJfc2Vjb25kYXJ5X3N0ZW1fbGFiZWwsIHZhbHVlPXdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX3NlY29uZGFyeV9zdGVtX29ubHknXSBpZiB3ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9zZWNvbmRhcnlfc3RlbV9vbmx5J10gZWxzZSBGYWxzZSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgd2l0aCBnci5UYWJzKCk6CiAgICAgICAgICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigi5Y2V5Liq6Z+z6aKR5LiK5LygIikpOgogICAgICAgICAgICAgICAgICAgIHZyX3NpbmdsZV9hdWRpbyA9IGdyLkZpbGUobGFiZWw9IuWNleS4qumfs+mikeS4iuS8oCIsIHR5cGU9ImZpbGVwYXRoIikKICAgICAgICAgICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbD1pMThuKCLmibnph4/pn7PpopHkuIrkvKAiKSk6CiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgdnJfbXVsdGlwbGVfYXVkaW9faW5wdXQgPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIui+k+WFpeebruW9lSIpLHZhbHVlPXdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX211bHRpcGxlX2F1ZGlvX2lucHV0J10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfbXVsdGlwbGVfYXVkaW9faW5wdXQnXSBlbHNlICJpbnB1dC8iLCBpbnRlcmFjdGl2ZT1UcnVlLCBzY2FsZT0zKQogICAgICAgICAgICAgICAgICAgICAgICB2cl9zZWxlY3RfbXVsdGlfaW5wdXRfZGlyID0gZ3IuQnV0dG9uKGkxOG4oIumAieaLqeaWh+S7tuWkuSIpLCBzY2FsZT0xKQogICAgICAgICAgICAgICAgICAgICAgICB2cl9vcGVuX211bHRpX2lucHV0X2RpciA9IGdyLkJ1dHRvbihpMThuKCLmiZPlvIDmlofku7blpLkiKSwgc2NhbGU9MSkKICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgIHZyX3N0b3JlX2RpciA9IGdyLlRleHRib3gobGFiZWw9aTE4bigi6L6T5Ye655uu5b2VIiksdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfc3RvcmVfZGlyJ10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfc3RvcmVfZGlyJ10gZWxzZSAicmVzdWx0cy8iLGludGVyYWN0aXZlPVRydWUsc2NhbGU9MykKICAgICAgICAgICAgICAgIHZyX3NlbGVjdF9zdG9yZV9idG4gPSBnci5CdXR0b24oaTE4bigi6YCJ5oup5paH5Lu25aS5IiksIHNjYWxlPTEpCiAgICAgICAgICAgICAgICB2cl9vcGVuX3N0b3JlX2J0biA9IGdyLkJ1dHRvbihpMThuKCLmiZPlvIDmlofku7blpLkiKSwgc2NhbGU9MSkKICAgICAgICAgICAgd2l0aCBnci5BY2NvcmRpb24oaTE4bigi5Lul5LiL5piv5LiA5Lqb6auY57qn6K6+572uLCDkuIDoiKzkv53mjIHpu5jorqTljbPlj68iKSwgb3Blbj1GYWxzZSk6CiAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgIHZyX2JhdGNoX3NpemUgPSBnci5OdW1iZXIobGFiZWw9aTE4bigiQmF0Y2ggU2l6ZTog5LiA5qyh6KaB5aSE55CG55qE5om55qyh5pWwLCDotorlpKfljaDnlKjotorlpJpSQU0sIOWkhOeQhumAn+W6puWKoOW/qyIpLCBtaW5pbXVtPTEsIHZhbHVlPXdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX2JhdGNoX3NpemUnXSBpZiB3ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9iYXRjaF9zaXplJ10gZWxzZSAyLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgIHZyX25vcm1hbGl6YXRpb24gPSBnci5OdW1iZXIobGFiZWw9aTE4bigiTm9ybWFsaXphdGlvbjog5pyA5aSn5bOw5YC85oyv5bmFLCDnlKjkuo7lvZLkuIDljJbovpPlhaXlkozovpPlh7rpn7PpopHjgILlj5blgLzkuLowLTEiKSwgbWluaW11bT0wLjAsIG1heGltdW09MS4wLCBzdGVwPTAuMDEsIHZhbHVlPXdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX25vcm1hbGl6YXRpb24nXSBpZiB3ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9ub3JtYWxpemF0aW9uJ10gZWxzZSAxLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgIHZyX3Bvc3RfcHJvY2Vzc190aHJlc2hvbGQgPSBnci5OdW1iZXIobGFiZWw9aTE4bigiUG9zdCBQcm9jZXNzIFRocmVzaG9sZDog5ZCO5aSE55CG54m55b6B6ZiI5YC8LCDlj5blgLzkuLowLjEtMC4zIiksIG1pbmltdW09MC4xLCBtYXhpbXVtPTAuMywgc3RlcD0wLjAxLCB2YWx1ZT13ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9wb3N0X3Byb2Nlc3NfdGhyZXNob2xkJ10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfcG9zdF9wcm9jZXNzX3RocmVzaG9sZCddIGVsc2UgMC4yLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICB2cl9pbnZlcnRfc3BlY3QgPSBnci5DaGVja2JveChsYWJlbD1pMThuKCJJbnZlcnQgU3BlY3Ryb2dyYW06IOS6jOe6p+atpemqpOWwhuS9v+eUqOmikeiwseWbvuiAjOmdnuazouW9oui/m+ihjOWPjei9rCwg5Y+v6IO95Lya5o+Q6auY6LSo6YePLCDkvYbpgJ/luqbnqI3mhaIiKSwgdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfaW52ZXJ0X3NwZWN0J10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfaW52ZXJ0X3NwZWN0J10gZWxzZSBGYWxzZSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICB2cl9lbmFibGVfdHRhID0gZ3IuQ2hlY2tib3gobGFiZWw9aTE4bigiRW5hYmxlIFRUQTog5ZCv55So4oCc5rWL6K+V5pe25aKe5by64oCdLCDlj6/og73kvJrmj5Dpq5jotKjph48sIOS9humAn+W6pueojeaFoiIpLCB2YWx1ZT13ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9lbmFibGVfdHRhJ10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfZW5hYmxlX3R0YSddIGVsc2UgRmFsc2UsIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgdnJfaGlnaF9lbmRfcHJvY2VzcyA9IGdyLkNoZWNrYm94KGxhYmVsPWkxOG4oIkhpZ2ggRW5kIFByb2Nlc3M6IOWwhui+k+WHuumfs+mikee8uuWkseeahOmikeeOh+iMg+WbtOmVnOWDj+i+k+WHuiIpLCB2YWx1ZT13ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9oaWdoX2VuZF9wcm9jZXNzJ10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsndnJfaGlnaF9lbmRfcHJvY2VzcyddIGVsc2UgRmFsc2UsIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgdnJfZW5hYmxlX3Bvc3RfcHJvY2VzcyA9IGdyLkNoZWNrYm94KGxhYmVsPWkxOG4oIkVuYWJsZSBQb3N0IFByb2Nlc3M6IOivhuWIq+S6uuWjsOi+k+WHuuS4reaui+eVmeeahOS6uuW3peeXlei/uSwg5Y+v5pS55ZaE5p+Q5Lqb5q2M5puy55qE5YiG56a75pWI5p6cIiksIHZhbHVlPXdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX2VuYWJsZV9wb3N0X3Byb2Nlc3MnXSBpZiB3ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9lbmFibGVfcG9zdF9wcm9jZXNzJ10gZWxzZSBGYWxzZSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgIHZyX2RlYnVnX21vZGUgPSBnci5DaGVja2JveChsYWJlbD1pMThuKCJEZWJ1ZyBNb2RlOiDlkK/nlKjosIPor5XmqKHlvI8sIOWQkeW8gOWPkeS6uuWRmOWPjemmiOaXtiwg6K+35byA5ZCv5q2k5qih5byPIiksIHZhbHVlPXdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3ZyX2RlYnVnX21vZGUnXSBpZiB3ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWyd2cl9kZWJ1Z19tb2RlJ10gZWxzZSBGYWxzZSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgIHZyX3N0YXJ0X3NpbmdsZV9pbmZlcmVuY2UgPSBnci5CdXR0b24oaTE4bigi5Y2V5Liq6Z+z6aKR5YiG56a7IiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgdnJfc3RhcnRfbXVsdGlfaW5mZXJlbmNlID0gZ3IuQnV0dG9uKGkxOG4oIuaJuemHj+mfs+mikeWIhuemuyIpLCB2YXJpYW50PSJwcmltYXJ5IikKICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgIHZyX291dHB1dF9tZXNzYWdlID0gZ3IuVGV4dGJveChsYWJlbD0iT3V0cHV0IE1lc3NhZ2UiLCBzY2FsZT00KQogICAgICAgICAgICAgICAgc3RvcF90aHJlYWQgPSBnci5CdXR0b24oaTE4bigi5by65Yi25YGc5q2iIiksIHNjYWxlPTEpCgogICAgICAgICAgICB2cl9zZWxlY3RfbW9kZWwuY2hhbmdlKGZuPWxvYWRfdnJfbW9kZWxfc3RlbSxpbnB1dHM9dnJfc2VsZWN0X21vZGVsLG91dHB1dHM9W3ZyX3ByaW1hcnlfc3RlbV9vbmx5LCB2cl9zZWNvbmRhcnlfc3RlbV9vbmx5XSkKICAgICAgICAgICAgdnJfc2VsZWN0X211bHRpX2lucHV0X2Rpci5jbGljayhmbj1zZWxlY3RfZm9sZGVyLCBvdXRwdXRzPXZyX211bHRpcGxlX2F1ZGlvX2lucHV0KQogICAgICAgICAgICB2cl9vcGVuX211bHRpX2lucHV0X2Rpci5jbGljayhmbj1vcGVuX2ZvbGRlciwgaW5wdXRzPXZyX211bHRpcGxlX2F1ZGlvX2lucHV0KQogICAgICAgICAgICB2cl9zZWxlY3Rfc3RvcmVfYnRuLmNsaWNrKGZuPXNlbGVjdF9mb2xkZXIsIG91dHB1dHM9dnJfc3RvcmVfZGlyKQogICAgICAgICAgICB2cl9vcGVuX3N0b3JlX2J0bi5jbGljayhmbj1vcGVuX2ZvbGRlciwgaW5wdXRzPXZyX3N0b3JlX2RpcikKICAgICAgICAgICAgdnJfc3RhcnRfc2luZ2xlX2luZmVyZW5jZS5jbGljayhmbj12cl9pbmZlcmVuY2Vfc2luZ2xlLGlucHV0cz1bdnJfc2VsZWN0X21vZGVsLCB2cl93aW5kb3dfc2l6ZSwgdnJfYWdncmVzc2lvbiwgdnJfb3V0cHV0X2Zvcm1hdCwgdnJfdXNlX2NwdSwgdnJfcHJpbWFyeV9zdGVtX29ubHksIHZyX3NlY29uZGFyeV9zdGVtX29ubHksIHZyX3NpbmdsZV9hdWRpbywgdnJfc3RvcmVfZGlyLCB2cl9iYXRjaF9zaXplLCB2cl9ub3JtYWxpemF0aW9uLCB2cl9wb3N0X3Byb2Nlc3NfdGhyZXNob2xkLCB2cl9pbnZlcnRfc3BlY3QsIHZyX2VuYWJsZV90dGEsIHZyX2hpZ2hfZW5kX3Byb2Nlc3MsIHZyX2VuYWJsZV9wb3N0X3Byb2Nlc3MsIHZyX2RlYnVnX21vZGVdLG91dHB1dHM9dnJfb3V0cHV0X21lc3NhZ2UpCiAgICAgICAgICAgIHZyX3N0YXJ0X211bHRpX2luZmVyZW5jZS5jbGljayhmbj12cl9pbmZlcmVuY2VfbXVsdGksaW5wdXRzPVt2cl9zZWxlY3RfbW9kZWwsIHZyX3dpbmRvd19zaXplLCB2cl9hZ2dyZXNzaW9uLCB2cl9vdXRwdXRfZm9ybWF0LCB2cl91c2VfY3B1LCB2cl9wcmltYXJ5X3N0ZW1fb25seSwgdnJfc2Vjb25kYXJ5X3N0ZW1fb25seSwgdnJfbXVsdGlwbGVfYXVkaW9faW5wdXQsIHZyX3N0b3JlX2RpciwgdnJfYmF0Y2hfc2l6ZSwgdnJfbm9ybWFsaXphdGlvbiwgdnJfcG9zdF9wcm9jZXNzX3RocmVzaG9sZCwgdnJfaW52ZXJ0X3NwZWN0LCB2cl9lbmFibGVfdHRhLCB2cl9oaWdoX2VuZF9wcm9jZXNzLCB2cl9lbmFibGVfcG9zdF9wcm9jZXNzLCB2cl9kZWJ1Z19tb2RlXSxvdXRwdXRzPXZyX291dHB1dF9tZXNzYWdlKQogICAgICAgICAgICBzdG9wX3RocmVhZC5jbGljayhmbj1zdG9wX2FsbF90aHJlYWQpCgogICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbD1pMThuKCLpooTorr7mtYHnqIsiKSk6CiAgICAgICAgICAgIGdyLk1hcmtkb3duKHZhbHVlPWkxOG4oIumihOiuvua1geeoi+WFgeiuuOaMieeFp+mihOiuvueahOmhuuW6j+i/kOihjOWkmuS4quaooeWei+OAguavj+S4gOS4quaooeWei+eahOi+k+WHuuWwhuS9nOS4uuS4i+S4gOS4quaooeWei+eahOi+k+WFpeOAgiIpKQogICAgICAgICAgICB3aXRoIGdyLlRhYnMoKToKICAgICAgICAgICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbD1pMThuKCLkvb/nlKjpooTorr4iKSk6CiAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24odmFsdWU9aTE4bigi6K+l5qih5byP5LiL55qEVVZS5o6o55CG5Y+C5pWw5bCG55u05o6l5rK/55SoVVZS5YiG56a76aG16Z2i55qE5o6o55CG5Y+C5pWwLCDlpoLpnIDkv67mlLnor7fliY3lvoBVVlLliIbnprvpobXpnaLjgII8YnI+5L+u5pS55a6M5oiQ5ZCOLCDov5jpnIDopoHku7vmhI/lpITnkIbkuIDpppbmrYzmiY3og73kv53lrZjlj4LmlbAhICIpKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHByZXNldF9kcm9wZG93biA9IGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIuivt+mAieaLqemihOiuviIpLGNob2ljZXM9bGlzdChwcmVzZXRzLmtleXMoKSksdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsncHJlc2V0J10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsncHJlc2V0J10gZWxzZSBOb25lLCBpbnRlcmFjdGl2ZT1UcnVlLCBzY2FsZT00KQogICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRfZm9ybWF0X2Zsb3cgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLovpPlh7rmoLzlvI8iKSxjaG9pY2VzPVsid2F2IiwgIm1wMyIsICJmbGFjIl0sdmFsdWU9d2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnb3V0cHV0X2Zvcm1hdF9mbG93J10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnb3V0cHV0X2Zvcm1hdF9mbG93J10gZWxzZSAid2F2IiwgaW50ZXJhY3RpdmU9VHJ1ZSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICBmb3JjZV9jcHUgPSBnci5DaGVja2JveChsYWJlbD1pMThuKCLkvb/nlKhDUFUgKOazqOaEjzog5L2/55SoQ1BV5Lya5a+86Ie06YCf5bqm6Z2e5bi45oWiKSAiKSx2YWx1ZT13ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWydmb3JjZV9jcHUnXSBpZiB3ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWydmb3JjZV9jcHUnXSBlbHNlIEZhbHNlLGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5UYWJzKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbD1pMThuKCLljZXkuKrpn7PpopHkuIrkvKAiKSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW5nbGVfYXVkaW9fZmxvdyA9IGdyLkZpbGUobGFiZWw9aTE4bigi5Y2V5Liq6Z+z6aKR5LiK5LygIiksIHR5cGU9ImZpbGVwYXRoIikKICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5UYWJJdGVtKGxhYmVsPWkxOG4oIuaJuemHj+mfs+mikeS4iuS8oCIpKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRfZm9sZGVyX2Zsb3cgPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIui+k+WFpeebruW9lSIpLHZhbHVlPXdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ2lucHV0X2ZvbGRlcl9mbG93J10gaWYgd2VidWlfY29uZmlnWydpbmZlcmVuY2UnXVsnaW5wdXRfZm9sZGVyX2Zsb3cnXSBlbHNlICJpbnB1dC8iLGludGVyYWN0aXZlPVRydWUsc2NhbGU9MykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RfaW5wdXRfZGlyID0gZ3IuQnV0dG9uKGkxOG4oIumAieaLqeaWh+S7tuWkuSIpLCBzY2FsZT0xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5faW5wdXRfZGlyID0gZ3IuQnV0dG9uKGkxOG4oIuaJk+W8gOaWh+S7tuWkuSIpLCBzY2FsZT0xKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JlX2Rpcl9mbG93ID0gZ3IuVGV4dGJveChsYWJlbD1pMThuKCLovpPlh7rnm67lvZUiKSx2YWx1ZT13ZWJ1aV9jb25maWdbJ2luZmVyZW5jZSddWydzdG9yZV9kaXJfZmxvdyddIGlmIHdlYnVpX2NvbmZpZ1snaW5mZXJlbmNlJ11bJ3N0b3JlX2Rpcl9mbG93J10gZWxzZSAicmVzdWx0cy8iLGludGVyYWN0aXZlPVRydWUsc2NhbGU9MykKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0X291dHB1dF9kaXIgPSBnci5CdXR0b24oaTE4bigi6YCJ5oup5paH5Lu25aS5IiksIHNjYWxlPTEpCiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5fb3V0cHV0X2RpciA9IGdyLkJ1dHRvbihpMThuKCLmiZPlvIDmlofku7blpLkiKSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICBzaW5nbGVfaW5mZXJlbmNlX2Zsb3cgPSBnci5CdXR0b24oaTE4bigi5Y2V5Liq6Z+z6aKR5YiG56a7IiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgICAgICBpbmZlcmVuY2VfZmxvdyA9IGdyLkJ1dHRvbihpMThuKCLmibnph4/pn7PpopHliIbnprsiKSwgdmFyaWFudD0icHJpbWFyeSIpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0X21lc3NhZ2VfZmxvdyA9IGdyLlRleHRib3gobGFiZWw9Ik91dHB1dCBNZXNzYWdlIiwgc2NhbGU9NCkKICAgICAgICAgICAgICAgICAgICAgICAgc3RvcF90aHJlYWQgPSBnci5CdXR0b24oaTE4bigi5by65Yi25YGc5q2iIiksIHNjYWxlPTEpCiAgICAgICAgICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigi5Yi25L2c6aKE6K6+IikpOgogICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIuazqOaEjzogTVNTVOaooeWei+S7heaUr+aMgei+k+WHuuS4u+imgemfs+i9qCwgVVZS5qih5Z6L5pSv5oyB6Ieq5a6a5LmJ5Li76KaB6Z+z6L2o6L6T5Ye644CCPGJyPuWQjOaXtui+k+WHuuasoee6p+mfs+i9qDog6YCJ5oupVHJ1ZeWwhuWQjOaXtui+k+WHuuivpeasoeWIhuemu+W+l+WIsOeahOasoee6p+mfs+i9qCwgKirmraTpn7PovajlsIbnm7TmjqXkv53lrZjoh7MqKui+k+WHuuebruW9leS4i+eahHNlY29uZGFyeV9vdXRwdXTmlofku7blpLksICoq5LiN5Lya57uP6L+H5ZCO57ut5rWB56iL5aSE55CGKio8YnI+IikpCiAgICAgICAgICAgICAgICAgICAgcHJlc2V0X25hbWVfaW5wdXQgPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIumihOiuvuWQjeensCIpLCBwbGFjZWhvbGRlcj1pMThuKCLor7fovpPlhaXpooTorr7lkI3np7AiKSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICBtb2RlbF90eXBlID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5qih5Z6L57G75Z6LIiksIGNob2ljZXM9TU9ERUxfQ0hPSUNFUywgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxfbmFtZSA9IGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIumAieaLqeaooeWeiyIpLCBjaG9pY2VzPVtpMThuKCLor7flhYjpgInmi6nmqKHlnovnsbvlnosiKV0sIGludGVyYWN0aXZlPVRydWUsIHNjYWxlPTIpCiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZW0gPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLovpPlh7rpn7PovagiKSwgY2hvaWNlcz1baTE4bigi6K+35YWI6YCJ5oup5qih5Z6LIildLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRhcnlfb3V0cHV0ID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi5ZCM5pe26L6T5Ye65qyh57qn6Z+z6L2oIiksIGNob2ljZXM9WyJUcnVlIiwgIkZhbHNlIl0sIHZhbHVlPSJGYWxzZSIsIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgYWRkX3RvX2Zsb3cgPSBnci5CdXR0b24oaTE4bigi5re75Yqg6Iez5rWB56iLIikpCiAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigi6aKE6K6+5rWB56iLIikpCiAgICAgICAgICAgICAgICAgICAgcHJlc2V0X2Zsb3cgPSBnci5EYXRhZnJhbWUocGQuRGF0YUZyYW1lKHsibW9kZWxfdHlwZSI6IFsiIl0sICJtb2RlbF9uYW1lIjogWyIiXSwgInN0ZW0iOiBbIiJdLCAic2Vjb25kYXJ5X291dHB1dCI6IFsiIl19KSwgaW50ZXJhY3RpdmU9RmFsc2UsIGxhYmVsPU5vbmUpCiAgICAgICAgICAgICAgICAgICAgcmVzZXRfZmxvdyA9IGdyLkJ1dHRvbihpMThuKCLph43mlrDovpPlhaUiKSkKICAgICAgICAgICAgICAgICAgICBzYXZlX2Zsb3cgPSBnci5CdXR0b24oaTE4bigi5L+d5a2Y5LiK6L+w6aKE6K6+5rWB56iLIiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgIG91dHB1dF9tZXNzYWdlX21ha2UgPSBnci5UZXh0Ym94KGxhYmVsPSJPdXRwdXQgTWVzc2FnZSIpCiAgICAgICAgICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigi566h55CG6aKE6K6+IikpOgogICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIuatpOmhtemdouaPkOS+m+afpeeci+mihOiuviwg5Yig6Zmk6aKE6K6+LCDlpIfku73pooTorr4sIOaBouWkjemihOiuvuetieWKn+iDvSIpKQogICAgICAgICAgICAgICAgICAgIHByZXNldF9uYW1lX2RlbGV0ZSA9IGdyLkRyb3Bkb3duKGxhYmVsPWkxOG4oIuivt+mAieaLqemihOiuviIpLCBjaG9pY2VzPWxpc3QocHJlc2V0cy5rZXlzKCkpLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oImBtb2RlbF90eXBlYDog5qih5Z6L57G75Z6L77ybYG1vZGVsX25hbWVgOiDmqKHlnovlkI3np7DvvJtgc3RlbWA6IOS4u+imgei+k+WHuumfs+i9qO+8mzxicj5gc2Vjb25kYXJ5X291dHB1dGA6IOWQjOaXtui+k+WHuuasoee6p+mfs+i9qOOAgumAieaLqVRydWXlsIblkIzml7bovpPlh7ror6XmrKHliIbnprvlvpfliLDnmoTmrKHnuqfpn7PovagsICoq5q2k6Z+z6L2o5bCG55u05o6l5L+d5a2Y6IezKirovpPlh7rnm67lvZXkuIvnmoRzZWNvbmRhcnlfb3V0cHV05paH5Lu25aS5LCAqKuS4jeS8mue7j+i/h+WQjue7rea1geeoi+WkhOeQhioqIikpCiAgICAgICAgICAgICAgICAgICAgcHJlc2V0X2Zsb3dfZGVsZXRlID0gZ3IuRGF0YWZyYW1lKHBkLkRhdGFGcmFtZSh7Im1vZGVsX3R5cGUiOiBbaTE4bigi6K+35YWI6YCJ5oup6aKE6K6+IildLCAibW9kZWxfbmFtZSI6IFtpMThuKCLor7flhYjpgInmi6npooTorr4iKV0sICJzdGVtIjogW2kxOG4oIuivt+WFiOmAieaLqemihOiuviIpXSwgInNlY29uZGFyeV9vdXRwdXQiOiBbaTE4bigi6K+35YWI6YCJ5oup6aKE6K6+IildfSksIGludGVyYWN0aXZlPUZhbHNlLCBsYWJlbD1Ob25lKQogICAgICAgICAgICAgICAgICAgIGRlbGV0ZV9idXR0b24gPSBnci5CdXR0b24oaTE4bigi5Yig6Zmk5omA6YCJ6aKE6K6+IiksIHNjYWxlPTEpCiAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigi5q+P5qyh5Yig6Zmk6aKE6K6+5YmNLCDlsIboh6rliqjlpIfku73pooTorr7ku6XlhY3or6/mk43kvZzjgII8YnI+5L2g5Lmf5Y+v5Lul54K55Ye74oCc5aSH5Lu96aKE6K6+5rWB56iL4oCd5oyJ6ZKu6L+b6KGM5omL5Yqo5aSH5Lu9LCDkuZ/lj6/ku6Xku47lpIfku73mlofku7blpLnkuK3mgaLlpI3pooTorr7mtYHnqIvjgIIiKSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICBiYWNrdXBfcHJlc2V0ID0gZ3IuQnV0dG9uKGkxOG4oIuWkh+S7vemihOiuvua1geeoiyIpKQogICAgICAgICAgICAgICAgICAgICAgICBvcGVuX3ByZXNldF9iYWNrdXAgPSBnci5CdXR0b24oaTE4bigi5omT5byA5aSH5Lu95paH5Lu25aS5IikpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0X3ByZXNldF9iYWNrdXAgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6npnIDopoHmgaLlpI3nmoTpooTorr7mtYHnqIvlpIfku70iKSxjaG9pY2VzPXByZXNldF9iYWNrdXBfbGlzdCgpLGludGVyYWN0aXZlPVRydWUsc2NhbGU9NCkKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdG9yZV9wcmVzZXQgPSBnci5CdXR0b24oaTE4bigi5oGi5aSNIiksIHNjYWxlPTEpCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0X21lc3NhZ2VfbWFuYWdlID0gZ3IuVGV4dGJveChsYWJlbD0iT3V0cHV0IE1lc3NhZ2UiKQogICAgICAgICAgICAgICAgCgogICAgICAgICAgICBpbmZlcmVuY2VfZmxvdy5jbGljayhmbj1ydW5faW5mZXJlbmNlX2Zsb3csaW5wdXRzPVtpbnB1dF9mb2xkZXJfZmxvdywgc3RvcmVfZGlyX2Zsb3csIHByZXNldF9kcm9wZG93biwgZm9yY2VfY3B1LCBvdXRwdXRfZm9ybWF0X2Zsb3ddLG91dHB1dHM9b3V0cHV0X21lc3NhZ2VfZmxvdykKICAgICAgICAgICAgc2luZ2xlX2luZmVyZW5jZV9mbG93LmNsaWNrKGZuPXJ1bl9zaW5nbGVfaW5mZXJlbmNlX2Zsb3csaW5wdXRzPVtzaW5nbGVfYXVkaW9fZmxvdywgc3RvcmVfZGlyX2Zsb3csIHByZXNldF9kcm9wZG93biwgZm9yY2VfY3B1LCBvdXRwdXRfZm9ybWF0X2Zsb3ddLG91dHB1dHM9b3V0cHV0X21lc3NhZ2VfZmxvdykKICAgICAgICAgICAgc2VsZWN0X2lucHV0X2Rpci5jbGljayhmbj1zZWxlY3RfZm9sZGVyLCBvdXRwdXRzPWlucHV0X2ZvbGRlcl9mbG93KQogICAgICAgICAgICBvcGVuX2lucHV0X2Rpci5jbGljayhmbj1vcGVuX2ZvbGRlciwgaW5wdXRzPWlucHV0X2ZvbGRlcl9mbG93KQogICAgICAgICAgICBzZWxlY3Rfb3V0cHV0X2Rpci5jbGljayhmbj1zZWxlY3RfZm9sZGVyLCBvdXRwdXRzPXN0b3JlX2Rpcl9mbG93KQogICAgICAgICAgICBvcGVuX291dHB1dF9kaXIuY2xpY2soZm49b3Blbl9mb2xkZXIsIGlucHV0cz1zdG9yZV9kaXJfZmxvdykKICAgICAgICAgICAgbW9kZWxfdHlwZS5jaGFuZ2UodXBkYXRlX21vZGVsX25hbWUsIGlucHV0cz1tb2RlbF90eXBlLCBvdXRwdXRzPW1vZGVsX25hbWUpCiAgICAgICAgICAgIG1vZGVsX25hbWUuY2hhbmdlKHVwZGF0ZV9tb2RlbF9zdGVtLCBpbnB1dHM9W21vZGVsX3R5cGUsIG1vZGVsX25hbWVdLCBvdXRwdXRzPXN0ZW0pCiAgICAgICAgICAgIGFkZF90b19mbG93LmNsaWNrKGFkZF90b19mbG93X2Z1bmMsIFttb2RlbF90eXBlLCBtb2RlbF9uYW1lLCBzdGVtLCBzZWNvbmRhcnlfb3V0cHV0LCBwcmVzZXRfZmxvd10sIHByZXNldF9mbG93KQogICAgICAgICAgICBzYXZlX2Zsb3cuY2xpY2soc2F2ZV9mbG93X2Z1bmMsIFtwcmVzZXRfbmFtZV9pbnB1dCwgcHJlc2V0X2Zsb3ddLCBbb3V0cHV0X21lc3NhZ2VfbWFrZSwgcHJlc2V0X25hbWVfZGVsZXRlLCBwcmVzZXRfZHJvcGRvd25dKQogICAgICAgICAgICByZXNldF9mbG93LmNsaWNrKHJlc2V0X2Zsb3dfZnVuYywgW10sIHByZXNldF9mbG93KQogICAgICAgICAgICBkZWxldGVfYnV0dG9uLmNsaWNrKGRlbGV0ZV9mdW5jLCBbcHJlc2V0X25hbWVfZGVsZXRlXSwgW291dHB1dF9tZXNzYWdlX21hbmFnZSwgcHJlc2V0X25hbWVfZGVsZXRlLCBwcmVzZXRfZHJvcGRvd24sIHByZXNldF9mbG93X2RlbGV0ZSwgc2VsZWN0X3ByZXNldF9iYWNrdXBdKQogICAgICAgICAgICBwcmVzZXRfbmFtZV9kZWxldGUuY2hhbmdlKGxvYWRfcHJlc2V0LCBpbnB1dHM9cHJlc2V0X25hbWVfZGVsZXRlLCBvdXRwdXRzPXByZXNldF9mbG93X2RlbGV0ZSkKICAgICAgICAgICAgc3RvcF90aHJlYWQuY2xpY2soZm49c3RvcF9hbGxfdGhyZWFkKQogICAgICAgICAgICByZXN0b3JlX3ByZXNldC5jbGljayhmbj1yZXN0b3JlX3ByZXNldF9mdW5jLGlucHV0cz1bc2VsZWN0X3ByZXNldF9iYWNrdXBdLG91dHB1dHM9W291dHB1dF9tZXNzYWdlX21hbmFnZSwgcHJlc2V0X2Ryb3Bkb3duLCBwcmVzZXRfbmFtZV9kZWxldGUsIHByZXNldF9mbG93X2RlbGV0ZV0pCiAgICAgICAgICAgIGJhY2t1cF9wcmVzZXQuY2xpY2soZm49YmFja3VwX3ByZXNldF9mdW5jLG91dHB1dHM9W291dHB1dF9tZXNzYWdlX21hbmFnZSwgc2VsZWN0X3ByZXNldF9iYWNrdXBdKQogICAgICAgICAgICBvcGVuX3ByZXNldF9iYWNrdXAuY2xpY2sob3Blbl9mb2xkZXIsIGlucHV0cz1nci5UZXh0Ym94KEJBQ0tVUCwgdmlzaWJsZT1GYWxzZSkpCgogICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbD1pMThuKCLlsI/lt6XlhbciKSk6CiAgICAgICAgICAgIHdpdGggZ3IuVGFicygpOgogICAgICAgICAgICAgICAgd2l0aCBnci5UYWJJdGVtKGxhYmVsPWkxOG4oIumfs+mikeagvOW8j+i9rOaNoiIpKToKICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLkuIrkvKDkuIDkuKrmiJblpJrkuKrpn7PpopHmlofku7blubblsIblhbbovazmjaLkuLrmjIflrprmoLzlvI/jgII8YnI+5pSv5oyB55qE5qC85byP5YyF5ousIC5tcDMsIC5mbGFjLCAud2F2LCAub2dnLCAubTRhLCAud21hLCAuYWFjLi4u562J562J44CCPGJyPioq5LiN5pSv5oyBKirnvZHmmJPkupHpn7PkuZAvUVHpn7PkuZDnrYnliqDlr4bmoLzlvI8sIOWmgi5uY20sIC5xbWPnrYnjgIIiKSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICBpbnB1dHMgPSBnci5GaWxlcyhsYWJlbD1pMThuKCLkuIrkvKDkuIDkuKrmiJblpJrkuKrpn7PpopHmlofku7YiKSkKICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Db2x1bW4oKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZmbXBlZ19vdXRwdXRfZm9ybWF0ID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5oiW6L6T5YWl6Z+z6aKR6L6T5Ye65qC85byPIiksY2hvaWNlcz1bIndhdiIsICJmbGFjIiwgIm1wMyIsICJvZ2ciLCAibTRhIiwgIndtYSIsICJhYWMiXSx2YWx1ZT13ZWJ1aV9jb25maWdbJ3Rvb2xzJ11bJ2ZmbXBlZ19vdXRwdXRfZm9ybWF0J10gaWYgd2VidWlfY29uZmlnWyd0b29scyddWydmZm1wZWdfb3V0cHV0X2Zvcm1hdCddIGVsc2UgIndhdiIsYWxsb3dfY3VzdG9tX3ZhbHVlPVRydWUsaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZmbXBlZ19vdXRwdXRfZm9sZGVyID0gZ3IuVGV4dGJveChsYWJlbD1pMThuKCLpgInmi6npn7PpopHovpPlh7rnm67lvZUiKSwgdmFsdWU9d2VidWlfY29uZmlnWyd0b29scyddWydmZm1wZWdfb3V0cHV0X2ZvbGRlciddIGlmIHdlYnVpX2NvbmZpZ1sndG9vbHMnXVsnZmZtcGVnX291dHB1dF9mb2xkZXInXSBlbHNlICJyZXN1bHRzL2ZmbXBlZ19vdXRwdXQvIiwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0X2ZmbXBlZ19vdXRwdXRfZGlyID0gZ3IuQnV0dG9uKGkxOG4oIumAieaLqeaWh+S7tuWkuSIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5fZmZtcGVnX291dHB1dF9kaXIgPSBnci5CdXR0b24oaTE4bigi5omT5byA5paH5Lu25aS5IikpCiAgICAgICAgICAgICAgICAgICAgY29udmVydF9hdWRpb19idXR0b24gPSBnci5CdXR0b24oaTE4bigi6L2s5o2i6Z+z6aKRIiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgIG91dHB1dF9tZXNzYWdlX2ZmbXBlZyA9IGdyLlRleHRib3gobGFiZWw9Ik91dHB1dCBNZXNzYWdlIikKICAgICAgICAgICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbD1pMThuKCLlkIjlubbpn7PpopEiKSk6CiAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24odmFsdWU9aTE4bigi54K55Ye75ZCI5bm26Z+z6aKR5oyJ6ZKu5ZCOLCDlsIboh6rliqjmiorovpPlhaXmlofku7blpLnkuK3nmoTmiYDmnInpn7PpopHmlofku7blkIjlubbkuLrkuIDmlbTkuKrpn7PpopHmlofku7Y8YnI+55uu5YmN5pSv5oyB55qE5qC85byP5YyF5ousIC5tcDMsIC5mbGFjLCAud2F2LCAub2dnIOi/meWbm+enjTxicj7lkIjlubblkI7nmoTpn7PpopHkvJrkv53lrZjoh7PovpPlh7rnm67lvZXkuK0sIOaWh+S7tuWQjeS4um1lcmdlZF9hdWRpby53YXYiKSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICBtZXJnZV9hdWRpb19pbnB1dCA9IGdyLlRleHRib3gobGFiZWw9aTE4bigi6L6T5YWl55uu5b2VIiksdmFsdWU9d2VidWlfY29uZmlnWyd0b29scyddWydtZXJnZV9hdWRpb19pbnB1dCddIGlmIHdlYnVpX2NvbmZpZ1sndG9vbHMnXVsnbWVyZ2VfYXVkaW9faW5wdXQnXSBlbHNlICJpbnB1dC8iLGludGVyYWN0aXZlPVRydWUsc2NhbGU9MykKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0X21lcmdlX2lucHV0X2RpciA9IGdyLkJ1dHRvbihpMThuKCLpgInmi6nmlofku7blpLkiKSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICAgICAgb3Blbl9tZXJnZV9pbnB1dF9kaXIgPSBnci5CdXR0b24oaTE4bigi5omT5byA5paH5Lu25aS5IiksIHNjYWxlPTEpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VfYXVkaW9fb3V0cHV0ID0gZ3IuVGV4dGJveChsYWJlbD1pMThuKCLovpPlh7rnm67lvZUiKSx2YWx1ZT13ZWJ1aV9jb25maWdbJ3Rvb2xzJ11bJ21lcmdlX2F1ZGlvX291dHB1dCddIGlmIHdlYnVpX2NvbmZpZ1sndG9vbHMnXVsnbWVyZ2VfYXVkaW9fb3V0cHV0J10gZWxzZSAicmVzdWx0cy9tZXJnZSIsaW50ZXJhY3RpdmU9VHJ1ZSxzY2FsZT0zKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RfbWVyZ2Vfb3V0cHV0X2RpciA9IGdyLkJ1dHRvbihpMThuKCLpgInmi6nmlofku7blpLkiKSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICAgICAgb3Blbl9tZXJnZV9vdXRwdXRfZGlyID0gZ3IuQnV0dG9uKGkxOG4oIuaJk+W8gOaWh+S7tuWkuSIpLCBzY2FsZT0xKQogICAgICAgICAgICAgICAgICAgIG1lcmdlX2F1ZGlvX2J1dHRvbiA9IGdyLkJ1dHRvbihpMThuKCLlkIjlubbpn7PpopEiKSwgdmFyaWFudD0icHJpbWFyeSIpCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0X21lc3NhZ2VfbWVyZ2UgPSBnci5UZXh0Ym94KGxhYmVsPSJPdXRwdXQgTWVzc2FnZSIpCiAgICAgICAgICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigi6K6h566XU0RSIikpOgogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuQ29sdW1uKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKHZhbHVlPWkxOG4oIuS4iuS8oOS4pOS4qioqd2F26Z+z6aKR5paH5Lu2KirlubborqHnrpflroPku6znmoRbU0RSXShodHRwczovL3d3dy5haWNyb3dkLmNvbS9jaGFsbGVuZ2VzL211c2ljLWRlbWl4aW5nLWNoYWxsZW5nZS1pc21pci0yMDIxI2V2YWx1YXRpb24tbWV0cmljKeOAgjxicj5TRFLmmK/kuIDkuKrnlKjkuo7or4TkvLDmqKHlnovotKjph4/nmoTmlbDlgLzjgILmlbDlgLzotorlpKcsIOaooeWei+eul+azlee7k+aenOi2iuWlveOAgiIpKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHRydWVfYXVkaW8gPSBnci5GaWxlKGxhYmVsPWkxOG4oIuWOn+Wni+mfs+mikSIpLCB0eXBlPSJmaWxlcGF0aCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZF9hdWRpbyA9IGdyLkZpbGUobGFiZWw9aTE4bigi5YiG56a75ZCO55qE6Z+z6aKRIiksIHR5cGU9ImZpbGVwYXRoIikKICAgICAgICAgICAgICAgICAgICBjb21wdXRlX3Nkcl9idXR0b24gPSBnci5CdXR0b24oaTE4bigi6K6h566XU0RSIiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgIG91dHB1dF9tZXNzYWdlX3NkciA9IGdyLlRleHRib3gobGFiZWw9Ik91dHB1dCBNZXNzYWdlIikKICAgICAgICAgICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbCA9IGkxOG4oIkVuc2VtYmxl5qih5byPIikpOgogICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKHZhbHVlID0gaTE4bigi5Y+v55So5LqO6ZuG5oiQ5LiN5ZCM566X5rOV55qE57uT5p6c44CC5YW35L2T55qE5paH5qGj5L2N5LqOL2RvY3MvZW5zZW1ibGUubWQiKSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICBmaWxlcyA9IGdyLkZpbGVzKGxhYmVsID0gaTE4bigi5LiK5Lyg5aSa5Liq6Z+z6aKR5paH5Lu2IiksIHR5cGUgPSAiZmlsZXBhdGgiLCBmaWxlX2NvdW50ID0gJ211bHRpcGxlJykKICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Db2x1bW4oKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5zZW1ibGVfdHlwZSA9IGdyLkRyb3Bkb3duKGNob2ljZXMgPSBbImF2Z193YXZlIiwgIm1lZGlhbl93YXZlIiwgIm1pbl93YXZlIiwgIm1heF93YXZlIiwgImF2Z19mZnQiLCAibWVkaWFuX2ZmdCIsICJtaW5fZmZ0IiwgIm1heF9mZnQiXSxsYWJlbCA9IGkxOG4oIumbhuaIkOaooeW8jyIpLHZhbHVlID0gd2VidWlfY29uZmlnWyd0b29scyddWydlbnNlbWJsZV90eXBlJ10gaWYgd2VidWlfY29uZmlnWyd0b29scyddWydlbnNlbWJsZV90eXBlJ10gZWxzZSAiYXZnX3dhdmUiLGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0cyA9IGdyLlRleHRib3gobGFiZWwgPSBpMThuKCLmnYPph40o5Lul56m65qC85YiG6ZqULCDmlbDph4/opoHkuI7kuIrkvKDnmoTpn7PpopHkuIDoh7QpIiksIHZhbHVlID0gIjEgMSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnNlbWJsX291dHB1dF9wYXRoID0gZ3IuVGV4dGJveChsYWJlbCA9IGkxOG4oIui+k+WHuuebruW9lSIpLCB2YWx1ZSA9IHdlYnVpX2NvbmZpZ1sndG9vbHMnXVsnZW5zZW1ibGVfb3V0cHV0X2ZvbGRlciddIGlmIHdlYnVpX2NvbmZpZ1sndG9vbHMnXVsnZW5zZW1ibGVfb3V0cHV0X2ZvbGRlciddIGVsc2UgInJlc3VsdHMvZW5zZW1ibGUvIixpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RfZW5zZW1ibF9vdXRwdXRfcGF0aCA9IGdyLkJ1dHRvbihpMThuKCLpgInmi6nmlofku7blpLkiKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVuX2Vuc2VtYmxfb3V0cHV0X3BhdGggPSBnci5CdXR0b24oaTE4bigi5omT5byA5paH5Lu25aS5IikpCiAgICAgICAgICAgICAgICAgICAgZW5zZW1ibGVfYnV0dG9uID0gZ3IuQnV0dG9uKGkxOG4oIui/kOihjCIpLCB2YXJpYW50ID0gInByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgIG91dHB1dF9tZXNzYWdlX2Vuc2VtYmxlID0gZ3IuVGV4dGJveChsYWJlbCA9ICJPdXRwdXQgTWVzc2FnZSIpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Db2x1bW4oKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIiMjIyDpm4bmiJDmqKHlvI8iKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIjEuIGBhdmdfd2F2ZWA6IOWcqDFE5Y+Y5L2T5LiK6L+b6KGM6ZuG5oiQLCDni6znq4vlnLDmib7liLDms6LlvaLnmoTmr4/kuKrmoLfmnKznmoTlubPlnYflgLw8YnI+Mi4gYG1lZGlhbl93YXZlYDog5ZyoMUTlj5jkvZPkuIrov5vooYzpm4bmiJAsIOeLrOeri+WcsOaJvuWIsOazouW9oueahOavj+S4quagt+acrOeahOS4reS9jeaVsDxicj4zLiBgbWluX3dhdmVgOiDlnKgxROWPmOS9k+S4iui/m+ihjOmbhuaIkCwg54us56uL5Zyw5om+5Yiw5rOi5b2i55qE5q+P5Liq5qC35pys55qE5pyA5bCP57ud5a+55YC8PGJyPjQuIGBtYXhfd2F2ZWA6IOWcqDFE5Y+Y5L2T5LiK6L+b6KGM6ZuG5oiQLCDni6znq4vlnLDmib7liLDms6LlvaLnmoTmr4/kuKrmoLfmnKznmoTmnIDlpKfnu53lr7nlgLw8YnI+NS4gYGF2Z19mZnRgOiDlnKjpopHosLHlm74gKOefreaXtuWChemHjOWPtuWPmOaNoiAoU1RGVCkgMkTlj5jkvZMpIOS4iui/m+ihjOmbhuaIkCwg54us56uL5Zyw5om+5Yiw6aKR6LCx5Zu+55qE5q+P5Liq5YOP57Sg55qE5bmz5Z2H5YC844CC5bmz5Z2H5ZCO5L2/55So6YCGU1RGVOW+l+WIsOWOn+Wni+eahDFE5rOi5b2iPGJyPjYuIGBtZWRpYW5fZmZ0YDog5LiOYXZnX2ZmdOebuOWQjCwg5L2G5L2/55So5Lit5L2N5pWw5Luj5pu/5bmz5Z2H5YC8ICjku4XlnKjpm4bmiJAz5Liq5oiW5pu05aSa5p2l5rqQ5pe25pyJ55SoKSA8YnI+Ny4gYG1pbl9mZnRgOiDkuI5hdmdfZmZ055u45ZCMLCDkvYbkvb/nlKjmnIDlsI/lh73mlbDku6Pmm7/lubPlnYflgLwgKOWHj+Wwkea/gOi/m+eoi+W6pikgPGJyPjguIGBtYXhfZmZ0YDog5LiOYXZnX2ZmdOebuOWQjCwg5L2G5L2/55So5pyA5aSn5Ye95pWw5Luj5pu/5bmz5Z2H5YC8ICjlop7liqDmv4Dov5vnqIvluqYpICIpKQogICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLkNvbHVtbigpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigiIyMjIOazqOaEj+S6i+mhuSIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigiMS4gbWluX2ZmdOWPr+eUqOS6jui/m+ihjOabtOS/neWuiOeahOWQiOaIkCwg5a6D5bCG5YeP5bCR5pu05r+A6L+b5qih5Z6L55qE5b2x5ZON44CCPGJyPjIuIOacgOWlveWQiOaIkOetiei0qOmHj+eahOaooeWei+OAguWcqOi/meenjeaDheWGteS4iywg5a6D5bCG5bim5p2l5aKe55uK44CC5aaC5p6c5YW25Lit5LiA5Liq5qih5Z6L6LSo6YeP5LiN5aW9LCDlroPlsIbpmY3kvY7mlbTkvZPotKjph4/jgII8YnI+My4g5Zyo5Y6f5LuT5bqT5L2c6ICF55qE5a6e6aqM5LitLCDkuI7lhbbku5bmlrnms5Xnm7jmr5QsIGF2Z193YXZl5ZyoU0RS5YiG5pWw5LiK5oC75piv5pu05aW95oiW55u4562J44CCPGJyPjQuIOS4iuS8oOeahOaWh+S7tuWQjSoq5LiN6IO95YyF5ZCr56m65qC8KiosIOacgOe7iOS8muWcqOi+k+WHuuebruW9leS4i+eUn+aIkOS4gOS4qmBlbnNlbWJsZV886ZuG5oiQ5qih5byPPi53YXZg44CCIikpCiAgICAgICAgICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigi5q2M5aOw6L2sTUlESSIpKToKICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLmrYzlo7DovaxNSURJ5Yqf6IO95L2/55So5byA5rqQ6aG555uuW1NPTUVdKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVudnBpL1NPTUUvKSwg5Y+v5Lul5bCG5YiG56a75b6X5Yiw55qEKirlubLlh4DnmoTmrYzlo7AqKui9rOaNouaIkC5taWTmlofku7bjgII8YnI+44CQ5b+F6aG744CR6Iul5oOz6KaB5L2/55So5q2k5Yqf6IO9LCDor7flhYjkuIvovb3mnYPph43mlofku7ZbbW9kZWxfc3RlcHNfNjQwMDBfc2ltcGxpZmllZC5ja3B0XShodHRwczovL2hmLW1pcnJvci5jb20vU3VjaWFsL1NPTUVfTW9kZWxzL3Jlc29sdmUvbWFpbi9tb2RlbF9zdGVwc182NDAwMF9zaW1wbGlmaWVkLmNrcHQp5bm25bCG5YW25pS+572u5Zyo56iL5bqP55uu5b2V5LiL55qEYHRvb2xzL1NPTUVfd2VpZ2h0c2Dmlofku7blpLnlhoXjgILmlofku7blkb3lkI3kuI3lj6/pmo/mhI/mm7TmlLkhIDxicj7jgJDph43opoHjgJHlj6rog73kuIrkvKB3YXbmoLzlvI/nmoTpn7PpopEhICIpKQogICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKHZhbHVlPWkxOG4oIuWmguaenOS4jeefpemBk+WmguS9lea1i+mHj+atjOabskJQTSwg5Y+v5Lul5bCd6K+V6L+Z5Lik5Liq5Zyo57q/5rWL6YeP5bel5YW3OiBbYnBtZGV0ZWN0b3JdKGh0dHBzOi8vYnBtZGV0ZWN0b3Iua25pZmZlbi5kZXYvKSB8IFtrZXktYnBtLWZpbmRlcl0oaHR0cHM6Ly92b2NhbHJlbW92ZXIub3JnL3poL2tleS1icG0tZmluZGVyKSwg5rWL6YeP5pe25bu66K6u5LiK5Lyg5Y6f5puy5oiW5Ly05aWPLCDoi6XlubLlo7Dlj6/og73lr7zoh7TmtYvph4/nu5PmnpzkuI3lh4bnoa7jgIIiKSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICBzb21lX2lucHV0X2F1ZGlvID0gZ3IuRmlsZShsYWJlbD1pMThuKCLkuIrkvKB3YXbmoLzlvI/pn7PpopEiKSwgdHlwZT0iZmlsZXBhdGgiKQogICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLkNvbHVtbigpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXVkaW9fYnBtID0gZ3IuTnVtYmVyKGxhYmVsPWkxOG4oIui+k+WFpemfs+mikUJQTSIpLCB2YWx1ZT0xMjAsIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb21lX291dHB1dF9mb2xkZXIgPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIui+k+WHuuebruW9lSIpLHZhbHVlPXdlYnVpX2NvbmZpZ1sndG9vbHMnXVsnc29tZV9vdXRwdXRfZm9sZGVyJ10gaWYgd2VidWlfY29uZmlnWyd0b29scyddWydzb21lX291dHB1dF9mb2xkZXInXSBlbHNlICJyZXN1bHRzL3NvbWUvIixpbnRlcmFjdGl2ZT1UcnVlLHNjYWxlPTMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdF9zb21lX291dHB1dF9kaXIgPSBnci5CdXR0b24oaTE4bigi6YCJ5oup5paH5Lu25aS5IikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Blbl9zb21lX291dHB1dF9kaXIgPSBnci5CdXR0b24oaTE4bigi5omT5byA5paH5Lu25aS5IikpCiAgICAgICAgICAgICAgICAgICAgc29tZV9idXR0b24gPSBnci5CdXR0b24oaTE4bigi5byA5aeL6L2s5o2iIiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgIG91dHB1dF9tZXNzYWdlX3NvbWUgPSBnci5UZXh0Ym94KGxhYmVsPSJPdXRwdXQgTWVzc2FnZSIpCiAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigiIyMjIOazqOaEj+S6i+mhuSIpKQogICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIjEuIOmfs+mikUJQTSAo5q+P5YiG6ZKf6IqC5ouN5pWwKSDlj6/ku6XpgJrov4dNaXhNZWlzdGVyIEJQTSBBbmFseXplcuetiei9r+S7tua1i+mHj+iOt+WPluOAgjxicj4yLiDkuLrkv53or4FNSURJ5o+Q5Y+W6LSo6YePLCDpn7PpopHmlofku7bor7fph4fnlKjlubLlh4DmuIXmmbDml6Dmt7flk43lupXlmarkurrlo7DjgII8YnI+My4g6L6T5Ye6TUlESeS4jeW4puatjOivjeS/oeaBrywg6ZyA6KaB55So5oi36Ieq6KGM5re75Yqg5q2M6K+N44CCPGJyPjQuIOWunumZheS9v+eUqOS9k+mqjOS4remDqOWIhumfs+espuS8muWHuueOsOaWreW8gOeahOeOsOixoSwg6ZyA6Ieq6KGM5L+u5q2j44CCU09NReeahOaooeWei+S4u+imgemdouWQkURpZmZTaW5nZXLllLHms5XmqKHlnovoh6rliqjmoIfms6gsIOavlOato+W4uOeUqOaIt+WcqOWIm+S9nOS4remcgOimgeeahE1JREnmm7TliqDnsr7nu4YsIOWboOiAjOWPr+iDveWvvOiHtOaooeWei+WAvuWQkeS6juWvuemfs+espui/m+ihjOWIh+WIhuOAgjxicj41LiDmj5Dlj5bnmoRNSURJ5rKh5pyJ6YeP5YyWL+ayoeacieWvuem9kOiKguaLjS/kuI3pgILphY1CUE0sIOmcgOiHquihjOWIsOWQhOe8lui+keWZqOS4reaJi+WKqOiwg+aVtOOAgiIpKQoKICAgICAgICAgICAgY29udmVydF9hdWRpb19idXR0b24uY2xpY2soZm49Y29udmVydF9hdWRpbywgaW5wdXRzPVtpbnB1dHMsIGZmbXBlZ19vdXRwdXRfZm9ybWF0LCBmZm1wZWdfb3V0cHV0X2ZvbGRlcl0sIG91dHB1dHM9b3V0cHV0X21lc3NhZ2VfZmZtcGVnKQogICAgICAgICAgICBzZWxlY3RfZmZtcGVnX291dHB1dF9kaXIuY2xpY2soZm49c2VsZWN0X2ZvbGRlciwgb3V0cHV0cz1mZm1wZWdfb3V0cHV0X2ZvbGRlcikKICAgICAgICAgICAgb3Blbl9mZm1wZWdfb3V0cHV0X2Rpci5jbGljayhmbj1vcGVuX2ZvbGRlciwgaW5wdXRzPWZmbXBlZ19vdXRwdXRfZm9sZGVyKQogICAgICAgICAgICBtZXJnZV9hdWRpb19idXR0b24uY2xpY2sobWVyZ2VfYXVkaW9zLCBbbWVyZ2VfYXVkaW9faW5wdXQsIG1lcmdlX2F1ZGlvX291dHB1dF0sIG91dHB1dHM9b3V0cHV0X21lc3NhZ2VfbWVyZ2UpCiAgICAgICAgICAgIHNlbGVjdF9tZXJnZV9pbnB1dF9kaXIuY2xpY2soZm49c2VsZWN0X2ZvbGRlciwgb3V0cHV0cz1tZXJnZV9hdWRpb19pbnB1dCkKICAgICAgICAgICAgb3Blbl9tZXJnZV9pbnB1dF9kaXIuY2xpY2soZm49b3Blbl9mb2xkZXIsIGlucHV0cz1tZXJnZV9hdWRpb19pbnB1dCkKICAgICAgICAgICAgc2VsZWN0X21lcmdlX291dHB1dF9kaXIuY2xpY2soZm49c2VsZWN0X2ZvbGRlciwgb3V0cHV0cz1tZXJnZV9hdWRpb19vdXRwdXQpCiAgICAgICAgICAgIG9wZW5fbWVyZ2Vfb3V0cHV0X2Rpci5jbGljayhmbj1vcGVuX2ZvbGRlciwgaW5wdXRzPW1lcmdlX2F1ZGlvX291dHB1dCkKICAgICAgICAgICAgY29tcHV0ZV9zZHJfYnV0dG9uLmNsaWNrKHByb2Nlc3NfYXVkaW8sIFt0cnVlX2F1ZGlvLCBlc3RpbWF0ZWRfYXVkaW9dLCBvdXRwdXRzPW91dHB1dF9tZXNzYWdlX3NkcikKICAgICAgICAgICAgZW5zZW1ibGVfYnV0dG9uLmNsaWNrKGZuID0gZW5zZW1ibGUsIGlucHV0cyA9IFtmaWxlcywgZW5zZW1ibGVfdHlwZSwgd2VpZ2h0cywgZW5zZW1ibF9vdXRwdXRfcGF0aF0sb3V0cHV0cyA9IG91dHB1dF9tZXNzYWdlX2Vuc2VtYmxlKQogICAgICAgICAgICBzZWxlY3RfZW5zZW1ibF9vdXRwdXRfcGF0aC5jbGljayhmbiA9IHNlbGVjdF9mb2xkZXIsIG91dHB1dHMgPSBlbnNlbWJsX291dHB1dF9wYXRoKQogICAgICAgICAgICBvcGVuX2Vuc2VtYmxfb3V0cHV0X3BhdGguY2xpY2soZm4gPSBvcGVuX2ZvbGRlciwgaW5wdXRzID0gZW5zZW1ibF9vdXRwdXRfcGF0aCkKICAgICAgICAgICAgc2VsZWN0X3NvbWVfb3V0cHV0X2Rpci5jbGljayhmbj1zZWxlY3RfZm9sZGVyLCBvdXRwdXRzPXNvbWVfb3V0cHV0X2ZvbGRlcikKICAgICAgICAgICAgb3Blbl9zb21lX291dHB1dF9kaXIuY2xpY2soZm49b3Blbl9mb2xkZXIsIGlucHV0cz1zb21lX291dHB1dF9mb2xkZXIpCiAgICAgICAgICAgIHNvbWVfYnV0dG9uLmNsaWNrKGZuPXNvbWVfaW5mZXJlbmNlLGlucHV0cz1bc29tZV9pbnB1dF9hdWRpbywgYXVkaW9fYnBtLCBzb21lX291dHB1dF9mb2xkZXJdLG91dHB1dHM9b3V0cHV0X21lc3NhZ2Vfc29tZSkKCiAgICAgICAgd2l0aCBnci5UYWJJdGVtKGxhYmVsPWkxOG4oIuWuieijheaooeWeiyIpKToKICAgICAgICAgICAgd2l0aCBnci5UYWJzKCk6CiAgICAgICAgICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigi5LiL6L295a6Y5pa55qih5Z6LIikpOgogICAgICAgICAgICAgICAgICAgIHV2cl9tb2RlbF9mb2xkZXIgPSB3ZWJ1aV9jb25maWdbJ3NldHRpbmdzJ11bJ3V2cl9tb2RlbF9kaXInXQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuQ29sdW1uKHNjYWxlPTMpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24odmFsdWU9aTE4bigi6Iul6Ieq5Yqo5LiL6L295Ye6546w5oql6ZSZ5oiW5LiL6L296L+H5oWiLCDor7fngrnlh7vmiYvliqjkuIvovb0sIOi3s+i9rOiHs+S4i+i9vemTvuaOpeOAguaJi+WKqOS4i+i9veWujOaIkOWQjiwg6K+35qC55o2u5L2g6YCJ5oup55qE5qih5Z6L57G75Z6L5pS+572u5Yiw5a+55bqU5paH5Lu25aS55YaF44CCIikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCIjIyMg5b2T5YmNVVZS5qih5Z6L55uu5b2VOiAiKSArIGYiYHt1dnJfbW9kZWxfZm9sZGVyfWAiICsgaTE4bigiLCDlpoLpnIDmm7TmlLksIOivt+WJjeW+gOiuvue9rumhtemdouOAgiIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbF90eXBlX2Ryb3Bkb3duID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5qih5Z6L57G75Z6LIiksIGNob2ljZXM9TU9ERUxfQ0hPSUNFUywgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZF9tb2RlbF9uYW1lX2Ryb3Bkb3duID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5qih5Z6LIiksIGNob2ljZXM9W2kxOG4oIuivt+WFiOmAieaLqeaooeWei+exu+WeiyIpXSwgc2NhbGU9MykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Blbl9tb2RlbF9kaXIgPSBnci5CdXR0b24oaTE4bigi5omT5byATVNTVOaooeWei+ebruW9lSIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5fdXZyX21vZGVsX2RpciA9IGdyLkJ1dHRvbihpMThuKCLmiZPlvIBVVlLmqKHlnovnm67lvZUiKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRfYnV0dG9uID0gZ3IuQnV0dG9uKGkxOG4oIuiHquWKqOS4i+i9vSIpLCB2YXJpYW50PSJwcmltYXJ5IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW51YWxfZG93bmxvYWRfYnV0dG9uID0gZ3IuQnV0dG9uKGkxOG4oIuaJi+WKqOS4i+i9vSIpLCB2YXJpYW50PSJwcmltYXJ5IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dF9tZXNzYWdlX2Rvd25sb2FkID0gZ3IuVGV4dGJveChsYWJlbD0iT3V0cHV0IE1lc3NhZ2UiKQogICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLkNvbHVtbihzY2FsZT0xKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIiMjIyDms6jmhI/kuovpobkiKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKHZhbHVlPWkxOG4oIjEuIE1TU1TmqKHlnovpu5jorqTkuIvovb3lnKhwcmV0cmFpbi885qih5Z6L57G75Z6LPuaWh+S7tuWkueS4i+OAglVWUuaooeWei+m7mOiupOS4i+i9veWcqOiuvue9ruS4reeahFVWUuaooeWei+ebruW9leS4reOAgjxicj4yLiDkuIvliqDovb3ov5vluqblj6/ku6XmiZPlvIDnu4jnq6/mn6XnnIvjgILlpoLmnpzkuIDnm7TljaHnnYDkuI3liqjmiJbogIXpgJ/luqblvojmhaIsIOWcqOehruS/oee9kee7nOato+W4uOeahOaDheWGteS4i+ivt+WwneivlemHjeWQr1dlYlVJ44CCPGJyPjMuIOiLpeS4i+i9veWksei0pSwg5Lya5Zyo5qih5Z6L55uu5b2VKirnlZnkuIvkuIDkuKrmjZ/lnY/nmoTmqKHlnosqKiwg6K+3KirliqHlv4UqKuaJk+W8gOaooeWei+ebruW9leaJi+WKqOWIoOmZpCEgPGJyPjQuIOeCueWHu+KAnOmHjeWQr1dlYlVJ4oCd5oyJ6ZKu5ZCOLCDkvJrnn63mmoLmgKfnmoTlpLHljrvov57mjqUsIOmaj+WQjuS8muiHquWKqOW8gOWQr+S4gOS4quaWsOe9kemhteOAgiIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigiIyMjIOaooeWei+S4i+i9vemTvuaOpSIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigiMS4g6Ieq5Yqo5LuOR2l0aHViLCBIdWdnaW5nZmFjZeaIlumVnOWDj+ermeS4i+i9veaooeWei+OAgjxicj4yLiDkvaDkuZ/lj6/ku6XlnKjmraTmlbTlkIjljIXkuIvovb3pk77mjqXkuK3nmoRBbGxfTW9kZWxz5paH5Lu25aS55Lit5om+5Yiw5omA5pyJ5Y+v55So55qE5qih5Z6L5bm25LiL6L2944CCIikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCIjIyMg5qih5Z6L5a6J6KOF5a6M5oiQ5ZCOLCDpnIDph43lkK9XZWJVSeWIt+aWsOaooeWei+WIl+ihqCIpKQogICAgICAgICAgICAgICAgd2l0aCBnci5UYWJJdGVtKGxhYmVsPWkxOG4oIuWuieijhemdnuWumOaWuU1TU1TmqKHlnosiKSk6CiAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24odmFsdWU9aTE4bigi5L2g5Y+v5Lul5LuO5YW25LuW6YCU5b6E6I635Y+W6Z2e5a6Y5pa5TVNTVOaooeWeiywg5Zyo5q2k6aG16Z2i5a6M5oiQ6YWN572u5paH5Lu26K6+572u5ZCOLCDljbPlj6/mraPluLjkvb/nlKjjgII8YnI+5rOo5oSPOiDku4XmlK/mjIEnLmNrcHQnLCAnLnRoJywgJy5jaHB0J+agvOW8j+eahOaooeWei+OAguaooeWei+aYvuekuuWQjeWtl+S4uuaooeWei+aWh+S7tuWQjeOAgjxicj7pgInmi6nmqKHlnovnsbvlnos6IOWFseacieS4ieS4quWPr+mAiemhueOAguS+neasoeS7o+ihqOS6uuWjsOebuOWFs+aooeWeiywg5aSa6Z+z6L2o5YiG56a75qih5Z6LLCDljZXpn7PovajliIbnprvmqKHlnovjgILku4XnlKjkuo7ljLrliIbmqKHlnovlpKfoh7TnsbvlnossIOWPr+S7u+aEj+mAieaLqeOAgjxicj7pgInmi6nmqKHlnovnsbvliKs6IOatpOmAiemhueWFs+ezu+WIsOaooeWei+aYr+WQpuiDveato+W4uOaOqOeQhuS9v+eUqCwg5b+F6aG75YeG56Gu6YCJ5oupISIpKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHVubXNzdF9tb2RlbCA9IGdyLkZpbGUobGFiZWw9aTE4bigi5LiK5Lyg6Z2e5a6Y5pa5TVNTVOaooeWeiyIpLCB0eXBlPSJmaWxlcGF0aCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVubXNzdF9jb25maWcgPSBnci5GaWxlKGxhYmVsPWkxOG4oIuS4iuS8oOmdnuWumOaWuU1TU1TmqKHlnovphY3nva7mlofku7YiKSwgdHlwZT0iZmlsZXBhdGgiKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHVubW9kZWxfY2xhc3MgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6nmqKHlnovnsbvlnosiKSwgY2hvaWNlcz1bInZvY2FsX21vZGVscyIsICJtdWx0aV9zdGVtX21vZGVscyIsICJzaW5nbGVfc3RlbV9tb2RlbHMiXSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgdW5tb2RlbF90eXBlID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5qih5Z6L57G75YirIiksIGNob2ljZXM9TU9ERUxfVFlQRSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgdW5tc3N0X21vZGVsX2xpbmsgPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIuaooeWei+S4i+i9vemTvuaOpSAo6Z2e5b+F6aG777yM6Iul5peg77yM5Y+v6Lez6L+HKSIpLCB2YWx1ZT0iIiwgaW50ZXJhY3RpdmU9VHJ1ZSwgc2NhbGU9MikKICAgICAgICAgICAgICAgICAgICB1bm1zc3RfbW9kZWxfaW5zdGFsbCA9IGdyLkJ1dHRvbihpMThuKCLlronoo4XpnZ7lrpjmlrlNU1NU5qih5Z6LIiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgIG91dHB1dF9tZXNzYWdlX3VubXNzdCA9IGdyLlRleHRib3gobGFiZWw9Ik91dHB1dCBNZXNzYWdlIikKICAgICAgICAgICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbD1pMThuKCLlronoo4XpnZ7lrpjmlrlWUuaooeWeiyIpKToKICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLkvaDlj6/ku6Xku47lhbbku5bpgJTlvoTojrflj5bpnZ7lrpjmlrlVVlLmqKHlnossIOWcqOatpOmhtemdouWujOaIkOmFjee9ruaWh+S7tuiuvue9ruWQjiwg5Y2z5Y+v5q2j5bi45L2/55So44CCPGJyPuazqOaEjzog5LuF5pSv5oyBJy5wdGgn5qC85byP55qE5qih5Z6L44CC5qih5Z6L5pi+56S65ZCN5a2X5Li65qih5Z6L5paH5Lu25ZCN44CCIikpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgdW52cl9tb2RlbCA9IGdyLkZpbGUobGFiZWw9aTE4bigi5LiK5Lyg6Z2e5a6Y5pa5VlLmqKHlnosiKSwgdHlwZT0iZmlsZXBhdGgiKQogICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLkNvbHVtbigpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnZyX3ByaW1hcnlfc3RlbSA9IGdyLlRleHRib3gobGFiZWw9aTE4bigi5Li76KaB6Z+z6L2o5ZCN56ewIiksIHZhbHVlPSIiLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVudnJfc2Vjb25kYXJ5X3N0ZW0gPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIuasoeimgemfs+i9qOWQjeensCIpLCB2YWx1ZT0iIiwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsX3BhcmFtID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5qih5Z6L5Y+C5pWwIiksIGNob2ljZXM9Z2V0X2FsbF9tb2RlbF9wYXJhbSgpLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc19rYXJhb2tlX21vZGVsID0gZ3IuQ2hlY2tib3gobGFiZWw9aTE4bigi5piv5ZCm5Li6S2FyYW9rZeaooeWeiyIpLCB2YWx1ZT1GYWxzZSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc19CVl9tb2RlbCA9IGdyLkNoZWNrYm94KGxhYmVsPWkxOG4oIuaYr+WQpuS4ukJW5qih5Z6LIiksIHZhbHVlPUZhbHNlLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX1ZSNTFfbW9kZWwgPSBnci5DaGVja2JveChsYWJlbD1pMThuKCLmmK/lkKbkuLpWUiA1LjHmqKHlnosiKSwgdmFsdWU9RmFsc2UsIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgYmFsYW5jZV92YWx1ZSA9IGdyLk51bWJlcihsYWJlbD0iYmFsYW5jZV92YWx1ZSIsIHZhbHVlPTAuMCwgbWluaW11bT0wLjAsIG1heGltdW09MC45LCBzdGVwPTAuMSwgaW50ZXJhY3RpdmU9VHJ1ZSwgdmlzaWJsZT1GYWxzZSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICBvdXRfY2hhbm5lbHMgPSBnci5OdW1iZXIobGFiZWw9Ik91dCBDaGFubmVscyIsIHZhbHVlPTMyLCBtaW5pbXVtPTEsIHN0ZXA9MSwgaW50ZXJhY3RpdmU9VHJ1ZSwgdmlzaWJsZT1GYWxzZSkKICAgICAgICAgICAgICAgICAgICAgICAgb3V0X2NoYW5uZWxzX2xzdG0gPSBnci5OdW1iZXIobGFiZWw9Ik91dCBDaGFubmVscyAoTFNUTSBsYXllcikiLCB2YWx1ZT0xMjgsIG1pbmltdW09MSwgc3RlcD0xLCBpbnRlcmFjdGl2ZT1UcnVlLCB2aXNpYmxlPUZhbHNlKQogICAgICAgICAgICAgICAgICAgIHVwbG9hZF9wYXJhbSA9IGdyLkZpbGUobGFiZWw9aTE4bigi5LiK5Lyg5Y+C5pWw5paH5Lu2IiksIHR5cGU9ImZpbGVwYXRoIiwgaW50ZXJhY3RpdmU9VHJ1ZSwgdmlzaWJsZT1GYWxzZSkKICAgICAgICAgICAgICAgICAgICB1bnZyX21vZGVsX2xpbmsgPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIuaooeWei+S4i+i9vemTvuaOpSAo6Z2e5b+F6aG777yM6Iul5peg77yM5Y+v6Lez6L+HKSIpLCB2YWx1ZT0iIiwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICB1bnZyX21vZGVsX2luc3RhbGwgPSBnci5CdXR0b24oaTE4bigi5a6J6KOF6Z2e5a6Y5pa5VlLmqKHlnosiKSwgdmFyaWFudD0icHJpbWFyeSIpCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0X21lc3NhZ2VfdW52ciA9IGdyLlRleHRib3gobGFiZWw9Ik91dHB1dCBNZXNzYWdlIikKICAgICAgICAgICAgcmVzdGFydF93ZWJ1aSA9IGdyLkJ1dHRvbihpMThuKCLph43lkK9XZWJVSSIpLCB2YXJpYW50PSJwcmltYXJ5IikKCiAgICAgICAgICAgIG1vZGVsX3R5cGVfZHJvcGRvd24uY2hhbmdlKGZuPXVwZ3JhZGVfZG93bmxvYWRfbW9kZWxfbmFtZSxpbnB1dHM9W21vZGVsX3R5cGVfZHJvcGRvd25dLG91dHB1dHM9W2Rvd25sb2FkX21vZGVsX25hbWVfZHJvcGRvd25dKQogICAgICAgICAgICBkb3dubG9hZF9idXR0b24uY2xpY2soZm49ZG93bmxvYWRfbW9kZWwsaW5wdXRzPVttb2RlbF90eXBlX2Ryb3Bkb3duLCBkb3dubG9hZF9tb2RlbF9uYW1lX2Ryb3Bkb3duXSxvdXRwdXRzPW91dHB1dF9tZXNzYWdlX2Rvd25sb2FkKQogICAgICAgICAgICBtYW51YWxfZG93bmxvYWRfYnV0dG9uLmNsaWNrKGZuPW1hbnVhbF9kb3dubG9hZF9tb2RlbCxpbnB1dHM9W21vZGVsX3R5cGVfZHJvcGRvd24sIGRvd25sb2FkX21vZGVsX25hbWVfZHJvcGRvd25dLG91dHB1dHM9b3V0cHV0X21lc3NhZ2VfZG93bmxvYWQpCiAgICAgICAgICAgIG9wZW5fbW9kZWxfZGlyLmNsaWNrKG9wZW5fZm9sZGVyLCBpbnB1dHM9Z3IuVGV4dGJveChNT0RFTF9GT0xERVIsIHZpc2libGU9RmFsc2UpKQogICAgICAgICAgICBvcGVuX3V2cl9tb2RlbF9kaXIuY2xpY2sob3Blbl9mb2xkZXIsIGlucHV0cz1nci5UZXh0Ym94KHV2cl9tb2RlbF9mb2xkZXIsIHZpc2libGU9RmFsc2UpKQogICAgICAgICAgICByZXN0YXJ0X3dlYnVpLmNsaWNrKHdlYnVpX3Jlc3RhcnQpCiAgICAgICAgICAgIGlzX0JWX21vZGVsLmNoYW5nZShmbj11cGRhdGVfdnJfcGFyYW0sIGlucHV0cz1baXNfQlZfbW9kZWwsIGlzX1ZSNTFfbW9kZWwsIG1vZGVsX3BhcmFtXSwgb3V0cHV0cz1bYmFsYW5jZV92YWx1ZSwgb3V0X2NoYW5uZWxzLCBvdXRfY2hhbm5lbHNfbHN0bSwgdXBsb2FkX3BhcmFtXSkKICAgICAgICAgICAgaXNfVlI1MV9tb2RlbC5jaGFuZ2UoZm49dXBkYXRlX3ZyX3BhcmFtLCBpbnB1dHM9W2lzX0JWX21vZGVsLCBpc19WUjUxX21vZGVsLCBtb2RlbF9wYXJhbV0sIG91dHB1dHM9W2JhbGFuY2VfdmFsdWUsIG91dF9jaGFubmVscywgb3V0X2NoYW5uZWxzX2xzdG0sIHVwbG9hZF9wYXJhbV0pCiAgICAgICAgICAgIG1vZGVsX3BhcmFtLmNoYW5nZShmbj11cGRhdGVfdnJfcGFyYW0sIGlucHV0cz1baXNfQlZfbW9kZWwsIGlzX1ZSNTFfbW9kZWwsIG1vZGVsX3BhcmFtXSwgb3V0cHV0cz1bYmFsYW5jZV92YWx1ZSwgb3V0X2NoYW5uZWxzLCBvdXRfY2hhbm5lbHNfbHN0bSwgdXBsb2FkX3BhcmFtXSkKICAgICAgICAgICAgdW5tc3N0X21vZGVsX2luc3RhbGwuY2xpY2soZm49aW5zdGFsbF91bm1zc3RfbW9kZWwsIGlucHV0cz1bdW5tc3N0X21vZGVsLCB1bm1zc3RfY29uZmlnLCB1bm1vZGVsX2NsYXNzLCB1bm1vZGVsX3R5cGUsIHVubXNzdF9tb2RlbF9saW5rXSwgb3V0cHV0cz1vdXRwdXRfbWVzc2FnZV91bm1zc3QpCiAgICAgICAgICAgIHVudnJfbW9kZWxfaW5zdGFsbC5jbGljayhmbj1pbnN0YWxsX3VudnJfbW9kZWwsIGlucHV0cz1bdW52cl9tb2RlbCwgdW52cl9wcmltYXJ5X3N0ZW0sIHVudnJfc2Vjb25kYXJ5X3N0ZW0sIG1vZGVsX3BhcmFtLCBpc19rYXJhb2tlX21vZGVsLCBpc19CVl9tb2RlbCwgaXNfVlI1MV9tb2RlbCwgYmFsYW5jZV92YWx1ZSwgb3V0X2NoYW5uZWxzLCBvdXRfY2hhbm5lbHNfbHN0bSwgdXBsb2FkX3BhcmFtLCB1bnZyX21vZGVsX2xpbmtdLCBvdXRwdXRzPW91dHB1dF9tZXNzYWdlX3VudnIpCgogICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbD1pMThuKCJNU1NU6K6t57uDIikpOgogICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLmraTpobXpnaLmj5DkvpvmlbDmja7pm4bliLbkvZzmlZnnqIssIOiuree7g+WPguaVsOmAieaLqSwg5Lul5Y+K5LiA6ZSu6K6t57uD44CC5pyJ5YWz6YWN572u5paH5Lu255qE5L+u5pS55ZKM5pWw5o2u6ZuG5paH5Lu25aS555qE6K+m57uG6K+05piO6K+35Y+C6ICDTVNTVOWOn+mhueebrjogW2h0dHBzOi8vZ2l0aHViLmNvbS9aRlR1cmJvL011c2ljLVNvdXJjZS1TZXBhcmF0aW9uLVRyYWluaW5nXShodHRwczovL2dpdGh1Yi5jb20vWkZUdXJiby9NdXNpYy1Tb3VyY2UtU2VwYXJhdGlvbi1UcmFpbmluZyk8YnI+5Zyo5byA5aeL5LiL5pa555qE5qih5Z6L6K6t57uD5LmL5YmNLCDor7flhYjov5vooYzorq3nu4PmlbDmja7nmoTliLbkvZzjgII8YnI+6K+05piOOiDmlbDmja7pm4bnsbvlnovljbPorq3nu4Ppm4bliLbkvZxTdGVwIDHkuK3kvaDpgInmi6nnmoTnsbvlnossIDE6IFR5cGUxOyAyOiBUeXBlMjsgMzogVHlwZTM7IDQ6IFR5cGU0LCDlv4XpobvkuI7kvaDnmoTmlbDmja7pm4bnsbvlnovnm7jljLnphY3jgIIiKSkKICAgICAgICAgICAgd2l0aCBnci5UYWJzKCk6CiAgICAgICAgICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigi6K6t57uDIikpOgogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWluX21vZGVsX3R5cGUgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6norq3nu4PmqKHlnovnsbvlnosiKSxjaG9pY2VzPU1PREVMX1RZUEUsdmFsdWU9d2VidWlfY29uZmlnWyd0cmFpbmluZyddWydtb2RlbF90eXBlJ10gaWYgd2VidWlfY29uZmlnWyd0cmFpbmluZyddWydtb2RlbF90eXBlJ10gZWxzZSBOb25lLGludGVyYWN0aXZlPVRydWUsc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICAgICAgdHJhaW5fY29uZmlnX3BhdGggPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIumFjee9ruaWh+S7tui3r+W+hCIpLHZhbHVlPXdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsnY29uZmlnX3BhdGgnXSBpZiB3ZWJ1aV9jb25maWdbJ3RyYWluaW5nJ11bJ2NvbmZpZ19wYXRoJ10gZWxzZSBpMThuKCLor7fovpPlhaXphY3nva7mlofku7bot6/lvoTmiJbpgInmi6nphY3nva7mlofku7YiKSxpbnRlcmFjdGl2ZT1UcnVlLHNjYWxlPTMpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdF90cmFpbl9jb25maWdfcGF0aCA9IGdyLkJ1dHRvbihpMThuKCLpgInmi6nphY3nva7mlofku7YiKSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICB0cmFpbl9kYXRhc2V0X3R5cGUgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLmlbDmja7pm4bnsbvlnosiKSxjaG9pY2VzPVsxLCAyLCAzLCA0XSx2YWx1ZT13ZWJ1aV9jb25maWdbJ3RyYWluaW5nJ11bJ2RhdGFzZXRfdHlwZSddIGlmIHdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsnZGF0YXNldF90eXBlJ10gZWxzZSBOb25lLGludGVyYWN0aXZlPVRydWUsc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICAgICAgdHJhaW5fZGF0YXNldF9wYXRoID0gZ3IuVGV4dGJveChsYWJlbD1pMThuKCLmlbDmja7pm4bot6/lvoQiKSx2YWx1ZT13ZWJ1aV9jb25maWdbJ3RyYWluaW5nJ11bJ2RhdGFzZXRfcGF0aCddIGlmIHdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsnZGF0YXNldF9wYXRoJ10gZWxzZSBpMThuKCLor7fovpPlhaXmiJbpgInmi6nmlbDmja7pm4bmlofku7blpLkiKSxpbnRlcmFjdGl2ZT1UcnVlLHNjYWxlPTMpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdF90cmFpbl9kYXRhc2V0X3BhdGggPSBnci5CdXR0b24oaTE4bigi6YCJ5oup5pWw5o2u6ZuG5paH5Lu25aS5IiksIHNjYWxlPTEpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgdHJhaW5fdmFsaWRfcGF0aCA9IGdyLlRleHRib3gobGFiZWw9aTE4bigi6aqM6K+B6ZuG6Lev5b6EIiksdmFsdWU9d2VidWlfY29uZmlnWyd0cmFpbmluZyddWyd2YWxpZF9wYXRoJ10gaWYgd2VidWlfY29uZmlnWyd0cmFpbmluZyddWyd2YWxpZF9wYXRoJ10gZWxzZSBpMThuKCLor7fovpPlhaXmiJbpgInmi6npqozor4Hpm4bmlofku7blpLkiKSxpbnRlcmFjdGl2ZT1UcnVlLHNjYWxlPTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdF90cmFpbl92YWxpZF9wYXRoID0gZ3IuQnV0dG9uKGkxOG4oIumAieaLqemqjOivgembhuaWh+S7tuWkuSIpLCBzY2FsZT0xKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWluX251bV93b3JrZXJzID0gZ3IuTnVtYmVyKGxhYmVsPWkxOG4oIm51bV93b3JrZXJzOiDmlbDmja7pm4bor7vlj5bnur/nqIvmlbAsIDDkuLroh6rliqgiKSx2YWx1ZT13ZWJ1aV9jb25maWdbJ3RyYWluaW5nJ11bJ251bV93b3JrZXJzJ10gaWYgd2VidWlfY29uZmlnWyd0cmFpbmluZyddWydudW1fd29ya2VycyddIGVsc2UgMCxpbnRlcmFjdGl2ZT1UcnVlLG1pbmltdW09MCxtYXhpbXVtPWNwdV9jb3VudCgpLHN0ZXA9MSkKICAgICAgICAgICAgICAgICAgICAgICAgdHJhaW5fZGV2aWNlX2lkcyA9IGdyLlRleHRib3gobGFiZWw9aTE4bigiZGV2aWNlX2lkczog6YCJ5oup5pi+5Y2hLCDlpJrljaHnlKjmiLfor7fkvb/nlKjnqbrmoLzliIbpmpQiKSx2YWx1ZT13ZWJ1aV9jb25maWdbJ3RyYWluaW5nJ11bJ2RldmljZV9pZHMnXSBpZiB3ZWJ1aV9jb25maWdbJ3RyYWluaW5nJ11bJ2RldmljZV9pZHMnXSBlbHNlICIwIixpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgICAgICB0cmFpbl9zZWVkID0gZ3IuTnVtYmVyKGxhYmVsPWkxOG4oIumaj+acuuaVsOenjeWtkCwgMOS4uumaj+acuiIpLCB2YWx1ZT0iMCIpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgdHJhaW5fcGluX21lbW9yeSA9IGdyLkNoZWNrYm94KGxhYmVsPWkxOG4oIuaYr+WQpuWwhuWKoOi9veeahOaVsOaNruaUvue9ruWcqOWbuuWumuWGheWtmOS4rSwg6buY6K6k5Li65ZCmIiksIHZhbHVlPXdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsncGluX21lbW9yeSddLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgICAgICB0cmFpbl9hY2NlbGVyYXRlID0gZ3IuQ2hlY2tib3gobGFiZWw9aTE4bigi5piv5ZCm5L2/55So5Yqg6YCf6K6t57uDLCDlr7nkuo7lpJrmmL7ljaHnlKjmiLfkvJrliqDlv6vorq3nu4MiKSwgdmFsdWU9d2VidWlfY29uZmlnWyd0cmFpbmluZyddWydhY2NlbGVyYXRlJ10sIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWluX3ByZV92YWxpZGF0ZSA9IGdyLkNoZWNrYm94KGxhYmVsPWkxOG4oIuaYr+WQpuWcqOiuree7g+WJjemqjOivgeaooeWeiywg5LuF5a+55Yqg6YCf6K6t57uD5pyJ5pWIIiksIHZhbHVlPXdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsncHJlX3ZhbGlkJ10sIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgdHJhaW5fdXNlX211bHRpc3RmdF9sb3NzID0gZ3IuQ2hlY2tib3gobGFiZWw9aTE4bigi5piv5ZCm5L2/55SoTXVsdGlTVEZUIExvc3MsIOm7mOiupOS4uuWQpiIpLCB2YWx1ZT13ZWJ1aV9jb25maWdbJ3RyYWluaW5nJ11bJ3VzZV9tdWx0aXN0ZnRfbG9zcyddLCBpbnRlcmFjdGl2ZT1UcnVlKQogICAgICAgICAgICAgICAgICAgICAgICB0cmFpbl91c2VfbXNlX2xvc3MgPSBnci5DaGVja2JveChsYWJlbD1pMThuKCLmmK/lkKbkvb/nlKhNU0UgbG9zcywg6buY6K6k5Li65ZCmIiksIHZhbHVlPXdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsndXNlX21zZV9sb3NzJ10sIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWluX3VzZV9sMV9sb3NzID0gZ3IuQ2hlY2tib3gobGFiZWw9aTE4bigi5piv5ZCm5L2/55SoTDEgbG9zcywg6buY6K6k5Li65ZCmIiksIHZhbHVlPXdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsndXNlX2wxX2xvc3MnXSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICB0cmFpbl9yZXN1bHRzX3BhdGggPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIuaooeWei+S/neWtmOi3r+W+hCIpLHZhbHVlPXdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsncmVzdWx0c19wYXRoJ10gaWYgd2VidWlfY29uZmlnWyd0cmFpbmluZyddWydyZXN1bHRzX3BhdGgnXSBlbHNlIGkxOG4oIuivt+i+k+WFpeaIlumAieaLqeaooeWei+S/neWtmOaWh+S7tuWkuSIpLGludGVyYWN0aXZlPVRydWUsc2NhbGU9MykKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0X3RyYWluX3Jlc3VsdHNfcGF0aCA9IGdyLkJ1dHRvbihpMThuKCLpgInmi6nmlofku7blpLkiKSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICAgICAgb3Blbl90cmFpbl9yZXN1bHRzX3BhdGggPSBnci5CdXR0b24oaTE4bigi5omT5byA5paH5Lu25aS5IiksIHNjYWxlPTEpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgdHJhaW5fc3RhcnRfY2hlY2tfcG9pbnQgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLliJ3lp4vmqKHlnos6IOe7p+e7reiuree7g+aIluW+ruiwg+aooeWei+iuree7g+aXtiwg6K+36YCJ5oup5Yid5aeL5qih5Z6LLCDlkKbliJnlsIbku47lpLTlvIDlp4vorq3nu4MhICIpLCBjaG9pY2VzPVsiTm9uZSJdLCB2YWx1ZT0iTm9uZSIsIGludGVyYWN0aXZlPVRydWUsIHNjYWxlPTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZmxlc2hfc3RhcnRfY2hlY2tfcG9pbnQgPSBnci5CdXR0b24oaTE4bigi5Yi35paw5Yid5aeL5qih5Z6L5YiX6KGoIiksIHNjYWxlPTEpCiAgICAgICAgICAgICAgICAgICAgc2F2ZV90cmFpbl9jb25maWcgPSBnci5CdXR0b24oaTE4bigi5L+d5a2Y5LiK6L+w6K6t57uD6YWN572uIikpCiAgICAgICAgICAgICAgICAgICAgc3RhcnRfdHJhaW5fYnV0dG9uID0gZ3IuQnV0dG9uKGkxOG4oIuW8gOWni+iuree7gyIpLCB2YXJpYW50PSJwcmltYXJ5IikKICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLngrnlh7vlvIDlp4vorq3nu4PlkI4sIOivt+WIsOe7iOerr+afpeeci+iuree7g+i/m+W6puaIluaKpemUmSwg5LiL5pa55LiN5Lya6L6T5Ye65oql6ZSZ5L+h5oGvLCDmg7PopoHlgZzmraLorq3nu4Plj6/ku6Xnm7TmjqXlhbPpl63nu4jnq6/jgILlnKjorq3nu4Pov4fnqIvkuK0sIOS9oOS5n+WPr+S7peWFs+mXree9kemhtSwg5LuFKirkv53nlZnnu4jnq68qKuOAgiIpKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dF9tZXNzYWdlX3RyYWluID0gZ3IuVGV4dGJveChsYWJlbD0iT3V0cHV0IE1lc3NhZ2UiLCBzY2FsZT00KQogICAgICAgICAgICAgICAgICAgICAgICBzdG9wX3RocmVhZCA9IGdyLkJ1dHRvbihpMThuKCLlvLrliLblgZzmraIiKSwgc2NhbGU9MSkKCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0X3RyYWluX2NvbmZpZ19wYXRoLmNsaWNrKGZuPXNlbGVjdF95YW1sX2ZpbGUsIG91dHB1dHM9dHJhaW5fY29uZmlnX3BhdGgpCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0X3RyYWluX2RhdGFzZXRfcGF0aC5jbGljayhmbj1zZWxlY3RfZm9sZGVyLCBvdXRwdXRzPXRyYWluX2RhdGFzZXRfcGF0aCkKICAgICAgICAgICAgICAgICAgICBzZWxlY3RfdHJhaW5fdmFsaWRfcGF0aC5jbGljayhmbj1zZWxlY3RfZm9sZGVyLCBvdXRwdXRzPXRyYWluX3ZhbGlkX3BhdGgpCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0X3RyYWluX3Jlc3VsdHNfcGF0aC5jbGljayhmbj1zZWxlY3RfZm9sZGVyLCBvdXRwdXRzPXRyYWluX3Jlc3VsdHNfcGF0aCkKICAgICAgICAgICAgICAgICAgICBvcGVuX3RyYWluX3Jlc3VsdHNfcGF0aC5jbGljayhmbj1vcGVuX2ZvbGRlciwgaW5wdXRzPXRyYWluX3Jlc3VsdHNfcGF0aCkKICAgICAgICAgICAgICAgICAgICBzYXZlX3RyYWluX2NvbmZpZy5jbGljayhmbj1zYXZlX3RyYWluaW5nX2NvbmZpZyxpbnB1dHM9W3RyYWluX21vZGVsX3R5cGUsIHRyYWluX2NvbmZpZ19wYXRoLCB0cmFpbl9kYXRhc2V0X3R5cGUsIHRyYWluX2RhdGFzZXRfcGF0aCwgdHJhaW5fdmFsaWRfcGF0aCwgdHJhaW5fbnVtX3dvcmtlcnMsdHJhaW5fZGV2aWNlX2lkcywgdHJhaW5fc2VlZCwgdHJhaW5fcGluX21lbW9yeSwgdHJhaW5fdXNlX211bHRpc3RmdF9sb3NzLCB0cmFpbl91c2VfbXNlX2xvc3MsIHRyYWluX3VzZV9sMV9sb3NzLCB0cmFpbl9yZXN1bHRzX3BhdGgsIHRyYWluX2FjY2VsZXJhdGUsIHRyYWluX3ByZV92YWxpZGF0ZV0sb3V0cHV0cz1vdXRwdXRfbWVzc2FnZV90cmFpbikKICAgICAgICAgICAgICAgICAgICBzdGFydF90cmFpbl9idXR0b24uY2xpY2soZm49c3RhcnRfdHJhaW5pbmcsaW5wdXRzPVt0cmFpbl9tb2RlbF90eXBlLCB0cmFpbl9jb25maWdfcGF0aCwgdHJhaW5fZGF0YXNldF90eXBlLCB0cmFpbl9kYXRhc2V0X3BhdGgsIHRyYWluX3ZhbGlkX3BhdGgsIHRyYWluX251bV93b3JrZXJzLCB0cmFpbl9kZXZpY2VfaWRzLHRyYWluX3NlZWQsIHRyYWluX3Bpbl9tZW1vcnksIHRyYWluX3VzZV9tdWx0aXN0ZnRfbG9zcywgdHJhaW5fdXNlX21zZV9sb3NzLCB0cmFpbl91c2VfbDFfbG9zcywgdHJhaW5fcmVzdWx0c19wYXRoLCB0cmFpbl9zdGFydF9jaGVja19wb2ludCwgdHJhaW5fYWNjZWxlcmF0ZSwgdHJhaW5fcHJlX3ZhbGlkYXRlXSxvdXRwdXRzPW91dHB1dF9tZXNzYWdlX3RyYWluKQogICAgICAgICAgICAgICAgICAgIHJlZmxlc2hfc3RhcnRfY2hlY2tfcG9pbnQuY2xpY2soZm49dXBkYXRlX3RyYWluX3N0YXJ0X2NoZWNrX3BvaW50LGlucHV0cz10cmFpbl9yZXN1bHRzX3BhdGgsb3V0cHV0cz10cmFpbl9zdGFydF9jaGVja19wb2ludCkKICAgICAgICAgICAgICAgICAgICBzdG9wX3RocmVhZC5jbGljayhmbj1zdG9wX2FsbF90aHJlYWQpCgogICAgICAgICAgICAgICAgd2l0aCBnci5UYWJJdGVtKGxhYmVsPWkxOG4oIumqjOivgSIpKToKICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLmraTpobXpnaLnlKjkuo7miYvliqjpqozor4HmqKHlnovmlYjmnpwsIOa1i+ivlemqjOivgembhiwg6L6T5Ye6U0RS5rWL6K+V5L+h5oGv44CC6L6T5Ye655qE5L+h5oGv5Lya5a2Y5pS+5Zyo6L6T5Ye65paH5Lu25aS555qEcmVzdWx0cy50eHTkuK3jgII8YnI+5LiL5pa55Y+C5pWw5bCG6Ieq5Yqo5Yqg6L296K6t57uD6aG16Z2i55qE5Y+C5pWwLCDlnKjorq3nu4PpobXpnaLngrnlh7vkv53lrZjorq3nu4Plj4LmlbDlkI4sIOmHjeWQr1dlYlVJ5Y2z5Y+v6Ieq5Yqo5Yqg6L2944CC5b2T54S25L2g5Lmf5Y+v5Lul5omL5Yqo6L6T5YWl5Y+C5pWw44CCPGJyPiIpKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkX21vZGVsX3R5cGUgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6nmqKHlnovnsbvlnosiKSxjaG9pY2VzPU1PREVMX1RZUEUsdmFsdWU9d2VidWlfY29uZmlnWyd0cmFpbmluZyddWydtb2RlbF90eXBlJ10gaWYgd2VidWlfY29uZmlnWyd0cmFpbmluZyddWydtb2RlbF90eXBlJ10gZWxzZSBOb25lLGludGVyYWN0aXZlPVRydWUsc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRfY29uZmlnX3BhdGggPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIumFjee9ruaWh+S7tui3r+W+hCIpLHZhbHVlPXdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsnY29uZmlnX3BhdGgnXSBpZiB3ZWJ1aV9jb25maWdbJ3RyYWluaW5nJ11bJ2NvbmZpZ19wYXRoJ10gZWxzZSBpMThuKCLor7fovpPlhaXphY3nva7mlofku7bot6/lvoTmiJbpgInmi6nphY3nva7mlofku7YiKSxpbnRlcmFjdGl2ZT1UcnVlLHNjYWxlPTMpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdF92YWxpZF9jb25maWdfcGF0aCA9IGdyLkJ1dHRvbihpMThuKCLpgInmi6nphY3nva7mlofku7YiKSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICB2YWxpZF9tb2RlbF9wYXRoID0gZ3IuVGV4dGJveChsYWJlbD1pMThuKCLmqKHlnovot6/lvoQiKSx2YWx1ZT1pMThuKCLor7fovpPlhaXmiJbpgInmi6nmqKHlnovmlofku7YiKSxpbnRlcmFjdGl2ZT1UcnVlLHNjYWxlPTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdF92YWxpZF9tb2RlbF9wYXRoID0gZ3IuQnV0dG9uKGkxOG4oIumAieaLqeaooeWei+aWh+S7tiIpLCBzY2FsZT0xKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkX3BhdGggPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIumqjOivgembhui3r+W+hCIpLHZhbHVlPXdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsndmFsaWRfcGF0aCddIGlmIHdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsndmFsaWRfcGF0aCddIGVsc2UgaTE4bigi6K+36L6T5YWl5oiW6YCJ5oup6aqM6K+B6ZuG5paH5Lu25aS5IiksaW50ZXJhY3RpdmU9VHJ1ZSxzY2FsZT00KQogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RfdmFsaWRfcGF0aCA9IGdyLkJ1dHRvbihpMThuKCLpgInmi6npqozor4Hpm4bmlofku7blpLkiKSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICB2YWxpZF9yZXN1bHRzX3BhdGggPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIui+k+WHuuebruW9lSIpLHZhbHVlPSJyZXN1bHRzLyIsaW50ZXJhY3RpdmU9VHJ1ZSxzY2FsZT0zKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RfdmFsaWRfcmVzdWx0c19wYXRoID0gZ3IuQnV0dG9uKGkxOG4oIumAieaLqeaWh+S7tuWkuSIpLCBzY2FsZT0xKQogICAgICAgICAgICAgICAgICAgICAgICBvcGVuX3ZhbGlkX3Jlc3VsdHNfcGF0aCA9IGdyLkJ1dHRvbihpMThuKCLmiZPlvIDmlofku7blpLkiKSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICB2YWxpZF9kZXZpY2VfaWRzID0gZ3IuVGV4dGJveChsYWJlbD1pMThuKCLpgInmi6nmmL7ljaEsIOWkmuWNoeeUqOaIt+ivt+S9v+eUqOepuuagvOWIhumalEdQVSBJRCIpLHZhbHVlPXdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsnZGV2aWNlX2lkcyddIGlmIHdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsnZGV2aWNlX2lkcyddIGVsc2UgIjAiLGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkX251bV93b3JrZXJzID0gZ3IuTnVtYmVyKGxhYmVsPWkxOG4oIumqjOivgembhuivu+WPlue6v+eoi+aVsCwgMOS4uuiHquWKqCIpLHZhbHVlPXdlYnVpX2NvbmZpZ1sndHJhaW5pbmcnXVsnbnVtX3dvcmtlcnMnXSBpZiB3ZWJ1aV9jb25maWdbJ3RyYWluaW5nJ11bJ251bV93b3JrZXJzJ10gZWxzZSAwLGludGVyYWN0aXZlPVRydWUsbWluaW11bT0wLG1heGltdW09Y3B1X2NvdW50KCksc3RlcD0xKQogICAgICAgICAgICAgICAgICAgICAgICB2YWxpZF9leHRlbnNpb24gPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6npqozor4Hpm4bpn7PpopHmoLzlvI8iKSxjaG9pY2VzPVsid2F2IiwgImZsYWMiLCAibXAzIl0sdmFsdWU9IndhdiIsaW50ZXJhY3RpdmU9VHJ1ZSxhbGxvd19jdXN0b21fdmFsdWU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICB2YWxpZF9waW5fbWVtb3J5ID0gZ3IuQ2hlY2tib3gobGFiZWw9aTE4bigi5piv5ZCm5bCG5Yqg6L2955qE5pWw5o2u5pS+572u5Zyo5Zu65a6a5YaF5a2Y5LitLCDpu5jorqTkuLrlkKYiKSwgdmFsdWU9d2VidWlfY29uZmlnWyd0cmFpbmluZyddWydwaW5fbWVtb3J5J10sIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkX3VzZV90dGEgPSBnci5DaGVja2JveChsYWJlbD1pMThuKCLkvb/nlKhUVEEgKOa1i+ivleaXtuWinuW8uiksIOWPr+iDveS8muaPkOmrmOi0qOmHjywg5L2G6YCf5bqm56iN5oWiIiksdmFsdWU9RmFsc2UsaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICB2YWxpZF9idXR0b24gPSBnci5CdXR0b24oaTE4bigi5byA5aeL6aqM6K+BIiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkX291dHB1dF9tZXNzYWdlID0gZ3IuVGV4dGJveChsYWJlbD0iT3V0cHV0IE1lc3NhZ2UiLCBzY2FsZT00KQogICAgICAgICAgICAgICAgICAgICAgICBzdG9wX3RocmVhZCA9IGdyLkJ1dHRvbihpMThuKCLlvLrliLblgZzmraIiKSwgc2NhbGU9MSkKCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0X3ZhbGlkX2NvbmZpZ19wYXRoLmNsaWNrKGZuPXNlbGVjdF95YW1sX2ZpbGUsIG91dHB1dHM9dmFsaWRfY29uZmlnX3BhdGgpCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0X3ZhbGlkX21vZGVsX3BhdGguY2xpY2soZm49c2VsZWN0X2ZpbGUsIG91dHB1dHM9dmFsaWRfbW9kZWxfcGF0aCkKICAgICAgICAgICAgICAgICAgICBzZWxlY3RfdmFsaWRfcGF0aC5jbGljayhmbj1zZWxlY3RfZm9sZGVyLCBvdXRwdXRzPXZhbGlkX3BhdGgpCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0X3ZhbGlkX3Jlc3VsdHNfcGF0aC5jbGljayhmbj1zZWxlY3RfZm9sZGVyLCBvdXRwdXRzPXZhbGlkX3Jlc3VsdHNfcGF0aCkKICAgICAgICAgICAgICAgICAgICBvcGVuX3ZhbGlkX3Jlc3VsdHNfcGF0aC5jbGljayhmbj1vcGVuX2ZvbGRlciwgaW5wdXRzPXZhbGlkX3Jlc3VsdHNfcGF0aCkKICAgICAgICAgICAgICAgICAgICB2YWxpZF9idXR0b24uY2xpY2soZm49dmFsaWRhdGVfbW9kZWwsaW5wdXRzPVt2YWxpZF9tb2RlbF90eXBlLCB2YWxpZF9jb25maWdfcGF0aCwgdmFsaWRfbW9kZWxfcGF0aCwgdmFsaWRfcGF0aCwgdmFsaWRfcmVzdWx0c19wYXRoLCB2YWxpZF9kZXZpY2VfaWRzLCB2YWxpZF9udW1fd29ya2VycywgdmFsaWRfZXh0ZW5zaW9uLCB2YWxpZF9waW5fbWVtb3J5LCB2YWxpZF91c2VfdHRhXSxvdXRwdXRzPXZhbGlkX291dHB1dF9tZXNzYWdlKQogICAgICAgICAgICAgICAgICAgIHN0b3BfdGhyZWFkLmNsaWNrKGZuPXN0b3BfYWxsX3RocmVhZCkKCiAgICAgICAgICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigi6K6t57uD6ZuG5Yi25L2c5oyH5Y2XIikpOgogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuQWNjb3JkaW9uKGkxOG4oIlN0ZXAgMTog5pWw5o2u6ZuG5Yi25L2cIiksIG9wZW49RmFsc2UpOgogICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLor7cqKuS7u+mAieS4i+mdouWbm+enjeexu+Wei+S5i+S4gCoq5Yi25L2c5pWw5o2u6ZuG5paH5Lu25aS5LCDlubbmjInnhafnu5nlh7rnmoTnm67lvZXlsYLnuqfmlL7nva7kvaDnmoTorq3nu4PmlbDmja7jgILlrozmiJDlkI4sIOiusOW9leS9oOeahOaVsOaNrumbhioq5paH5Lu25aS56Lev5b6EKirku6Xlj4rkvaDpgInmi6nnmoQqKuaVsOaNrumbhuexu+WeiyoqLCDku6Xkvr/lkI7nu63kvb/nlKjjgIIiKSkKICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuQ29sdW1uKCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oIiMgVHlwZSAxIChNVVNEQikiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIuS4jeWQjOeahOaWh+S7tuWkueOAguavj+S4quaWh+S7tuWkueWMheWQq+aJgOmcgOeahOaJgOaciXN0ZW1zLCDmoLzlvI/kuLpzdGVtX25hbWUud2F244CC5LiOTVVTREJIUTE45pWw5o2u6ZuG55u45ZCM44CC5Zyo5pyA5paw55qE5Luj56CB54mI5pys5LitLCDlj6/ku6Xkvb/nlKhmbGFj5pu/5Lujd2F244CCPGJyPuS+i+WmgjogIikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oIiIieW91cl9kYXRhc2V0c19mb2xkZXI8YnI+4pSc4pSA4pSA4pSAU29uZyAxPGJyPuKUgiAgIOKUnOKUgOKUgOKUgHZvY2Fscy53YXY8YnI+4pSCICAg4pSc4pSA4pSA4pSAYmFzcy53YXY8YnI+4pSCICAg4pSc4pSA4pSA4pSAZHJ1bXMud2F2PGJyPuKUgiAgIOKUlOKUgOKUgOKUgG90aGVyLndhdjxicj7ilJzilIDilIDilIBTb25nIDI8YnI+4pSCICAg4pSc4pSA4pSA4pSAdm9jYWxzLndhdjxicj7ilIIgICDilJzilIDilIDilIBiYXNzLndhdjxicj7ilIIgICDilJzilIDilIDilIBkcnVtcy53YXY8YnI+4pSCICAg4pSU4pSA4pSA4pSAb3RoZXIud2F2PGJyPuKUnOKUgOKUgOKUgFNvbmcgMzxicj4gICAg4pSU4pSA4pSA4pSALi4uPGJyPiIiIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuQ29sdW1uKCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oIiMgVHlwZSAyIChTdGVtcykiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIuavj+S4quaWh+S7tuWkueaYr3N0ZW1fbmFtZeOAguaWh+S7tuWkueS4reWMheWQq+S7heeUseaJgOmcgHN0ZW3nu4TmiJDnmoR3YXbmlofku7bjgII8YnI+5L6L5aaCOiAiKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bigiIiJ5b3VyX2RhdGFzZXRzX2ZvbGRlcjxicj7ilJzilIDilIDilIB2b2NhbHM8YnI+4pSCICAg4pSc4pSA4pSA4pSAdm9jYWxzXzEud2F2PGJyPuKUgiAgIOKUnOKUgOKUgOKUgHZvY2Fsc18yLndhdjxicj7ilIIgICDilJzilIDilIDilIB2b2NhbHNfMy53YXY8YnI+4pSCICAg4pSU4pSA4pSA4pSALi4uPGJyPuKUnOKUgOKUgOKUgGJhc3M8YnI+4pSCICAg4pSc4pSA4pSA4pSAYmFzc18xLndhdjxicj7ilIIgICDilJzilIDilIDilIBiYXNzXzIud2F2PGJyPuKUgiAgIOKUnOKUgOKUgOKUgGJhc3NfMy53YXY8YnI+4pSCICAg4pSU4pSA4pSA4pSALi4uPGJyPuKUnOKUgOKUgOKUgGRydW1zPGJyPiAgICDilJTilIDilIDilIAuLi48YnI+IiIiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Db2x1bW4oKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bigiIyBUeXBlIDMgKENTViBmaWxlKSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigi5Y+v5Lul5o+Q5L6b5Lul5LiL57uT5p6E55qEQ1NW5paH5Lu2ICjmiJZDU1bmlofku7bliJfooagpIDxicj7kvovlpoI6ICIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKCIiImluc3RydW0scGF0aDxicj52b2NhbHMsL3BhdGgvdG8vZGF0YXNldC92b2NhbHNfMS53YXY8YnI+dm9jYWxzLC9wYXRoL3RvL2RhdGFzZXQyL3ZvY2Fsc192Mi53YXY8YnI+dm9jYWxzLC9wYXRoL3RvL2RhdGFzZXQzL3ZvY2Fsc19zb21lLndhdjxicj4uLi48YnI+ZHJ1bXMsL3BhdGgvdG8vZGF0YXNldC9kcnVtc19nb29kLndhdjxicj4uLi48YnI+IiIiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Db2x1bW4oKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bigiIyBUeXBlIDQgKE1VU0RCIEFsaWduZWQpIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bihpMThuKCLkuI7nsbvlnosx55u45ZCMLCDkvYblnKjorq3nu4Pov4fnqIvkuK3miYDmnInkuZDlmajpg73lsIbmnaXoh6rmrYzmm7LnmoTnm7jlkIzkvY3nva7jgII8YnI+5L6L5aaCOiAiKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bigiIiJ5b3VyX2RhdGFzZXRzX2ZvbGRlcjxicj7ilJzilIDilIDilIBTb25nIDE8YnI+4pSCICAg4pSc4pSA4pSA4pSAdm9jYWxzLndhdjxicj7ilIIgICDilJzilIDilIDilIBiYXNzLndhdjxicj7ilIIgICDilJzilIDilIDilIBkcnVtcy53YXY8YnI+4pSCICAg4pSU4pSA4pSA4pSAb3RoZXIud2F2PGJyPuKUnOKUgOKUgOKUgFNvbmcgMjxicj7ilIIgICDilJzilIDilIDilIB2b2NhbHMud2F2PGJyPuKUgiAgIOKUnOKUgOKUgOKUgGJhc3Mud2F2PGJyPuKUgiAgIOKUnOKUgOKUgOKUgGRydW1zLndhdjxicj7ilIIgICDilJTilIDilIDilIBvdGhlci53YXY8YnI+4pSc4pSA4pSA4pSAU29uZyAzPGJyPiAgICDilJTilIDilIDilIAuLi48YnI+IiIiKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuQWNjb3JkaW9uKGkxOG4oIlN0ZXAgMjog6aqM6K+B6ZuG5Yi25L2cIiksIG9wZW49RmFsc2UpOgogICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLpqozor4Hpm4bliLbkvZzjgILpqozor4HmlbDmja7pm4YqKuW/hemhuyoq5LiO5LiK6Z2i5pWw5o2u6ZuG5Yi25L2c55qEVHlwZSAxKE1VU0RCKeaVsOaNrumbhioq57uT5p6E55u45ZCMKiogKCoq5peg6K665L2g5L2/55So5ZOq56eN57G75Z6L55qE5pWw5o2u6ZuG6L+b6KGM6K6t57uDKiopICwg5q2k5aSW5q+P5Liq5paH5Lu25aS56L+Y5b+F6aG75YyF5ZCr5q+P6aaW5q2M55qEbWl4dHVyZS53YXYsIG1peHR1cmUud2F25piv5omA5pyJc3RlbeeahOaAu+WSjDxicj7kvovlpoI6ICIpKQogICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bigiIiJ5b3VyX2RhdGFzZXRzX2ZvbGRlcjxicj7ilJzilIDilIDilIBTb25nIDE8YnI+4pSCICAg4pSc4pSA4pSA4pSAdm9jYWxzLndhdjxicj7ilIIgICDilJzilIDilIDilIBiYXNzLndhdjxicj7ilIIgICDilJzilIDilIDilIBkcnVtcy53YXY8YnI+4pSCICAg4pSc4pSA4pSA4pSAb3RoZXIud2F2PGJyPuKUgiAgIOKUlOKUgOKUgOKUgG1peHR1cmUud2F2PGJyPuKUnOKUgOKUgOKUgFNvbmcgMjxicj7ilIIgICDilJzilIDilIDilIB2b2NhbHMud2F2PGJyPuKUgiAgIOKUnOKUgOKUgOKUgGJhc3Mud2F2PGJyPuKUgiAgIOKUnOKUgOKUgOKUgGRydW1zLndhdjxicj7ilIIgICDilJzilIDilIDilIBvdGhlci53YXY8YnI+4pSCICAg4pSU4pSA4pSA4pSAbWl4dHVyZS53YXY8YnI+4pSc4pSA4pSA4pSAU29uZyAzPGJyPiAgICDilJTilIDilIDilIAuLi48YnI+IiIiKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuQWNjb3JkaW9uKGkxOG4oIlN0ZXAgMzog6YCJ5oup5bm25L+u5pS55L+u5pS56YWN572u5paH5Lu2IiksIG9wZW49RmFsc2UpOgogICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLor7flhYjmmI7noa7kvaDmg7PopoHorq3nu4PnmoTmqKHlnovnsbvlnossIOeEtuWQjumAieaLqeWvueW6lOeahOmFjee9ruaWh+S7tui/m+ihjOS/ruaUueOAgjxicj7nm67liY3mnInku6XkuIvlh6Dnp43mqKHlnovnsbvlnos6ICIpICsgc3RyKE1PREVMX1RZUEUpICsgaTE4bigiPGJyPuehruWumuWlveaooeWei+exu+Wei+WQjiwg5L2g5Y+v5Lul5YmN5b6A5pW05ZCI5YyF5qC555uu5b2V5Lit55qEY29uZmlnc19iYWNrdXDmlofku7blpLnkuIvmib7liLDlr7nlupTnmoTphY3nva7mlofku7bmqKHmnb/jgILlpI3liLbkuIDku73mqKHmnb8sIOeEtuWQjuagueaNruS9oOeahOmcgOaxgui/m+ihjOS/ruaUueOAguS/ruaUueWujOaIkOWQjuiusOS4i+S9oOeahOmFjee9ruaWh+S7tui3r+W+hCwg5Lul5L6/5ZCO57ut5L2/55So44CCPGJyPueJueWIq+ivtOaYjjogY29uZmlnX211c2RiMThfeHh4LnlhbWzmmK/pkojlr7lNVVNEQjE45pWw5o2u6ZuG55qE6YWN572u5paH5Lu244CCPGJyPiIpKQogICAgICAgICAgICAgICAgICAgICAgICBvcGVuX2NvbmZpZ190ZW1wbGF0ZSA9IGdyLkJ1dHRvbihpMThuKCLmiZPlvIDphY3nva7mlofku7bmqKHmnb/mlofku7blpLkiKSwgdmFyaWFudD0icHJpbWFyeSIpCiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5fY29uZmlnX3RlbXBsYXRlLmNsaWNrKG9wZW5fZm9sZGVyLCBpbnB1dHM9Z3IuVGV4dGJveCgiY29uZmlnc19iYWNrdXAiLCB2aXNpYmxlPUZhbHNlKSkKICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24odmFsdWU9aTE4bigi5L2g5Y+v5Lul5L2/55So5LiL6KGo5qC55o2u5L2g55qER1BV6YCJ5oup55So5LqO6K6t57uD55qEQlNfUm9mb3JtZXLmqKHlnovnmoRiYXRjaF9zaXpl5Y+C5pWw44CC6KGo5Lit5o+Q5L6b55qE5om56YeP5aSn5bCP5YC86YCC55So5LqO5Y2V5LiqR1BV44CC5aaC5p6c5L2g5pyJ5aSa5LiqR1BVLCDliJnpnIDopoHlsIbor6XlgLzkuZjku6VHUFXnmoTmlbDph4/jgIIiKSkKICAgICAgICAgICAgICAgICAgICAgICAgcm9mb3JtZXJfZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjaHVua19zaXplIjogWzEzMTU4NCwgMTMxNTg0LCAxMzE1ODQsIDEzMTU4NCwgMTMxNTg0LCAxMzE1ODQsIDI2MzE2OCwgMjYzMTY4LCAzNTI4MDAsIDM1MjgwMCwgMzUyODAwLCAzNTI4MDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRpbSI6IFsxMjgsIDI1NiwgMzg0LCA1MTIsIDI1NiwgMjU2LCAxMjgsIDI1NiwgMTI4LCAyNTYsIDM4NCwgNTEyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkZXB0aCI6IFs2LCA2LCA2LCA2LCA4LCAxMiwgNiwgNiwgNiwgNiwgMTIsIDEyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJiYXRjaF9zaXplIChBNjAwMCA0OEdCKSI6IFsxMCwgOCwgNywgNiwgNiwgNCwgNCwgMywgMiwgMiwgMSwgJy0nXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJiYXRjaF9zaXplICgzMDkwLzQwOTAgMjRHQikiOiBbNSwgNCwgMywgMywgMywgMiwgMiwgMSwgMSwgMSwgJy0nLCAnLSddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImJhdGNoX3NpemUgKDE2R0IpIjogWzMsIDIsIDIsIDIsIDIsIDEsIDEsIDEsICctJywgJy0nLCAnLScsICctJ10KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBnci5EYXRhRnJhbWUocGQuRGF0YUZyYW1lKHJvZm9ybWVyX2RhdGEpKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuQWNjb3JkaW9uKGkxOG4oIlN0ZXAgNDog5pWw5o2u5aKe5by6IiksIG9wZW49RmFsc2UpOgogICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bih2YWx1ZT1pMThuKCLmlbDmja7lop7lvLrlj6/ku6XliqjmgIHmm7TmlLlzdGVtLCDpgJrov4fku47ml6fmoLfmnKzliJvlu7rmlrDmoLfmnKzmnaXlop7liqDmlbDmja7pm4bnmoTlpKflsI/jgILnjrDlnKgsIOaVsOaNruWinuW8uueahOaOp+WItuWcqOmFjee9ruaWh+S7tuS4rei/m+ihjOOAguS4i+mdouaYr+S4gOS4quWMheWQq+aJgOacieWPr+eUqOaVsOaNruWinuW8uueahOWujOaVtOmFjee9ruekuuS+i+OAguS9oOWPr+S7peWwhuWFtuWkjeWItuWIsOS9oOeahOmFjee9ruaWh+S7tuS4reS7peS9v+eUqOaVsOaNruWinuW8uuOAgjxicj7ms6jmhI86PGJyPjEuIOimgeWujOWFqOemgeeUqOaJgOacieaVsOaNruWinuW8uiwg5Y+v5Lul5LuO6YWN572u5paH5Lu25Lit5Yig6ZmkYXVnbWVudGF0aW9uc+mDqOWIhuaIluWwhmVuYWJsZeiuvue9ruS4umZhbHNl44CCPGJyPjIuIOWmguaenOimgeemgeeUqOafkOS6m+aVsOaNruWinuW8uiwg5Y+q6ZyA5bCG5YW26K6+572u5Li6MOOAgjxicj4zLiBhbGzpg6jliIbkuK3nmoTmlbDmja7lop7lvLrlupTnlKjkuo7miYDmnIlzdGVt44CCPGJyPjQuIHZvY2Fscy9iYXNz562J6YOo5YiG5Lit55qE5pWw5o2u5aKe5by65LuF5bqU55So5LqO55u45bqU55qEc3RlbeOAguS9oOWPr+S7peS4unRyYWluaW5nLmluc3RydW1lbnRz5Lit57uZ5Ye655qE5omA5pyJc3RlbeWIm+W7uui/meagt+eahOmDqOWIhuOAgiIpKQogICAgICAgICAgICAgICAgICAgICAgICBhdWdtZW50YXRpb25zX2NvbmZpZyA9IGxvYWRfYXVnbWVudGF0aW9uc19jb25maWcoKQogICAgICAgICAgICAgICAgICAgICAgICBnci5Db2RlKHZhbHVlPWF1Z21lbnRhdGlvbnNfY29uZmlnLCBsYW5ndWFnZT0ieWFtbCIpCgogICAgICAgIHdpdGggZ3IuVGFiSXRlbShsYWJlbD1pMThuKCLorr7nva4iKSk6CiAgICAgICAgICAgIHdpdGggZ3IuVGFicygpOgogICAgICAgICAgICAgICAgd2l0aCBnci5UYWJJdGVtKGxhYmVsPWkxOG4oIldlYlVJ6K6+572uIikpOgogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuQ29sdW1uKHNjYWxlPTMpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncHVfbGlzdCA9IGdyLlRleHRib3gobGFiZWw9aTE4bigiR1BV5L+h5oGvIiksIHZhbHVlPWdldF9kZXZpY2UoKSwgaW50ZXJhY3RpdmU9RmFsc2UpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnRmb3JtX2luZm8gPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIuezu+e7n+S/oeaBryIpLCB2YWx1ZT1nZXRfcGxhdGZvcm0oKSwgaW50ZXJhY3RpdmU9RmFsc2UpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldF93ZWJ1aV9wb3J0ID0gZ3IuTnVtYmVyKGxhYmVsPWkxOG4oIuiuvue9rldlYlVJ56uv5Y+jLCAw5Li66Ieq5YqoIiksIHZhbHVlPXdlYnVpX2NvbmZpZ1sic2V0dGluZ3MiXS5nZXQoInBvcnQiLCAwKSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRfbGFuZ3VhZ2UgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6nor63oqIAiKSwgY2hvaWNlcz1sYW5ndWFnZV9kaWN0LmtleXMoKSwgdmFsdWU9Z2V0X2xhbmd1YWdlKCksIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0X2Rvd25sb2FkX2xpbmsgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6lNU1NU5qih5Z6L5LiL6L296ZO+5o6lIiksIGNob2ljZXM9WyJBdXRvIiwgaTE4bigiaHVnZ2luZ2ZhY2UuY28gKOmcgOimgemtlOazlSkiKSwgaTE4bigiaGYtbWlycm9yLmNvbSAo6ZWc5YOP56uZ5Y+v55u06L+eKSIpXSwgdmFsdWU9d2VidWlfY29uZmlnWydzZXR0aW5ncyddWydkb3dubG9hZF9saW5rJ10gaWYgd2VidWlfY29uZmlnWydzZXR0aW5ncyddWydkb3dubG9hZF9saW5rJ10gZWxzZSAiQXV0byIsIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5fbG9jYWxfbGluayA9IGdyLkNoZWNrYm94KGxhYmVsPWkxOG4oIuWvueacrOWcsOWxgOWfn+e9keW8gOaUvldlYlVJOiDlvIDlkK/lkI4sIOWQjOS4gOWxgOWfn+e9keWGheeahOiuvuWkh+WPr+mAmui/hyfmnKzmnLpJUDrnq6/lj6Mn55qE5pa55byP6K6/6ZeuV2ViVUnjgIIiKSwgdmFsdWU9d2VidWlfY29uZmlnWydzZXR0aW5ncyddWydsb2NhbF9saW5rJ10sIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Blbl9zaGFyZV9saW5rID0gZ3IuQ2hlY2tib3gobGFiZWw9aTE4bigi5byA5ZCv5YWs5YWx6ZO+5o6lOiDlvIDlkK/lkI4sIOS7luS6uuWPr+mAmui/h+WFrOWFsemTvuaOpeiuv+mXrldlYlVJ44CC6ZO+5o6l5pyJ5pWI5pe26ZW/5Li6NzLlsI/ml7bjgIIiKSwgdmFsdWU9d2VidWlfY29uZmlnWydzZXR0aW5ncyddWydzaGFyZV9saW5rJ10sIGludGVyYWN0aXZlPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdF91dnJfbW9kZWxfZGlyID0gZ3IuVGV4dGJveChsYWJlbD1pMThuKCLpgInmi6lVVlLmqKHlnovnm67lvZUiKSx2YWx1ZT13ZWJ1aV9jb25maWdbJ3NldHRpbmdzJ11bJ3V2cl9tb2RlbF9kaXInXSBpZiB3ZWJ1aV9jb25maWdbJ3NldHRpbmdzJ11bJ3V2cl9tb2RlbF9kaXInXSBlbHNlICJwcmV0cmFpbi9WUl9Nb2RlbHMiLGludGVyYWN0aXZlPVRydWUsc2NhbGU9NCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RfdXZyX21vZGVsX2Rpcl9idXR0b24gPSBnci5CdXR0b24oaTE4bigi6YCJ5oup5paH5Lu25aS5IiksIHNjYWxlPTEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGdyLlJvdygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZV9tZXNzYWdlID0gZ3IuVGV4dGJveChsYWJlbD1pMThuKCLmo4Dmn6Xmm7TmlrAiKSwgdmFsdWU9aTE4bigi5b2T5YmN54mI5pysOiAiKSArIFBBQ0tBR0VfVkVSU0lPTiArIGkxOG4oIiwg6K+354K55Ye75qOA5p+l5pu05paw5oyJ6ZKuIiksIGludGVyYWN0aXZlPUZhbHNlLHNjYWxlPTMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tfdXBkYXRlID0gZ3IuQnV0dG9uKGkxOG4oIuajgOafpeabtOaWsCIpLCBzY2FsZT0xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG9fZ2l0aHViID0gZ3IuQnV0dG9uKGkxOG4oIuWJjeW+gEdpdGh1YueeheS4gOecvCIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Sb3coKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNldF9hbGxfd2VidWlfY29uZmlnID0gZ3IuQnV0dG9uKGkxOG4oIumHjee9rldlYlVJ6Lev5b6E6K6w5b2VIiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2V0X3NlZXRpbmdzID0gZ3IuQnV0dG9uKGkxOG4oIumHjee9rldlYlVJ6K6+572uIiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ19vdXRwdXRfbWVzc2FnZSA9IGdyLlRleHRib3gobGFiZWw9Ik91dHB1dCBNZXNzYWdlIikKICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBnci5Db2x1bW4oc2NhbGU9MSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bihpMThuKCIjIyMg6K6+572u6K+05piOIikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bihpMThuKCIjIyMg6YCJ5oupVVZS5qih5Z6L55uu5b2VIikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bihpMThuKCLlpoLmnpzkvaDnmoTnlLXohJHkuK3mnInlronoo4VVVlI1LCDkvaDkuI3lv4Xph43mlrDkuIvovb3kuIDpgY1VVlI15qih5Z6LLCDlj6rpnIDlnKjkuIvmlrnigJzpgInmi6lVVlLmqKHlnovnm67lvZXigJ3kuK3pgInmi6nkvaDnmoRVVlI15qih5Z6L55uu5b2VLCDlrprkvY3liLBtb2RlbHMvVlJfTW9kZWxz5paH5Lu25aS544CCPGJyPuS+i+WmgjogRTovUHJvZ3JhbSBGaWxlcy9VbHRpbWF0ZSBWb2NhbCBSZW1vdmVyL21vZGVscy9WUl9Nb2RlbHMg54K55Ye75L+d5a2Y6K6+572u5oiW6YeN572u6K6+572u5ZCOLCDpnIDopoHph43lkK9XZWJVSeS7peabtOaWsOOAgiIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigiIyMjIOajgOafpeabtOaWsCIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigi5LuOR2l0aHVi5qOA5p+l5pu05pawLCDpnIDopoHkuIDlrprnmoTnvZHnu5zopoHmsYLjgILngrnlh7vmo4Dmn6Xmm7TmlrDmjInpkq7lkI4sIOS8muiHquWKqOajgOafpeaYr+WQpuacieacgOaWsOeJiOacrOOAguS9oOWPr+S7peWJjeW+gOatpOaVtOWQiOWMheeahOS4i+i9vemTvuaOpeaIluiuv+mXrkdpdGh1YuS7k+W6k+S4i+i9veacgOaWsOeJiOacrOOAgiIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IuTWFya2Rvd24oaTE4bigiIyMjIOmHjee9rldlYlVJ6Lev5b6E6K6w5b2VIikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bihpMThuKCLlsIbmiYDmnInovpPlhaXovpPlh7rnm67lvZXph43nva7kuLrpu5jorqTot6/lvoQsIOmihOiuvi/mqKHlnosv6YWN572u5paH5Lu25Lul5Y+K5LiK6Z2i55qE6K6+572u562JKirkuI3kvJrph43nva4qKiwg5peg6ZyA5ouF5b+D44CC6YeN572uV2ViVUnorr7nva7lkI4sIOmcgOimgemHjeWQr1dlYlVJ44CCIikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bihpMThuKCIjIyMg6YeN572uV2ViVUnorr7nva4iKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIuS7hemHjee9rldlYlVJ6K6+572uLCDkvovlpoJVVlLmqKHlnovot6/lvoQsIFdlYlVJ56uv5Y+j562J44CC6YeN572uV2ViVUnorr7nva7lkI4sIOmcgOimgemHjeWQr1dlYlVJ44CCIikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnci5NYXJrZG93bihpMThuKCIjIyMg6YeN5ZCvV2ViVUkiKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIueCueWHuyDigJzph43lkK9XZWJVSeKAnSDmjInpkq7lkI4sIOS8muefreaaguaAp+eahOWkseWOu+i/nuaOpSwg6ZqP5ZCO5Lya6Ieq5Yqo5byA5ZCv5LiA5Liq5paw572R6aG144CCIikpCiAgICAgICAgICAgICAgICB3aXRoIGdyLlRhYkl0ZW0obGFiZWw9aTE4bigi5qih5Z6L5pS55ZCNIikpOgogICAgICAgICAgICAgICAgICAgIGdyLk1hcmtkb3duKGkxOG4oIuatpOmhtemdouaUr+aMgeeUqOaIt+iHquWumuS5ieS/ruaUueaooeWei+WQjeWtlywg5Lul5L6/6K6w5b+G5ZKM5L2/55So44CC5L+u5pS55a6M5oiQ5ZCOLCDpnIDopoHph43lkK9XZWJVSeS7peWIt+aWsOaooeWei+WIl+ihqOOAgjxicj7jgJDms6jmhI/jgJHmraTmk43kvZzkuI3lj6/pgIYgKOaXoOazleaBouWkjeiHs+m7mOiupOWRveWQjSksIOivt+iwqOaFjuWRveWQjeOAgui+k+WFpeaWsOaooeWei+WQjeWtl+aXtiwg6ZyA5L+d55WZ5ZCO57yAISIpKQogICAgICAgICAgICAgICAgICAgIHdpdGggZ3IuUm93KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmFtZV9tb2RlbF90eXBlID0gZ3IuRHJvcGRvd24obGFiZWw9aTE4bigi6YCJ5oup5qih5Z6L57G75Z6LIiksIGNob2ljZXM9TU9ERUxfQ0hPSUNFUywgdmFsdWU9Tm9uZSwgaW50ZXJhY3RpdmU9VHJ1ZSwgc2NhbGU9MSkKICAgICAgICAgICAgICAgICAgICAgICAgcmVuYW1lX21vZGVsX25hbWUgPSBnci5Ecm9wZG93bihsYWJlbD1pMThuKCLpgInmi6nmqKHlnosiKSwgY2hvaWNlcz1baTE4bigi6K+35YWI6YCJ5oup5qih5Z6L57G75Z6LIildLCB2YWx1ZT1pMThuKCLor7flhYjpgInmi6nmqKHlnovnsbvlnosiKSwgaW50ZXJhY3RpdmU9VHJ1ZSwgc2NhbGU9NCkKICAgICAgICAgICAgICAgICAgICByZW5hbWVfbmV3X25hbWUgPSBnci5UZXh0Ym94KGxhYmVsPWkxOG4oIuaWsOaooeWei+WQjSIpLCBwbGFjZWhvbGRlcj1pMThuKCLor7fovpPlhaXmlrDmqKHlnovlkI3lrZcsIOmcgOS/neeVmeWQjue8gCEiKSwgaW50ZXJhY3RpdmU9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICByZW5hbWVfbW9kZWwgPSBnci5CdXR0b24oaTE4bigi56Gu6K6k5L+u5pS5IiksIHZhcmlhbnQ9InByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgIHJlbmFtZV9vdXRwdXRfbWVzc2FnZSA9IGdyLlRleHRib3gobGFiZWw9Ik91dHB1dCBNZXNzYWdlIikKICAgICAgICAgICAgcmVzdGFydF93ZWJ1aSA9IGdyLkJ1dHRvbihpMThuKCLph43lkK9XZWJVSSIpLCB2YXJpYW50PSJwcmltYXJ5IikKCiAgICAgICAgICAgIHJlc3RhcnRfd2VidWkuY2xpY2soZm49d2VidWlfcmVzdGFydCwgb3V0cHV0cz1zZXR0aW5nX291dHB1dF9tZXNzYWdlKQogICAgICAgICAgICBjaGVja191cGRhdGUuY2xpY2soZm49Y2hlY2tfd2VidWlfdXBkYXRlLCBvdXRwdXRzPXVwZGF0ZV9tZXNzYWdlKQogICAgICAgICAgICBnb3RvX2dpdGh1Yi5jbGljayhmbj13ZWJ1aV9nb3RvX2dpdGh1YikKICAgICAgICAgICAgc2VsZWN0X3V2cl9tb2RlbF9kaXJfYnV0dG9uLmNsaWNrKGZuPXNlbGVjdF9mb2xkZXIsIG91dHB1dHM9c2VsZWN0X3V2cl9tb2RlbF9kaXIpCiAgICAgICAgICAgIHJlc2V0X3NlZXRpbmdzLmNsaWNrKGZuPXJlc2V0X3NldHRpbmdzLGlucHV0cz1bXSxvdXRwdXRzPXNldHRpbmdfb3V0cHV0X21lc3NhZ2UpCiAgICAgICAgICAgIHJlc2V0X2FsbF93ZWJ1aV9jb25maWcuY2xpY2soZm49cmVzZXRfd2VidWlfY29uZmlnLG91dHB1dHM9c2V0dGluZ19vdXRwdXRfbWVzc2FnZSkKICAgICAgICAgICAgc2V0X3dlYnVpX3BvcnQuY2hhbmdlKGZuPXNhdmVfcG9ydF90b19jb25maWcsaW5wdXRzPVtzZXRfd2VidWlfcG9ydF0sb3V0cHV0cz1zZXR0aW5nX291dHB1dF9tZXNzYWdlKQogICAgICAgICAgICBzZWxlY3RfdXZyX21vZGVsX2Rpci5jaGFuZ2UoZm49c2F2ZV91dnJfbW9kZWxkaXIsaW5wdXRzPVtzZWxlY3RfdXZyX21vZGVsX2Rpcl0sb3V0cHV0cz1zZXR0aW5nX291dHB1dF9tZXNzYWdlKQogICAgICAgICAgICBzZXRfbGFuZ3VhZ2UuY2hhbmdlKGZuPWNoYW5nZV9sYW5ndWFnZSxpbnB1dHM9W3NldF9sYW5ndWFnZV0sb3V0cHV0cz1zZXR0aW5nX291dHB1dF9tZXNzYWdlKQogICAgICAgICAgICBzZXRfZG93bmxvYWRfbGluay5jaGFuZ2UoZm49Y2hhbmdlX2Rvd25sb2FkX2xpbmssaW5wdXRzPVtzZXRfZG93bmxvYWRfbGlua10sb3V0cHV0cz1zZXR0aW5nX291dHB1dF9tZXNzYWdlKQogICAgICAgICAgICBvcGVuX3NoYXJlX2xpbmsuY2hhbmdlKGZuPWNoYW5nZV9zaGFyZV9saW5rLGlucHV0cz1bb3Blbl9zaGFyZV9saW5rXSxvdXRwdXRzPXNldHRpbmdfb3V0cHV0X21lc3NhZ2UpCiAgICAgICAgICAgIG9wZW5fbG9jYWxfbGluay5jaGFuZ2UoZm49Y2hhbmdlX2xvY2FsX2xpbmssaW5wdXRzPVtvcGVuX2xvY2FsX2xpbmtdLG91dHB1dHM9c2V0dGluZ19vdXRwdXRfbWVzc2FnZSkKICAgICAgICAgICAgcmVuYW1lX21vZGVsX3R5cGUuY2hhbmdlKGZuPXVwZGF0ZV9yZW5hbWVfbW9kZWxfbmFtZSwgaW5wdXRzPVtyZW5hbWVfbW9kZWxfdHlwZV0sIG91dHB1dHM9W3JlbmFtZV9tb2RlbF9uYW1lXSkKICAgICAgICAgICAgcmVuYW1lX21vZGVsLmNsaWNrKGZuPXJlbmFtZV9uYW1lLCBpbnB1dHM9W3JlbmFtZV9tb2RlbF90eXBlLCByZW5hbWVfbW9kZWxfbmFtZSwgcmVuYW1lX25ld19uYW1lXSwgb3V0cHV0cz1bcmVuYW1lX291dHB1dF9tZXNzYWdlLCByZW5hbWVfbW9kZWxfdHlwZSwgcmVuYW1lX21vZGVsX25hbWVdKQoKbG9jYWxfbGluayA9ICIwLjAuMC4wIiBpZiB3ZWJ1aV9jb25maWdbInNldHRpbmdzIl0uZ2V0KCJsb2NhbF9saW5rIiwgRmFsc2UpIGVsc2UgTm9uZQpzZXJ2ZXJfcG9ydCA9IE5vbmUgaWYgd2VidWlfY29uZmlnWyJzZXR0aW5ncyJdLmdldCgicG9ydCIsIDApID09IDAgZWxzZSB3ZWJ1aV9jb25maWdbInNldHRpbmdzIl0uZ2V0KCJwb3J0IiwgMCkKaXNTaGFyZSA9IHdlYnVpX2NvbmZpZ1sic2V0dGluZ3MiXS5nZXQoInNoYXJlX2xpbmsiLCBGYWxzZSkKYXBwLmxhdW5jaChpbmJyb3dzZXI9VHJ1ZSwgc2VydmVyX25hbWU9bG9jYWxfbGluaywgc2VydmVyX3BvcnQ9c2VydmVyX3BvcnQsIHNoYXJlPWlzU2hhcmUpCg==";

    return encoded;
};

int main()
{
    system("chcp 65001 > nul");
    std::cout << R"(   __  _________________  _      __    __   __  ______)" << std::endl;
    std::cout << R"(  /  |/  / __/ __/_  __/ | | /| / /__ / /  / / / /  _/)" << std::endl;
    std::cout << R"( / /|_/ /\ \_\ \  / /    | |/ |/ / -_) _ \/ /_/ // /  )" << std::endl;
    std::cout << R"(/_/  /_/___/___/ /_/     |__/|__/\__/_.__/\____/___/  )" << std::endl;
    std::cout << "" << std::endl;
    std::cout << "[INFO] 正在启动WebUI, 请稍等..." << std::endl;
    std::cout << "[INFO] Starting WebUI, please wait..." << std::endl;

    std::string encoded = get_webui();
    std::string decoded = base64_decode(encoded);

    char tempPath[MAX_PATH];
    if (!GetTempPath(MAX_PATH, tempPath))
    {
        std::cerr << "\033[91m" << "[ERROR] Error getting path!" << "\033[0m" << std::endl;
        system("pause");
        return 1;
    }

    std::string guid = generate_guid();
    std::string tempFilePath = std::string(tempPath) + guid + ".tmp";
    std::ofstream outfile(tempFilePath, std::ios::binary);
    outfile.write(decoded.c_str(), decoded.size());

    std::string command = ".\\workenv\\python.exe " + tempFilePath;
    std::cout << "[INFO] 若启动失败, 请尝试删除软件根目录下data文件夹或以管理员身份运行" << std::endl;
    std::cout << "[INFO] If launch failed, try to delete the data folder under the root directory or run as administrator" << std::endl;
    std::cout << "\033[91m" << "[NOTE] WebUI运行过程中请勿关闭此窗口!" << "\033[0m" << std::endl;
    std::cout << "\033[91m" << "[NOTE] Do not close this window while WebUI is running!" << "\033[0m" << std::endl;
    system(command.c_str());

    remove(tempFilePath.c_str());
    system("pause");
    return 0;
}